parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function zb(a){return a&&a.__esModule?{d:a.default}:{d:a}}function Am(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function zh(e,r){return sA(e)||wA(e,r)||KA(e,r)||cB()}function cB(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function KA(e,r){if(e){if("string"==typeof e)return gl(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?gl(e,r):void 0}}function gl(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=new Array(r);t<r;t++)a[t]=e[t];return a}function wA(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],a=!0,o=!1,n=void 0;try{for(var i,u=e[Symbol.iterator]();!(a=(i=u.next()).done)&&(t.push(i.value),!r||t.length!==r);a=!0);}catch(l){o=!0,n=l}finally{try{a||null==u.return||u.return()}finally{if(o)throw n}}return t}}function sA(e){if(Array.isArray(e))return e}function lA(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function il(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _z(e,r,t){return r&&il(e.prototype,r),t&&il(e,t),e}function Wz(e){return(Wz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vz(e){return iz(e)||jz(e)||lz(e)||yz()}function yz(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lz(e,t){if(e){if("string"==typeof e)return Pj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pj(e,t):void 0}}function jz(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function iz(e){if(Array.isArray(e))return Pj(e)}function Pj(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ez(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zy(e,t,r){return t&&wl(e.prototype,t),r&&wl(e,r),e}var Zb=function(){function e(t){ez(this,e),this.mAttr="data-"+t.dataName,this.mCaptureEvents=["mouseenter","mouseleave"],this.el=t.el}return Zy(e,[{key:"mInit",value:function(e){var t=this;this.modules=e,this.mCheckEventTarget=this.mCheckEventTarget.bind(this),this.events&&Object.keys(this.events).forEach(function(e){return t.mAddEvent(e)})}},{key:"mUpdate",value:function(e){this.modules=e}},{key:"mDestroy",value:function(){var e=this;this.events&&Object.keys(this.events).forEach(function(t){return e.mRemoveEvent(t)})}},{key:"mAddEvent",value:function(e){var t=!!this.mCaptureEvents.includes(e);this.el.addEventListener(e,this.mCheckEventTarget,t)}},{key:"mRemoveEvent",value:function(e){var t=!!this.mCaptureEvents.includes(e);this.el.removeEventListener(e,this.mCheckEventTarget,t)}},{key:"mCheckEventTarget",value:function(e){var t=this.events[e.type];if("string"==typeof t)this[t](e);else{var r="["+this.mAttr+"]",n=e.target;if(this.mCaptureEvents.includes(e.type))n.matches(r)&&this.mCallEventMethod(e,t,n);else for(;n&&n!==document&&(!n.matches(r)||"undefined"==this.mCallEventMethod(e,t,n));)n=n.parentNode}}},{key:"mCallEventMethod",value:function(e,t,r){var n=r.getAttribute(this.mAttr);if(t.hasOwnProperty(n)){var a=t[n];e.hasOwnProperty("currentTarget")||Object.defineProperty(e,"currentTarget",{value:r}),e.hasOwnProperty("curTarget")||Object.defineProperty(e,"curTarget",{value:r}),this[a](e)}}},{key:"$",value:function(e,t){var r=[e.indexOf("."),e.indexOf("#"),e.indexOf("[")].filter(function(e){return-1!=e}),n=!1,a=e,o="",i=this.el;return r.length&&(n=Math.min.apply(Math,Vz(r)),a=e.slice(0,n),o=e.slice(n)),"object"==Wz(t)&&(i=t),i.querySelectorAll("["+this.mAttr+"="+a+"]"+o)}},{key:"parent",value:function(e,t){for(var r="["+this.mAttr+"="+e+"]",n=t.parentNode;n&&n!==document;){if(n.matches(r))return n;n=n.parentNode}}},{key:"getData",value:function(e,t){return(t||this.el).getAttribute(this.mAttr+"-"+e)}},{key:"setData",value:function(e,t,r){return(r||this.el).setAttribute(this.mAttr+"-"+e,t)}},{key:"call",value:function(e,t,r,n){var a=this;t&&!r&&(r=t,t=!1),this.modules[r]&&(n?this.modules[r][n]&&this.modules[r][n][e](t):Object.keys(this.modules[r]).forEach(function(n){a.modules[r][n][e](t)}))}},{key:"on",value:function(e,t,r,n){var a=this;this.modules[t]&&(n?this.modules[t][n].el.addEventListener(e,function(e){return r(e)}):Object.keys(this.modules[t]).forEach(function(n){a.modules[t][n].el.addEventListener(e,function(e){return r(e)})}))}},{key:"init",value:function(){}},{key:"destroy",value:function(){}}]),e}();var Xy=function(){function e(r){lA(this,e),this.app,this.modules=r.modules,this.currentModules={},this.activeModules={},this.newModules={},this.moduleId=0}return _z(e,[{key:"init",value:function(e,r){var t=this,a=(r||document).querySelectorAll("*");e&&!this.app&&(this.app=e),this.activeModules.app={app:this.app},a.forEach(function(e){Array.from(e.attributes).forEach(function(a){if(a.name.startsWith("data-module")){var o=!1,n=a.name.split("-").splice(2),i=t.toCamel(n);if(t.modules[i]?o=!0:t.modules[t.toUpper(i)]&&(i=t.toUpper(i),o=!0),o){var u={el:e,name:i,dataName:n.join("-")},l=new t.modules[i](u),s=a.value;s||(t.moduleId++,s="m"+t.moduleId,e.setAttribute(a.name,s)),t.addActiveModule(i,s,l);var c=i+"-"+s;r?t.newModules[c]=l:t.currentModules[c]=l}}})}),Object.entries(this.currentModules).forEach(function(e){var a=zh(e,2),o=a[0],n=a[1];if(r){var i=o.split("-"),u=i.shift(),l=i.pop();t.addActiveModule(u,l,n)}else t.initModule(n)})}},{key:"initModule",value:function(e){e.mInit(this.activeModules),e.init()}},{key:"addActiveModule",value:function(e,r,t){this.activeModules[e]?Object.assign(this.activeModules[e],Am({},r,t)):this.activeModules[e]=Am({},r,t)}},{key:"update",value:function(e){var r=this;this.init(this.app,e),Object.entries(this.currentModules).forEach(function(e){var t=zh(e,2);t[0];t[1].mUpdate(r.activeModules)}),Object.entries(this.newModules).forEach(function(e){var t=zh(e,2),a=(t[0],t[1]);r.initModule(a)}),Object.assign(this.currentModules,this.newModules)}},{key:"destroy",value:function(e){e?this.destroyScope(e):this.destroyModules()}},{key:"destroyScope",value:function(e){var r=this;e.querySelectorAll("*").forEach(function(e){Array.from(e.attributes).forEach(function(e){if(e.name.startsWith("data-module")){var t=e.value,a=e.name.split("-").splice(2),o=r.toCamel(a)+"-"+t,n=!1;r.currentModules[o]?n=!0:r.currentModules[r.toUpper(o)]&&(o=r.toUpper(o),n=!0),n&&(r.destroyModule(r.currentModules[o]),delete r.currentModules[o])}})}),this.activeModules={},this.newModules={}}},{key:"destroyModules",value:function(){var e=this;Object.entries(this.currentModules).forEach(function(r){var t=zh(r,2),a=(t[0],t[1]);e.destroyModule(a)}),this.currentModules=[]}},{key:"destroyModule",value:function(e){e.mDestroy(),e.destroy()}},{key:"toCamel",value:function(e){var r=this;return e.reduce(function(e,t){return e+r.toUpper(t)})}},{key:"toUpper",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}]),e}();var Ab={};function Vy(r){return(Vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function yl(r){return Oy(r)||Py(r)||Sy(r)||Ty()}function Ty(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Sy(r,e){if(r){if("string"==typeof r)return nk(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?nk(r,e):void 0}}function Py(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function Oy(r){if(Array.isArray(r))return nk(r)}function nk(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Ny(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Dl(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Ly(r,e,t){return e&&Dl(r.prototype,e),t&&Dl(r,t),r}function Hy(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&Gy(r,e)}function Gy(r,e){return(Gy=Object.setPrototypeOf||function(r,e){return r.__proto__=e,r})(r,e)}function Fy(r){var e=Cy();return function(){var t,n=Il(r);if(e){var o=Il(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ey(this,t)}}function Ey(r,e){return!e||"object"!==Vy(e)&&"function"!=typeof e?Dy(r):e}function Dy(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Cy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}function Il(r){return(Il=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}var sj,Eh={};!function(e,t){"object"==typeof Eh?Eh=t():"function"==typeof sj&&sj.amd?sj(t):(e=e||self).barba=t()}(Eh,function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t,r){return(s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&i(o,r.prototype),o}).apply(null,arguments)}function a(e){var t="function"==typeof Map?new Map:void 0;return(a=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return s(e,arguments,o(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),i(r,e)})(e)}function u(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var c,h="2.9.7";!function(e){e[e.off=0]="off",e[e.error=1]="error",e[e.warning=2]="warning",e[e.info=3]="info",e[e.debug=4]="debug"}(c||(c={}));var f=c.off,l=function(){function e(e){this.t=e}e.getLevel=function(){return f},e.setLevel=function(e){return f=c[e]};var t=e.prototype;return t.error=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.i(console.error,c.error,t)},t.warn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.i(console.warn,c.warning,t)},t.info=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.i(console.info,c.info,t)},t.debug=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.i(console.log,c.debug,t)},t.i=function(t,r,n){r<=e.getLevel()&&t.apply(console,["["+this.t+"] "].concat(n))},e}(),p=S,v=P,d=b,m=x,g=A,y="/",w=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function b(e,t){for(var r,n=[],o=0,i=0,s="",a=t&&t.delimiter||y,u=t&&t.whitelist||void 0,c=!1;null!==(r=w.exec(e));){var h=r[0],f=r[1],l=r.index;if(s+=e.slice(i,l),i=l+h.length,f)s+=f[1],c=!0;else{var p="",v=r[2],d=r[3],m=r[4],g=r[5];if(!c&&s.length){var b=s.length-1,P=s[b];(!u||u.indexOf(P)>-1)&&(p=P,s=s.slice(0,b))}s&&(n.push(s),s="",c=!1);var x=d||m,j=p||a;n.push({name:v||o++,prefix:p,delimiter:j,optional:"?"===g||"*"===g,repeat:"+"===g||"*"===g,pattern:x?k(x):"[^"+E(j===a?j:j+a)+"]+?"})}}return(s||i<e.length)&&n.push(s+e.substr(i)),n}function P(e,t){return function(r,n){var o=e.exec(r);if(!o)return!1;for(var i=o[0],s=o.index,a={},u=n&&n.decode||decodeURIComponent,c=1;c<o.length;c++)if(void 0!==o[c]){var h=t[c-1];a[h.name]=h.repeat?o[c].split(h.delimiter).map(function(e){return u(e,h)}):u(o[c],h)}return{path:i,index:s,params:a}}}function x(e,t){for(var r=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(r[n]=new RegExp("^(?:"+e[n].pattern+")$",j(t)));return function(t,n){for(var o="",i=n&&n.encode||encodeURIComponent,s=!n||!1!==n.validate,a=0;a<e.length;a++){var u=e[a];if("string"!=typeof u){var c,h=t?t[u.name]:void 0;if(Array.isArray(h)){if(!u.repeat)throw new TypeError("Expected \""+u.name+"\" to not repeat, but got array");if(0===h.length){if(u.optional)continue;throw new TypeError("Expected \""+u.name+"\" to not be empty")}for(var f=0;f<h.length;f++){if(c=i(h[f],u),s&&!r[a].test(c))throw new TypeError("Expected all \""+u.name+"\" to match \""+u.pattern+"\"");o+=(0===f?u.prefix:u.delimiter)+c}}else if("string"!=typeof h&&"number"!=typeof h&&"boolean"!=typeof h){if(!u.optional)throw new TypeError("Expected \""+u.name+"\" to be "+(u.repeat?"an array":"a string"))}else{if(c=i(String(h),u),s&&!r[a].test(c))throw new TypeError("Expected \""+u.name+"\" to match \""+u.pattern+"\", but got \""+c+"\"");o+=u.prefix+c}}else o+=u}return o}}function E(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function k(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function j(e){return e&&e.sensitive?"":"i"}function A(e,t,r){for(var n=(r=r||{}).strict,o=!1!==r.start,i=!1!==r.end,s=r.delimiter||y,a=[].concat(r.endsWith||[]).map(E).concat("$").join("|"),u=o?"^":"",c=0;c<e.length;c++){var h=e[c];if("string"==typeof h)u+=E(h);else{var f=h.repeat?"(?:"+h.pattern+")(?:"+E(h.delimiter)+"(?:"+h.pattern+"))*":h.pattern;t&&t.push(h),u+=h.optional?h.prefix?"(?:"+E(h.prefix)+"("+f+"))?":"("+f+")?":E(h.prefix)+"("+f+")"}}if(i)n||(u+="(?:"+E(s)+")?"),u+="$"===a?"$":"(?="+a+")";else{var l=e[e.length-1],p="string"==typeof l?l[l.length-1]===s:void 0===l;n||(u+="(?:"+E(s)+"(?="+a+"))?"),p||(u+="(?="+E(s)+"|"+a+")")}return new RegExp(u,j(r))}function S(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(S(e[o],t,r).source);return new RegExp("(?:"+n.join("|")+")",j(r))}(e,t,r):function(e,t,r){return A(b(e,r),t,r)}(e,t,r)}p.match=function(e,t){var r=[];return P(S(e,r,t),r)},p.regexpToFunction=v,p.parse=d,p.compile=function(e,t){return x(b(e,t),t)},p.tokensToFunction=m,p.tokensToRegExp=g;var R={container:"container",history:"history",namespace:"namespace",prefix:"data-barba",prevent:"prevent",wrapper:"wrapper"},O=new(function(){function e(){this.o=R,this.u=new DOMParser}var t=e.prototype;return t.toString=function(e){return e.outerHTML},t.toDocument=function(e){return this.u.parseFromString(e,"text/html")},t.toElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t},t.getHtml=function(e){return void 0===e&&(e=document),this.toString(e.documentElement)},t.getWrapper=function(e){return void 0===e&&(e=document),e.querySelector("["+this.o.prefix+"=\""+this.o.wrapper+"\"]")},t.getContainer=function(e){return void 0===e&&(e=document),e.querySelector("["+this.o.prefix+"=\""+this.o.container+"\"]")},t.removeContainer=function(e){document.body.contains(e)&&e.parentNode.removeChild(e)},t.addContainer=function(e,t){var r=this.getContainer();r?this.s(e,r):t.appendChild(e)},t.getNamespace=function(e){void 0===e&&(e=document);var t=e.querySelector("["+this.o.prefix+"-"+this.o.namespace+"]");return t?t.getAttribute(this.o.prefix+"-"+this.o.namespace):null},t.getHref=function(e){if(e.tagName&&"a"===e.tagName.toLowerCase()){if("string"==typeof e.href)return e.href;var t=e.getAttribute("href")||e.getAttribute("xlink:href");if(t)return this.resolveUrl(t.baseVal||t)}return null},t.resolveUrl=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.length;if(0===n)throw new Error("resolveUrl requires at least one argument; got none.");var o=document.createElement("base");if(o.href=arguments[0],1===n)return o.href;var i=document.getElementsByTagName("head")[0];i.insertBefore(o,i.firstChild);for(var s,a=document.createElement("a"),u=1;u<n;u++)a.href=arguments[u],o.href=s=a.href;return i.removeChild(o),s},t.s=function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},e}()),L=new(function(){function e(){this.h=[],this.v=-1}var n=e.prototype;return n.init=function(e,t){this.l="barba";var r={ns:t,scroll:{x:window.scrollX,y:window.scrollY},url:e};this.h.push(r),this.v=0;var n={from:this.l,index:0,states:[].concat(this.h)};window.history&&window.history.replaceState(n,"",e)},n.change=function(e,t,r){if(r&&r.state){var n=r.state,o=n.index;t=this.m(this.v-o),this.replace(n.states),this.v=o}else this.add(e,t);return t},n.add=function(e,t){var r=this.size,n=this.p(t),o={ns:"tmp",scroll:{x:window.scrollX,y:window.scrollY},url:e};this.h.push(o),this.v=r;var i={from:this.l,index:r,states:[].concat(this.h)};switch(n){case"push":window.history&&window.history.pushState(i,"",e);break;case"replace":window.history&&window.history.replaceState(i,"",e);}},n.update=function(e,t){var n=t||this.v,o=r({},this.get(n),{},e);this.set(n,o)},n.remove=function(e){e?this.h.splice(e,1):this.h.pop(),this.v--},n.clear=function(){this.h=[],this.v=-1},n.replace=function(e){this.h=e},n.get=function(e){return this.h[e]},n.set=function(e,t){return this.h[e]=t},n.p=function(e){var t="push",r=e,n=R.prefix+"-"+R.history;return r.hasAttribute&&r.hasAttribute(n)&&(t=r.getAttribute(n)),t},n.m=function(e){return Math.abs(e)>1?e>0?"forward":"back":0===e?"popstate":e>0?"back":"forward"},t(e,[{key:"current",get:function(){return this.h[this.v]}},{key:"state",get:function(){return this.h[this.h.length-1]}},{key:"previous",get:function(){return this.v<1?null:this.h[this.v-1]}},{key:"size",get:function(){return this.h.length}}]),e}()),T=function(e,t){try{var r=function(){if(!t.next.html)return Promise.resolve(e).then(function(e){var r=t.next;if(e){var n=O.toElement(e);r.namespace=O.getNamespace(n),r.container=O.getContainer(n),r.html=e,L.update({ns:r.namespace});var o=O.toDocument(e);document.title=o.title}})}();return Promise.resolve(r&&r.then?r.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},$=p,q={__proto__:null,update:T,nextTick:function(){return new Promise(function(e){window.requestAnimationFrame(e)})},pathToRegexp:$},_=function(){return window.location.origin},B=function(e){return void 0===e&&(e=window.location.href),I(e).port},I=function(e){var t,r=e.match(/:\d+/);if(null===r)/^http/.test(e)&&(t=80),/^https/.test(e)&&(t=443);else{var n=r[0].substring(1);t=parseInt(n,10)}var o,i=e.replace(_(),""),s={},a=i.indexOf("#");a>=0&&(o=i.slice(a+1),i=i.slice(0,a));var u=i.indexOf("?");return u>=0&&(s=H(i.slice(u+1)),i=i.slice(0,u)),{hash:o,path:i,port:t,query:s}},H=function(e){return e.split("&").reduce(function(e,t){var r=t.split("=");return e[r[0]]=r[1],e},{})},M=function(e){return void 0===e&&(e=window.location.href),e.replace(/(\/#.*|\/|#.*)$/,"")},C={__proto__:null,getHref:function(){return window.location.href},getOrigin:_,getPort:B,getPath:function(e){return void 0===e&&(e=window.location.href),I(e).path},parse:I,parseQuery:H,clean:M};function F(e,t,r){return void 0===t&&(t=2e3),new Promise(function(n,o){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE)if(200===i.status)n(i.responseText);else if(i.status){var t={status:i.status,statusText:i.statusText};r(e,t),o(t)}},i.ontimeout=function(){var n=new Error("Timeout error ["+t+"]");r(e,n),o(n)},i.onerror=function(){var t=new Error("Fetch error");r(e,t),o(t)},i.open("GET",e),i.timeout=t,i.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml"),i.setRequestHeader("x-barba","yes"),i.send()})}var N=function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then};function D(e,t){return void 0===t&&(t={}),function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];var i=!1;return new Promise(function(r,o){t.async=function(){return i=!0,function(e,t){e?o(e):r(t)}};var s=e.apply(t,n);i||(N(s)?s.then(r,o):r(s))})}}var U=new(function(e){function t(){var t;return(t=e.call(this)||this).logger=new l("@barba/core"),t.all=["ready","page","reset","currentAdded","currentRemoved","nextAdded","nextRemoved","beforeOnce","once","afterOnce","before","beforeLeave","leave","afterLeave","beforeEnter","enter","afterEnter","after"],t.registered=new Map,t.init(),t}n(t,e);var r=t.prototype;return r.init=function(){var e=this;this.registered.clear(),this.all.forEach(function(t){e[t]||(e[t]=function(r,n){e.registered.has(t)||e.registered.set(t,new Set),e.registered.get(t).add({ctx:n||{},fn:r})})})},r.do=function(e){for(var t=this,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if(this.registered.has(e)){var i=Promise.resolve();return this.registered.get(e).forEach(function(e){i=i.then(function(){return D(e.fn,e.ctx).apply(void 0,n)})}),i.catch(function(r){t.logger.debug("Hook error ["+e+"]"),t.logger.error(r)})}return Promise.resolve()},r.clear=function(){var e=this;this.all.forEach(function(t){delete e[t]}),this.init()},r.help=function(){this.logger.info("Available hooks: "+this.all.join(","));var e=[];this.registered.forEach(function(t,r){return e.push(r)}),this.logger.info("Registered hooks: "+e.join(","))},t}(function(){})),W=function(){function e(e){if(this.P=[],"boolean"==typeof e)this.g=e;else{var t=Array.isArray(e)?e:[e];this.P=t.map(function(e){return $(e)})}}return e.prototype.checkHref=function(e){if("boolean"==typeof this.g)return this.g;var t=I(e).path;return this.P.some(function(e){return null!==e.exec(t)})},e}(),K=function(e){function t(t){var r;return(r=e.call(this,t)||this).k=new Map,r}n(t,e);var o=t.prototype;return o.set=function(e,t,r){return this.k.set(e,{action:r,request:t}),{action:r,request:t}},o.get=function(e){return this.k.get(e)},o.getRequest=function(e){return this.k.get(e).request},o.getAction=function(e){return this.k.get(e).action},o.has=function(e){return!this.checkHref(e)&&this.k.has(e)},o.delete=function(e){return this.k.delete(e)},o.update=function(e,t){var n=r({},this.k.get(e),{},t);return this.k.set(e,n),n},t}(W),X=function(){return!window.history.pushState},z=function(e){return!e.el||!e.href},Y=function(e){var t=e.event;return t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey},G=function(e){var t=e.el;return t.hasAttribute("target")&&"_blank"===t.target},Q=function(e){var t=e.el;return void 0!==t.protocol&&window.location.protocol!==t.protocol||void 0!==t.hostname&&window.location.hostname!==t.hostname},V=function(e){var t=e.el;return void 0!==t.port&&B()!==B(t.href)},J=function(e){var t=e.el;return t.getAttribute&&"string"==typeof t.getAttribute("download")},Z=function(e){return e.el.hasAttribute(R.prefix+"-"+R.prevent)},ee=function(e){return Boolean(e.el.closest("["+R.prefix+"-"+R.prevent+"=\"all\"]"))},te=function(e){var t=e.href;return M(t)===M()&&B(t)===B()},re=function(e){function t(t){var r;return(r=e.call(this,t)||this).suite=[],r.tests=new Map,r.init(),r}n(t,e);var r=t.prototype;return r.init=function(){this.add("pushState",X),this.add("exists",z),this.add("newTab",Y),this.add("blank",G),this.add("corsDomain",Q),this.add("corsPort",V),this.add("download",J),this.add("preventSelf",Z),this.add("preventAll",ee),this.add("sameUrl",te,!1)},r.add=function(e,t,r){void 0===r&&(r=!0),this.tests.set(e,t),r&&this.suite.push(e)},r.run=function(e,t,r,n){return this.tests.get(e)({el:t,event:r,href:n})},r.checkLink=function(e,t,r){var n=this;return this.suite.some(function(o){return n.run(o,e,t,r)})},t}(W),ne=function(e){function t(r,n){var o;void 0===n&&(n="Barba error");for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];return(o=e.call.apply(e,[this].concat(s))||this).error=r,o.label=n,Error.captureStackTrace&&Error.captureStackTrace(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(o),t),o.name="BarbaError",o}return n(t,e),t}(a(Error)),oe=function(){function e(e){void 0===e&&(e=[]),this.logger=new l("@barba/core"),this.all=[],this.page=[],this.once=[],this.A=[{name:"namespace",type:"strings"},{name:"custom",type:"function"}],e&&(this.all=this.all.concat(e)),this.update()}var t=e.prototype;return t.add=function(e,t){switch(e){case"rule":this.A.splice(t.position||0,0,t.value);break;case"transition":default:this.all.push(t);}this.update()},t.resolve=function(e,t){var r=this;void 0===t&&(t={});var n=t.once?this.once:this.page;n=n.filter(t.self?function(e){return e.name&&"self"===e.name}:function(e){return!e.name||"self"!==e.name});var o=new Map,i=n.find(function(n){var i=!0,s={};return!(!t.self||"self"!==n.name)||(r.A.reverse().forEach(function(t){i&&(i=r.R(n,t,e,s),n.from&&n.to&&(i=r.R(n,t,e,s,"from")&&r.R(n,t,e,s,"to")),n.from&&!n.to&&(i=r.R(n,t,e,s,"from")),!n.from&&n.to&&(i=r.R(n,t,e,s,"to")))}),o.set(n,s),i)}),s=o.get(i),a=[];if(a.push(t.once?"once":"page"),t.self&&a.push("self"),s){var u,c=[i];Object.keys(s).length>0&&c.push(s),(u=this.logger).info.apply(u,["Transition found ["+a.join(",")+"]"].concat(c))}else this.logger.info("No transition found ["+a.join(",")+"]");return i},t.update=function(){var e=this;this.all=this.all.map(function(t){return e.T(t)}).sort(function(e,t){return e.priority-t.priority}).reverse().map(function(e){return delete e.priority,e}),this.page=this.all.filter(function(e){return void 0!==e.leave||void 0!==e.enter}),this.once=this.all.filter(function(e){return void 0!==e.once})},t.R=function(e,t,r,n,o){var i=!0,s=!1,a=e,u=t.name,c=u,h=u,f=u,l=o?a[o]:a,p="to"===o?r.next:r.current;if(o?l&&l[u]:l[u]){switch(t.type){case"strings":default:var v=Array.isArray(l[c])?l[c]:[l[c]];p[c]&&-1!==v.indexOf(p[c])&&(s=!0),-1===v.indexOf(p[c])&&(i=!1);break;case"object":var d=Array.isArray(l[h])?l[h]:[l[h]];p[h]?(p[h].name&&-1!==d.indexOf(p[h].name)&&(s=!0),-1===d.indexOf(p[h].name)&&(i=!1)):i=!1;break;case"function":l[f](r)?s=!0:i=!1;}s&&(o?(n[o]=n[o]||{},n[o][u]=a[o][u]):n[u]=a[u])}return i},t.O=function(e,t,r){var n=0;return(e[t]||e.from&&e.from[t]||e.to&&e.to[t])&&(n+=Math.pow(10,r),e.from&&e.from[t]&&(n+=1),e.to&&e.to[t]&&(n+=2)),n},t.T=function(e){var t=this;e.priority=0;var r=0;return this.A.forEach(function(n,o){r+=t.O(e,n.name,o+1)}),e.priority=r,e},e}(),ie=function(){function e(e){void 0===e&&(e=[]),this.logger=new l("@barba/core"),this.S=!1,this.store=new oe(e)}var r=e.prototype;return r.get=function(e,t){return this.store.resolve(e,t)},r.doOnce=function(e){var t=e.data,r=e.transition;try{var n=function(){o.S=!1},o=this,i=r||{};o.S=!0;var s=u(function(){return Promise.resolve(o.j("beforeOnce",t,i)).then(function(){return Promise.resolve(o.once(t,i)).then(function(){return Promise.resolve(o.j("afterOnce",t,i)).then(function(){})})})},function(e){o.S=!1,o.logger.debug("Transition error [before/after/once]"),o.logger.error(e)});return Promise.resolve(s&&s.then?s.then(n):n())}catch(e){return Promise.reject(e)}},r.doPage=function(e){var t=e.data,r=e.transition,n=e.page,o=e.wrapper;try{var i=function(e){if(s)return e;a.S=!1},s=!1,a=this,c=r||{},h=!0===c.sync||!1;a.S=!0;var f=u(function(){function e(){return Promise.resolve(a.j("before",t,c)).then(function(){var e=!1;function r(r){return e?r:Promise.resolve(a.remove(t)).then(function(){return Promise.resolve(a.j("after",t,c)).then(function(){})})}var i=function(){if(h)return u(function(){return Promise.resolve(a.add(t,o)).then(function(){return Promise.resolve(a.j("beforeLeave",t,c)).then(function(){return Promise.resolve(a.j("beforeEnter",t,c)).then(function(){return Promise.resolve(Promise.all([a.leave(t,c),a.enter(t,c)])).then(function(){return Promise.resolve(a.j("afterLeave",t,c)).then(function(){return Promise.resolve(a.j("afterEnter",t,c)).then(function(){})})})})})})},function(e){if(a.M(e))throw new ne(e,"Transition error [sync]")});var r=function(r){return e?r:u(function(){var e=function(){if(!1!==i)return Promise.resolve(a.add(t,o)).then(function(){return Promise.resolve(a.j("beforeEnter",t,c)).then(function(){return Promise.resolve(a.enter(t,c,i)).then(function(){return Promise.resolve(a.j("afterEnter",t,c)).then(function(){})})})})}();if(e&&e.then)return e.then(function(){})},function(e){if(a.M(e))throw new ne(e,"Transition error [before/after/enter]")})},i=!1,s=u(function(){return Promise.resolve(a.j("beforeLeave",t,c)).then(function(){return Promise.resolve(Promise.all([a.leave(t,c),T(n,t)]).then(function(e){return e[0]})).then(function(e){return i=e,Promise.resolve(a.j("afterLeave",t,c)).then(function(){})})})},function(e){if(a.M(e))throw new ne(e,"Transition error [before/after/leave]")});return s&&s.then?s.then(r):r(s)}();return i&&i.then?i.then(r):r(i)})}var r=function(){if(h)return Promise.resolve(T(n,t)).then(function(){})}();return r&&r.then?r.then(e):e()},function(e){if(a.S=!1,e.name&&"BarbaError"===e.name)throw a.logger.debug(e.label),a.logger.error(e.error),e;throw a.logger.debug("Transition error [page]"),a.logger.error(e),e});return Promise.resolve(f&&f.then?f.then(i):i(f))}catch(e){return Promise.reject(e)}},r.once=function(e,t){try{return Promise.resolve(U.do("once",e,t)).then(function(){return t.once?D(t.once,t)(e):Promise.resolve()})}catch(e){return Promise.reject(e)}},r.leave=function(e,t){try{return Promise.resolve(U.do("leave",e,t)).then(function(){return t.leave?D(t.leave,t)(e):Promise.resolve()})}catch(e){return Promise.reject(e)}},r.enter=function(e,t,r){try{return Promise.resolve(U.do("enter",e,t)).then(function(){return t.enter?D(t.enter,t)(e,r):Promise.resolve()})}catch(e){return Promise.reject(e)}},r.add=function(e,t){try{return O.addContainer(e.next.container,t),U.do("nextAdded",e),Promise.resolve()}catch(e){return Promise.reject(e)}},r.remove=function(e){try{return O.removeContainer(e.current.container),U.do("currentRemoved",e),Promise.resolve()}catch(e){return Promise.reject(e)}},r.M=function(e){return e.message?!/Timeout error|Fetch error/.test(e.message):!e.status},r.j=function(e,t,r){try{return Promise.resolve(U.do(e,t,r)).then(function(){return r[e]?D(r[e],r)(t):Promise.resolve()})}catch(e){return Promise.reject(e)}},t(e,[{key:"isRunning",get:function(){return this.S},set:function(e){this.S=e}},{key:"hasOnce",get:function(){return this.store.once.length>0}},{key:"hasSelf",get:function(){return this.store.all.some(function(e){return"self"===e.name})}},{key:"shouldWait",get:function(){return this.store.all.some(function(e){return e.to&&!e.to.route||e.sync})}}]),e}(),se=function(){function e(e){var t=this;this.names=["beforeLeave","afterLeave","beforeEnter","afterEnter"],this.byNamespace=new Map,0!==e.length&&(e.forEach(function(e){t.byNamespace.set(e.namespace,e)}),this.names.forEach(function(e){U[e](t.L(e))}))}return e.prototype.L=function(e){var t=this;return function(r){var n=e.match(/enter/i)?r.next:r.current,o=t.byNamespace.get(n.namespace);return o&&o[e]?D(o[e],o)(r):Promise.resolve()}},e}();Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var ae={container:null,html:"",namespace:"",url:{hash:"",href:"",path:"",port:null,query:{}}};return new(function(){function e(){this.version=h,this.schemaPage=ae,this.Logger=l,this.logger=new l("@barba/core"),this.plugins=[],this.hooks=U,this.dom=O,this.helpers=q,this.history=L,this.request=F,this.url=C}var n=e.prototype;return n.use=function(e,t){var r=this.plugins;r.indexOf(e)>-1?this.logger.warn("Plugin ["+e.name+"] already installed."):"function"==typeof e.install?(e.install(this,t),r.push(e)):this.logger.warn("Plugin ["+e.name+"] has no \"install\" method.")},n.init=function(e){var t=void 0===e?{}:e,n=t.transitions,o=void 0===n?[]:n,i=t.views,s=void 0===i?[]:i,a=t.schema,u=void 0===a?R:a,c=t.requestError,h=t.timeout,f=void 0===h?2e3:h,p=t.cacheIgnore,v=void 0!==p&&p,d=t.prefetchIgnore,m=void 0!==d&&d,g=t.preventRunning,y=void 0!==g&&g,w=t.prevent,b=void 0===w?null:w,P=t.debug,x=t.logLevel;if(l.setLevel(!0===(void 0!==P&&P)?"debug":void 0===x?"off":x),this.logger.info(this.version),Object.keys(u).forEach(function(e){R[e]&&(R[e]=u[e])}),this.$=c,this.timeout=f,this.cacheIgnore=v,this.prefetchIgnore=m,this.preventRunning=y,this._=this.dom.getWrapper(),!this._)throw new Error("[@barba/core] No Barba wrapper found");this._.setAttribute("aria-live","polite"),this.q();var E=this.data.current;if(!E.container)throw new Error("[@barba/core] No Barba container found");if(this.cache=new K(v),this.prevent=new re(m),this.transitions=new ie(o),this.views=new se(s),null!==b){if("function"!=typeof b)throw new Error("[@barba/core] Prevent should be a function");this.prevent.add("preventCustom",b)}this.history.init(E.url.href,E.namespace),this.B=this.B.bind(this),this.U=this.U.bind(this),this.D=this.D.bind(this),this.F(),this.plugins.forEach(function(e){return e.init()});var k=this.data;k.trigger="barba",k.next=k.current,k.current=r({},this.schemaPage),this.hooks.do("ready",k),this.once(k),this.q()},n.destroy=function(){this.q(),this.H(),this.history.clear(),this.hooks.clear(),this.plugins=[]},n.force=function(e){window.location.assign(e)},n.go=function(e,t,r){var n;if(void 0===t&&(t="barba"),this.transitions.isRunning)this.force(e);else if(!(n="popstate"===t?this.history.current&&this.url.getPath(this.history.current.url)===this.url.getPath(e):this.prevent.run("sameUrl",null,null,e))||this.transitions.hasSelf)return t=this.history.change(e,t,r),r&&(r.stopPropagation(),r.preventDefault()),this.page(e,t,n)},n.once=function(e){try{var t=this;return Promise.resolve(t.hooks.do("beforeEnter",e)).then(function(){function r(){return Promise.resolve(t.hooks.do("afterEnter",e)).then(function(){})}var n=function(){if(t.transitions.hasOnce){var r=t.transitions.get(e,{once:!0});return Promise.resolve(t.transitions.doOnce({transition:r,data:e})).then(function(){})}}();return n&&n.then?n.then(r):r()})}catch(e){return Promise.reject(e)}},n.page=function(e,t,n){try{var o=function(){var e=i.data;return Promise.resolve(i.hooks.do("page",e)).then(function(){var t=u(function(){var t=i.transitions.get(e,{once:!1,self:n});return Promise.resolve(i.transitions.doPage({data:e,page:s,transition:t,wrapper:i._})).then(function(){i.q()})},function(){0===l.getLevel()&&i.force(e.current.url.href)});if(t&&t.then)return t.then(function(){})})},i=this;i.data.next.url=r({href:e},i.url.parse(e)),i.data.trigger=t;var s=i.cache.has(e)?i.cache.update(e,{action:"click"}).request:i.cache.set(e,i.request(e,i.timeout,i.onRequestError.bind(i,t)),"click").request,a=function(){if(i.transitions.shouldWait)return Promise.resolve(T(s,i.data)).then(function(){})}();return Promise.resolve(a&&a.then?a.then(o):o())}catch(e){return Promise.reject(e)}},n.onRequestError=function(e){this.transitions.isRunning=!1;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=r[0],i=r[1],s=this.cache.getAction(o);return this.cache.delete(o),!(this.$&&!1===this.$(e,s,o,i)||("click"===s&&this.force(o),1))},n.prefetch=function(e){var t=this;this.cache.has(e)||this.cache.set(e,this.request(e,this.timeout,this.onRequestError.bind(this,"barba")).catch(function(e){t.logger.error(e)}),"prefetch")},n.F=function(){!0!==this.prefetchIgnore&&(document.addEventListener("mouseover",this.B),document.addEventListener("touchstart",this.B)),document.addEventListener("click",this.U),window.addEventListener("popstate",this.D)},n.H=function(){!0!==this.prefetchIgnore&&(document.removeEventListener("mouseover",this.B),document.removeEventListener("touchstart",this.B)),document.removeEventListener("click",this.U),window.removeEventListener("popstate",this.D)},n.B=function(e){var t=this,r=this.I(e);if(r){var n=this.dom.getHref(r);this.prevent.checkHref(n)||this.cache.has(n)||this.cache.set(n,this.request(n,this.timeout,this.onRequestError.bind(this,r)).catch(function(e){t.logger.error(e)}),"enter")}},n.U=function(e){var t=this.I(e);if(t)return this.transitions.isRunning&&this.preventRunning?(e.preventDefault(),void e.stopPropagation()):void this.go(this.dom.getHref(t),t,e)},n.D=function(e){this.go(this.url.getHref(),"popstate",e)},n.I=function(e){for(var t=e.target;t&&!this.dom.getHref(t);)t=t.parentNode;if(t&&!this.prevent.checkLink(t,e,this.dom.getHref(t)))return t},n.q=function(){var e=this.url.getHref(),t={container:this.dom.getContainer(),html:this.dom.getHtml(),namespace:this.dom.getNamespace(),url:r({href:e},this.url.parse(e))};this.C={current:t,next:r({},this.schemaPage),trigger:void 0},this.hooks.do("reset",this.data)},t(e,[{key:"data",get:function(){return this.C}},{key:"wrapper",get:function(){return this._}}]),e}())});var Ay={};function Yj(){}Yj.prototype={on:function(t,e,i){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:i}),this},once:function(t,e,i){var n=this;function r(){n.off(t,r),e.apply(i,arguments)}return r._=e,this.on(t,r,i)},emit:function(t){for(var e=[].slice.call(arguments,1),i=((this.e||(this.e={}))[t]||[]).slice(),n=0,r=i.length;n<r;n++)i[n].fn.apply(i[n].ctx,e);return this},off:function(t,e){var i=this.e||(this.e={}),n=i[t],r=[];if(n&&e)for(var f=0,o=n.length;f<o;f++)n[f].fn!==e&&n[f].fn._!==e&&r.push(n[f]);return r.length?i[t]=r:delete i[t],this}},(Ay=Yj).TinyEmitter=Yj;var zy=zb(Ay);var Ia=new zy.d;function xy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wl(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function uy(t,e,r){return e&&Wl(t.prototype,e),r&&Wl(t,r),t}function dc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xl(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r}var Ha,cc,bm,oy,my,ly,eg,dm,sb={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ld={duration:.5,overwrite:!1,delay:0},Lb=1e8,ra=1/Lb,pk=2*Math.PI,jy=pk/4,hy=0,gm=Math.sqrt,_x=Math.cos,Xx=Math.sin,Ta=function(t){return"string"==typeof t},Ja=function(t){return"function"==typeof t},Eb=function(t){return"number"==typeof t},Ci=function(t){return void 0===t},kc=function(t){return"object"==typeof t},ab=function(t){return!1!==t},pm=function(){return"undefined"!=typeof window},wm=function(t){return Ja(t)||Ta(t)},ym="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},pb=Array.isArray,hj=/(?:-?\.?\d|\.)+/gi,zm=/[-+=.]*\d+[.e\-+]*\d*[e\-\+]*\d*/g,Qd=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,uj=/[-+=.]*\d+(?:\.|e-|e)*\d*/gi,Bm=/[+-]=-?[\.\d]+/,Dm=/[#\-+.]*\b[a-z\d-=+%.]+/gi,jb={},$j={},Em=function(t){return($j=Oe(t,jb))&&$b},fk=function(t,r){return console.warn("Invalid property",t,"set to",r,"Missing plugin? gsap.registerPlugin()")},Jm=function(t,r){return!r&&console.warn(t)},Wm=function(t,r){return t&&(jb[t]=r)&&$j&&($j[t]=r)||jb},If=function(){return 0},ok={},zc=[],Xm={},eb={},wk={},cx=30,Fg=[],Ym="",Gk=function(t){var r,e,$=t[0];if(kc($)||Ja($)||(t=[t]),!(r=($._gsap||{}).harness)){for(e=Fg.length;e--&&!Fg[e].targetTest($););r=Fg[e]}for(e=t.length;e--;)t[e]&&(t[e]._gsap||(t[e]._gsap=new Qn(t[e],r)))||t.splice(e,1);return t},pd=function(t){return t._gsap||Gk(Rb(t))[0]._gsap},Zm=function(t,r,e){return(e=t[r])&&Ja(e)?t[r]():Ci(e)&&t.getAttribute&&t.getAttribute(r)||e},fb=function(t,r){return(t=t.split(",")).forEach(r)||t},pa=function(t){return Math.round(1e5*t)/1e5||0},$w=function(t,r){for(var e=r.length,$=0;t.indexOf(r[$])<0&&++$<e;);return $<e},Uf=function(t,r,e){var $,a=Eb(t[1]),i=(a?2:1)+(r<2?0:1),n=t[i];if(a&&(n.duration=t[1]),n.parent=e,r){for($=n;e&&!("immediateRender"in $);)$=e.vars.defaults||{},e=ab(e.vars.inherit)&&e.parent;n.immediateRender=ab($.immediateRender),r<2?n.runBackwards=1:n.startAt=t[i-1]}return n},wg=function(){var t,r,e=zc.length,$=zc.slice(0);for(Xm={},zc.length=0,t=0;t<e;t++)(r=$[t])&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},dn=function(t,r,e,$){zc.length&&wg(),t.render(r,e,$),zc.length&&wg()},fn=function(t){var r=parseFloat(t);return(r||0===r)&&(t+"").match(Dm).length<2?r:Ta(t)?t.trim():t},gn=function(t){return t},wb=function(t,r){for(var e in r)e in t||(t[e]=r[e]);return t},Ww=function(t,r){for(var e in r)e in t||"duration"===e||"ease"===e||(t[e]=r[e])},Oe=function(t,r){for(var e in r)t[e]=r[e];return t},jn=function t(r,e){for(var $ in e)r[$]=kc(e[$])?t(r[$]||(r[$]={}),e[$]):e[$];return r},Ri=function(t,r){var e,$={};for(e in t)e in r||($[e]=t[e]);return $},sg=function(t){var r=t.parent||Ha,e=t.keyframes?Ww:wb;if(ab(t.inherit))for(;r;)e(t,r.vars.defaults),r=r.parent||r._dp;return t},Uw=function(t,r){for(var e=t.length,$=e===r.length;$&&e--&&t[e]===r[e];);return e<0},Tw=function(t,r,e,$,a){void 0===e&&(e="_first"),void 0===$&&($="_last");var i,n=t[$];if(a)for(i=r[a];n&&n[a]>i;)n=n._prev;return n?(r._next=n._next,n._next=r):(r._next=t[e],t[e]=r),r._next?r._next._prev=r:t[$]=r,r._prev=n,r.parent=r._dp=t,r},pg=function(t,r,e,$){void 0===e&&(e="_first"),void 0===$&&($="_last");var a=r._prev,i=r._next;a?a._next=i:t[e]===r&&(t[e]=i),i?i._prev=a:t[$]===r&&(t[$]=a),r._next=r._prev=r.parent=null},Ec=function(t,r){t.parent&&(!r||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},rd=function(t,r){if(t&&(!r||r._end>t._dur||r._start<0))for(var e=t;e;)e._dirty=1,e=e.parent;return t},Sw=function(t){for(var r=t.parent;r&&r.parent;)r._dirty=1,r.totalDuration(),r=r.parent;return t},Rw=function t(r){return!r||r._ts&&t(r.parent)},kn=function(t){return t._repeat?Ue(t._tTime,t=t.duration()+t._rDelay)*t:0},Ue=function(t,r){return(t/=r)&&~~t===t?~~t-1:~~t},og=function(t,r){return(t-r._start)*r._ts+(r._ts>=0?0:r._dirty?r.totalDuration():r._tDur)},vj=function(t){return t._end=pa(t._start+(t._tDur/Math.abs(t._ts||t._rts||ra)||0))},ln=function(t,r){var e=t._dp;return e&&e.smoothChildTiming&&t._ts&&(t._start=pa(t._dp._time-(t._ts>0?r/t._ts:((t._dirty?t.totalDuration():t._tDur)-r)/-t._ts)),vj(t),e._dirty||rd(e,t)),t},Mj=function(t,r){var e;if((r._time||r._initted&&!r._dur)&&(e=og(t.rawTime(),r),(!r._dur||Zf(0,r.totalDuration(),e)-r._tTime>ra)&&r.render(e,!0)),rd(t,r)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(e=t;e._dp;)e.rawTime()>=0&&e.totalTime(e._tTime),e=e._dp;t._zTime=-ra}},bc=function(t,r,e,$){return r.parent&&Ec(r),r._start=pa(e+r._delay),r._end=pa(r._start+(r.totalDuration()/Math.abs(r.timeScale())||0)),Tw(t,r,"_first","_last",t._sort?"_start":0),t._recent=r,$||Mj(t,r),t},mn=function(t,r){return(jb.ScrollTrigger||fk("scrollTrigger",r))&&jb.ScrollTrigger.create(r,t)},pn=function(t,r,e,$){return Ov(t,r),t._initted?!e&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&ly!==ob.frame?(zc.push(t),t._lazy=[r,$],1):void 0:1},Mw=function(t,r,e,$){var a,i,n=t.ratio,o=r<0||!r&&n&&!t._start&&t._zTime>ra&&!t._dp._lock||(t._ts<0||t._dp._ts<0)&&"isFromStart"!==t.data&&"isStart"!==t.data?0:1,s=t._rDelay,_=0;if(s&&t._repeat&&(_=Zf(0,t._tDur,r),Ue(_,s)!==(i=Ue(t._tTime,s))&&(n=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==n||$||t._zTime===ra||!r&&t._zTime){if(!t._initted&&pn(t,r,$,e))return;for(i=t._zTime,t._zTime=r||(e?ra:0),e||(e=r&&!i),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=_,e||mb(t,"onStart"),a=t._pt;a;)a.r(o,a.d),a=a._next;t._startAt&&r<0&&t._startAt.render(r,!0,!0),t._onUpdate&&!e&&mb(t,"onUpdate"),_&&t._repeat&&!e&&t.parent&&mb(t,"onRepeat"),(r>=t._tDur||r<0)&&t.ratio===o&&(o&&Ec(t,1),e||(mb(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=r)},Lw=function(t,r,e){var $;if(e>r)for($=t._first;$&&$._start<=e;){if(!$._dur&&"isPause"===$.data&&$._start>r)return $;$=$._next}else for($=t._last;$&&$._start>=e;){if(!$._dur&&"isPause"===$.data&&$._start<r)return $;$=$._prev}},Qe=function(t,r,e,$){var a=t._repeat,i=pa(r)||0,n=t._tTime/t._tDur;return n&&!$&&(t._time*=i/t._dur),t._dur=i,t._tDur=a?a<0?1e10:pa(i*(a+1)+t._rDelay*a):i,n&&!$?ln(t,t._tTime=t._tDur*n):t.parent&&vj(t),e||rd(t.parent,t),t},sn=function(t){return t instanceof db?rd(t):Qe(t,t._dur)},Jw={_start:0,endTime:If},Ya=function t(r,e){var $,a,i=r.labels,n=r._recent||Jw,o=r.duration()>=Lb?n.endTime(!1):r._dur;return Ta(e)&&(isNaN(e)||e in i)?"<"===($=e.charAt(0))||">"===$?("<"===$?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0):($=e.indexOf("="))<0?(e in i||(i[e]=o),i[e]):(a=+(e.charAt($-1)+e.substr($+1)),$>1?t(r,e.substr(0,$-1))+a:o+a):null==e?o:+e},xc=function(t,r){return t||0===t?r(t):r},Zf=function(t,r,e){return e<t?t:e>r?r:e},Nb=function(t){return(t=(t+"").substr((parseFloat(t)+"").length))&&isNaN(t)?t:""},Iw=function(t,r,e){return xc(e,function(e){return Zf(t,r,e)})},sk=[].slice,tn=function(t,r){return t&&kc(t)&&"length"in t&&(!r&&!t.length||t.length-1 in t&&kc(t[0]))&&!t.nodeType&&t!==cc},Gw=function(t,r,e){return void 0===e&&(e=[]),t.forEach(function(t){var $;return Ta(t)&&!r||tn(t,1)?($=e).push.apply($,Rb(t)):e.push(t)})||e},Rb=function(t,r){return!Ta(t)||r||!bm&&we()?pb(t)?Gw(t,r):tn(t)?sk.call(t,0):t?[t]:[]:sk.call(oy.querySelectorAll(t),0)},un=function(t){return t.sort(function(){return .5-Math.random()})},vn=function(t){if(Ja(t))return t;var r=kc(t)?t:{each:t},e=je(r.ease),$=r.from||0,a=parseFloat(r.base)||0,i={},n=$>0&&$<1,o=isNaN($)||n,s=r.axis,_=$,p=$;return Ta($)?_=p={center:.5,edges:.5,end:1}[$]||0:!n&&o&&(_=$[0],p=$[1]),function(t,n,u){var O,U,l,K,v,h,c,f,d,m=(u||r).length,g=i[m];if(!g){if(!(d="auto"===r.grid?0:(r.grid||[1,Lb])[1])){for(c=-Lb;c<(c=u[d++].getBoundingClientRect().left)&&d<m;);d--}for(g=i[m]=[],O=o?Math.min(d,m)*_-.5:$%d,U=o?m*p/d-.5:$/d|0,c=0,f=Lb,h=0;h<m;h++)l=h%d-O,K=U-(h/d|0),g[h]=v=s?Math.abs("y"===s?K:l):gm(l*l+K*K),v>c&&(c=v),v<f&&(f=v);"random"===$&&un(g),g.max=c-f,g.min=f,g.v=m=(parseFloat(r.amount)||parseFloat(r.each)*(d>m?m-1:s?"y"===s?m/d:d:Math.max(d,m/d))||0)*("edges"===$?-1:1),g.b=m<0?a-m:a,g.u=Nb(r.amount||r.each)||0,e=e&&m<0?Mn(e):e}return m=(g[t]-g.min)/g.max||0,pa(g.b+(e?e(m):m)*g.v)+g.u}},Ck=function(t){var r=t<1?Math.pow(10,(t+"").length-2):1;return function(e){return Math.floor(Math.round(parseFloat(e)/t)*t*r)/r+(Eb(e)?0:Nb(e))}},xn=function(t,r){var e,$,a=pb(t);return!a&&kc(t)&&(e=a=t.radius||Lb,t.values?(t=Rb(t.values),($=!Eb(t[0]))&&(e*=e)):t=Ck(t.increment)),xc(r,a?Ja(t)?function(r){return $=t(r),Math.abs($-r)<=e?$:r}:function(r){for(var a,i,n=parseFloat($?r.x:r),o=parseFloat($?r.y:0),s=Lb,_=0,p=t.length;p--;)(a=$?(a=t[p].x-n)*a+(i=t[p].y-o)*i:Math.abs(t[p]-n))<s&&(s=a,_=p);return _=!e||s<=e?t[_]:r,$||_===r||Eb(r)?_:_+Nb(r)}:Ck(t))},yn=function(t,r,e,$){return xc(pb(t)?!r:!0===e?!!(e=0):!$,function(){return pb(t)?t[~~(Math.random()*t.length)]:(e=e||1e-5)&&($=e<1?Math.pow(10,(e+"").length-2):1)&&Math.floor(Math.round((t+Math.random()*(r-t))/e)*e*$)/$})},Bw=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return function(t){return r.reduce(function(t,r){return r(t)},t)}},Aw=function(t,r){return function(e){return t(parseFloat(e))+(r||Nb(e))}},vw=function(t,r,e){return Cn(t,r,0,1,e)},Bn=function(t,r,e){return xc(e,function(e){return t[~~r(e)]})},pw=function t(r,e,$){var a=e-r;return pb(r)?Bn(r,t(0,r.length),e):xc($,function(t){return(a+(t-r)%a)%a+r})},ow=function t(r,e,$){var a=e-r,i=2*a;return pb(r)?Bn(r,t(0,r.length-1),e):xc($,function(t){return r+((t=(i+(t-r)%i)%i||0)>a?i-t:t)})},Dg=function(t){for(var r,e,$,a,i=0,n="";~(r=t.indexOf("random(",i));)$=t.indexOf(")",r),a="["===t.charAt(r+7),e=t.substr(r+7,$-r-7).match(a?Dm:hj),n+=t.substr(i,r-i)+yn(a?e:+e[0],a?0:+e[1],+e[2]||1e-5),i=$+1;return n+t.substr(i,t.length-i)},Cn=function(t,r,e,$,a){var i=r-t,n=$-e;return xc(a,function(r){return e+((r-t)/i*n||0)})},mw=function t(r,e,$,a){var i=isNaN(r+e)?0:function(t){return(1-t)*r+t*e};if(!i){var n,o,s,_,p,u=Ta(r),O={};if(!0===$&&(a=1)&&($=null),u)r={p:r},e={p:e};else if(pb(r)&&!pb(e)){for(s=[],_=r.length,p=_-2,o=1;o<_;o++)s.push(t(r[o-1],r[o]));_--,i=function(t){t*=_;var r=Math.min(p,~~t);return s[r](t-r)},$=e}else a||(r=Oe(pb(r)?[]:{},r));if(!s){for(n in e)Tj.call(O,r,n,"get",e[n]);i=function(t){return qk(t,O)||(u?r.p:r)}}}return xc($,i)},Dn=function(t,r,e){var $,a,i,n=t.labels,o=Lb;for($ in n)(a=n[$]-r)<0==!!e&&a&&o>(a=Math.abs(a))&&(i=$,o=a);return i},mb=function(t,r,e){var $,a,i=t.vars,n=i[r];if(n)return $=i[r+"Params"],a=i.callbackScope||t,e&&zc.length&&wg(),$?n.apply(a,$):n.call(a)},Qf=function(t){return Ec(t),t.progress()<1&&mb(t,"onInterrupt"),t},kw=function(t){var r=(t=!t.name&&t.default||t).name,e=Ja(t),$=r&&!e&&t.init?function(){this._props=[]}:t,a={init:If,render:qk,add:Tj,kill:Cv,modifier:Dv,rawVars:0},i={targetTest:0,get:0,getSetter:kk,aliases:{},register:0};if(we(),t!==$){if(eb[r])return;wb($,wb(Ri(t,a),i)),Oe($.prototype,Oe(a,Ri(t,i))),eb[$.prop=r]=$,t.targetTest&&(Fg.push($),ok[r]=1),r=("css"===r?"CSS":r.charAt(0).toUpperCase()+r.substr(1))+"Plugin"}Wm(r,$),t.register&&t.register($b,$,bb)},ya=255,Gf={aqua:[0,ya,ya],lime:[0,ya,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ya],navy:[0,0,128],white:[ya,ya,ya],olive:[128,128,0],yellow:[ya,ya,0],orange:[ya,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ya,0,0],pink:[ya,192,203],cyan:[0,ya,ya],transparent:[ya,ya,ya,0]},Li=function(t,r,e){return(6*(t=t<0?t+1:t>1?t-1:t)<1?r+(e-r)*t*6:t<.5?e:3*t<2?r+(e-r)*(2/3-t)*6:r)*ya+.5|0},En=function(t,r,e){var $,a,i,n,o,s,_,p,u,O,U=t?Eb(t)?[t>>16,t>>8&ya,t&ya]:0:Gf.black;if(!U){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),Gf[t])U=Gf[t];else if("#"===t.charAt(0))4===t.length&&($=t.charAt(1),a=t.charAt(2),i=t.charAt(3),t="#"+$+$+a+a+i+i),U=[(t=parseInt(t.substr(1),16))>>16,t>>8&ya,t&ya];else if("hsl"===t.substr(0,3)){if(U=O=t.match(hj),r){if(~t.indexOf("="))return U=t.match(zm),e&&U.length<4&&(U[3]=1),U}else n=+U[0]%360/360,o=+U[1]/100,$=2*(s=+U[2]/100)-(a=s<=.5?s*(o+1):s+o-s*o),U.length>3&&(U[3]*=1),U[0]=Li(n+1/3,$,a),U[1]=Li(n,$,a),U[2]=Li(n-1/3,$,a);}else U=t.match(hj)||Gf.transparent;U=U.map(Number)}return r&&!O&&($=U[0]/ya,a=U[1]/ya,i=U[2]/ya,s=((_=Math.max($,a,i))+(p=Math.min($,a,i)))/2,_===p?n=o=0:(u=_-p,o=s>.5?u/(2-_-p):u/(_+p),n=_===$?(a-i)/u+(a<i?6:0):_===a?(i-$)/u+2:($-a)/u+4,n*=60),U[0]=~~(n+.5),U[1]=~~(100*o+.5),U[2]=~~(100*s+.5)),e&&U.length<4&&(U[3]=1),U},Fn=function(t){var r=[],e=[],$=-1;return t.split(ze).forEach(function(t){var a=t.match(Qd)||[];r.push.apply(r,a),e.push($+=a.length+1)}),r.c=e,r},Gn=function(t,r,e){var $,a,i,n,o="",s=(t+o).match(ze),_=r?"hsla(":"rgba(",p=0;if(!s)return t;if(s=s.map(function(t){return(t=En(t,r,1))&&_+(r?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"}),e&&(i=Fn(t),($=e.c).join(o)!==i.c.join(o)))for(n=(a=t.replace(ze,"1").split(Qd)).length-1;p<n;p++)o+=a[p]+(~$.indexOf(p)?s.shift()||_+"0,0,0,0)":(i.length?i:s.length?s:e).shift());if(!a)for(n=(a=t.split(ze)).length-1;p<n;p++)o+=a[p]+s[p];return o+a[n]},ze=function(){var t,r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(t in Gf)r+="|"+t+"\\b";return new RegExp(r+")","gi")}(),gw=/hsl[a]?\(/,Hn=function(t){var r,e=t.join(" ");if(ze.lastIndex=0,ze.test(e))return r=gw.test(e),t[1]=Gn(t[1],r),t[0]=Gn(t[0],r,Fn(t[1])),!0},ob=function(){var t,r,e,$,a,i,n=Date.now,o=500,s=33,_=n(),p=_,u=1e3/240,O=u,U=[],l=function e(l){var K,v,h,c,f=n()-p,d=!0===l;if(f>o&&(_+=f-s),((K=(h=(p+=f)-_)-O)>0||d)&&(c=++$.frame,a=h-1e3*$.time,$.time=h/=1e3,O+=K+(K>=u?4:u-K),v=1),d||(t=r(e)),v)for(i=0;i<U.length;i++)U[i](h,a,c,l)};return $={time:0,frame:0,tick:function(){l(!0)},deltaRatio:function(t){return a/(1e3/(t||60))},wake:function(){my&&(!bm&&pm()&&(cc=bm=window,oy=cc.document||{},jb.gsap=$b,(cc.gsapVersions||(cc.gsapVersions=[])).push($b.version),Em($j||cc.GreenSockGlobals||!cc.gsap&&cc||{}),e=cc.requestAnimationFrame),t&&$.sleep(),r=e||function(t){return setTimeout(t,O-1e3*$.time+1|0)},dm=1,l(2))},sleep:function(){(e?cc.cancelAnimationFrame:clearTimeout)(t),dm=0,r=If},lagSmoothing:function(t,r){o=t||1/ra,s=Math.min(r,o,0)},fps:function(t){u=1e3/(t||240),O=1e3*$.time+u},add:function(t){U.indexOf(t)<0&&U.push(t),we()},remove:function(t){var r;~(r=U.indexOf(t))&&U.splice(r,1)&&i>=r&&i--},_listeners:U}}(),we=function(){return!dm&&ob.wake()},qa={},bw=/^[\d.\-M][\d.\-,\s]/,aw=/["']/g,_v=function(t){for(var r,e,$,a={},i=t.substr(1,t.length-3).split(":"),n=i[0],o=1,s=i.length;o<s;o++)e=i[o],r=o!==s-1?e.lastIndexOf(","):e.length,$=e.substr(0,r),a[n]=isNaN($)?$.replace(aw,"").trim():+$,n=e.substr(r+1).trim();return a},Zv=function(t){var r=t.indexOf("(")+1,e=t.indexOf(")"),$=t.indexOf("(",r);return t.substring(r,~$&&$<e?t.indexOf(")",e+1):e)},Yv=function(t){var r=(t+"").split("("),e=qa[r[0]];return e&&r.length>1&&e.config?e.config.apply(null,~t.indexOf("{")?[_v(r[1])]:Zv(t).split(",").map(fn)):qa._CE&&bw.test(t)?qa._CE("",t):e},Mn=function(t){return function(r){return 1-t(1-r)}},Nn=function t(r,e){for(var $,a=r._first;a;)a instanceof db?t(a,e):!a.vars.yoyoEase||a._yoyo&&a._repeat||a._yoyo===e||(a.timeline?t(a.timeline,e):($=a._ease,a._ease=a._yEase,a._yEase=$,a._yoyo=e)),a=a._next},je=function(t,r){return t&&(Ja(t)?t:qa[t]||Yv(t))||r},kd=function(t,r,e,$){void 0===e&&(e=function(t){return 1-r(1-t)}),void 0===$&&($=function(t){return t<.5?r(2*t)/2:1-r(2*(1-t))/2});var a,i={easeIn:r,easeOut:e,easeInOut:$};return fb(t,function(t){for(var r in qa[t]=jb[t]=i,qa[a=t.toLowerCase()]=e,i)qa[a+("easeIn"===r?".in":"easeOut"===r?".out":".inOut")]=qa[t+"."+r]=i[r]}),i},Pn=function(t){return function(r){return r<.5?(1-t(1-2*r))/2:.5+t(2*(r-.5))/2}},Fj=function t(r,e,$){var a=e>=1?e:1,i=($||(r?.3:.45))/(e<1?e:1),n=i/pk*(Math.asin(1/a)||0),o=function(t){return 1===t?1:a*Math.pow(2,-10*t)*Xx((t-n)*i)+1},s="out"===r?o:"in"===r?function(t){return 1-o(1-t)}:Pn(o);return i=pk/i,s.config=function(e,$){return t(r,e,$)},s},Ij=function t(r,e){void 0===e&&(e=1.70158);var $=function(t){return t?--t*t*((e+1)*t+e)+1:0},a="out"===r?$:"in"===r?function(t){return 1-$(1-t)}:Pn($);return a.config=function(e){return t(r,e)},a};fb("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,r){var e=r<5?r+1:r;kd(t+",Power"+(e-1),r?function(t){return Math.pow(t,e)}:function(t){return t},function(t){return 1-Math.pow(1-t,e)},function(t){return t<.5?Math.pow(2*t,e)/2:1-Math.pow(2*(1-t),e)/2})}),qa.Linear.easeNone=qa.none=qa.Linear.easeIn,kd("Elastic",Fj("in"),Fj("out"),Fj()),function(t,r){var e=1/r,$=function($){return $<e?t*$*$:$<.7272727272727273?t*Math.pow($-1.5/r,2)+.75:$<.9090909090909092?t*($-=2.25/r)*$+.9375:t*Math.pow($-2.625/r,2)+.984375};kd("Bounce",function(t){return 1-$(1-t)},$)}(7.5625,2.75),kd("Expo",function(t){return t?Math.pow(2,10*(t-1)):0}),kd("Circ",function(t){return-(gm(1-t*t)-1)}),kd("Sine",function(t){return 1===t?1:1-_x(t*jy)}),kd("Back",Ij("in"),Ij("out"),Ij()),qa.SteppedEase=qa.steps=jb.SteppedEase={config:function(t,r){void 0===t&&(t=1);var e=1/t,$=t+(r?0:1),a=r?1:0,i=1-ra;return function(t){return(($*Zf(0,i,t)|0)+a)*e}}},Ld.ease=qa["quad.out"],fb("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return Ym+=t+","+t+"Params,"});var Qn=function(t,r){this.id=hy++,t._gsap=this,this.target=t,this.harness=r,this.get=r?r.get:Zm,this.set=r?r.getSetter:kk};var jg=function(){function t(t,r){var e=t.parent||Ha;this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Qe(this,+t.duration,1,1),this.data=t.data,dm||ob.wake(),e&&bc(e,this,r||0===r?r:e._time,1),t.reversed&&this.reverse(),t.paused&&this.paused(!0)}var r=t.prototype;return r.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},r.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},r.totalDuration=function(t){return arguments.length?(this._dirty=0,Qe(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},r.totalTime=function(t,r){if(we(),!arguments.length)return this._tTime;var e=this._dp;if(e&&e.smoothChildTiming&&this._ts){for(ln(this,t);e.parent;)e.parent._time!==e._start+(e._ts>=0?e._tTime/e._ts:(e.totalDuration()-e._tTime)/-e._ts)&&e.totalTime(e._tTime,!0),e=e.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&bc(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===ra||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),dn(this,t,r)),this},r.time=function(t,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+kn(this))%this._dur||(t?this._dur:0),r):this._time},r.totalProgress=function(t,r){return arguments.length?this.totalTime(this.totalDuration()*t,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},r.progress=function(t,r){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+kn(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},r.iteration=function(t,r){var e=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*e,r):this._repeat?Ue(this._tTime,e)+1:1},r.timeScale=function(t){if(!arguments.length)return this._rts===-ra?0:this._rts;if(this._rts===t)return this;var r=this.parent&&this._ts?og(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||t===-ra?0:this._rts,Sw(this.totalTime(Zf(-this._delay,this._tDur,r),!0))},r.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(we(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=ra)&&Math.abs(this._zTime)!==ra))),this):this._ps},r.startTime=function(t){if(arguments.length){this._start=t;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&bc(r,this,t-this._delay),this}return this._start},r.endTime=function(t){return this._start+(ab(t)?this.totalDuration():this.duration())/Math.abs(this._ts)},r.rawTime=function(t){var r=this.parent||this._dp;return r?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?og(r.rawTime(t),this):this._tTime:this._tTime},r.globalTime=function(t){for(var r=this,e=arguments.length?t:r.rawTime();r;)e=r._start+e/(r._ts||1),r=r._dp;return e},r.repeat=function(t){return arguments.length?(this._repeat=t,sn(this)):this._repeat},r.repeatDelay=function(t){return arguments.length?(this._rDelay=t,sn(this)):this._rDelay},r.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},r.seek=function(t,r){return this.totalTime(Ya(this,t),ab(r))},r.restart=function(t,r){return this.play().totalTime(t?-this._delay:0,ab(r))},r.play=function(t,r){return null!=t&&this.seek(t,r),this.reversed(!1).paused(!1)},r.reverse=function(t,r){return null!=t&&this.seek(t||this.totalDuration(),r),this.reversed(!0).paused(!1)},r.pause=function(t,r){return null!=t&&this.seek(t,r),this.paused(!0)},r.resume=function(){return this.paused(!1)},r.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-ra:0)),this):this._rts<0},r.invalidate=function(){return this._initted=0,this._zTime=-ra,this},r.isActive=function(){var t,r=this.parent||this._dp,e=this._start;return!(r&&!(this._ts&&this._initted&&r.isActive()&&(t=r.rawTime(!0))>=e&&t<this.endTime(!0)-ra))},r.eventCallback=function(t,r,e){var $=this.vars;return arguments.length>1?(r?($[t]=r,e&&($[t+"Params"]=e),"onUpdate"===t&&(this._onUpdate=r)):delete $[t],this):$[t]},r.then=function(t){var r=this;return new Promise(function(e){var $=Ja(t)?t:gn,a=function(){var t=r.then;r.then=null,Ja($)&&($=$(r))&&($.then||$===r)&&(r.then=t),e($),r.then=t};r._initted&&1===r.totalProgress()&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},r.kill=function(){Qf(this)},t}();wb(jg.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-ra,_prom:0,_ps:!1,_rts:1});var db=function(t){function r(r,e){var $;return void 0===r&&(r={}),($=t.call(this,r,e)||this).labels={},$.smoothChildTiming=!!r.smoothChildTiming,$.autoRemoveChildren=!!r.autoRemoveChildren,$._sort=ab(r.sortChildren),$.parent&&Mj($.parent,dc($)),r.scrollTrigger&&mn(dc($),r.scrollTrigger),$}Xl(r,t);var e=r.prototype;return e.to=function(t,r,e){return new Fa(t,Uf(arguments,0,this),Ya(this,Eb(r)?arguments[3]:e)),this},e.from=function(t,r,e){return new Fa(t,Uf(arguments,1,this),Ya(this,Eb(r)?arguments[3]:e)),this},e.fromTo=function(t,r,e,$){return new Fa(t,Uf(arguments,2,this),Ya(this,Eb(r)?arguments[4]:$)),this},e.set=function(t,r,e){return r.duration=0,r.parent=this,sg(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new Fa(t,r,Ya(this,e),1),this},e.call=function(t,r,e){return bc(this,Fa.delayedCall(0,t,r),Ya(this,e))},e.staggerTo=function(t,r,e,$,a,i,n){return e.duration=r,e.stagger=e.stagger||$,e.onComplete=i,e.onCompleteParams=n,e.parent=this,new Fa(t,e,Ya(this,a)),this},e.staggerFrom=function(t,r,e,$,a,i,n){return e.runBackwards=1,sg(e).immediateRender=ab(e.immediateRender),this.staggerTo(t,r,e,$,a,i,n)},e.staggerFromTo=function(t,r,e,$,a,i,n,o){return $.startAt=e,sg($).immediateRender=ab($.immediateRender),this.staggerTo(t,r,$,a,i,n,o)},e.render=function(t,r,e){var $,a,i,n,o,s,_,p,u,O,U,l,K=this._time,v=this._dirty?this.totalDuration():this._tDur,h=this._dur,c=this!==Ha&&t>v-ra&&t>=0?v:t<ra?0:t,f=this._zTime<0!=t<0&&(this._initted||!h);if(c!==this._tTime||e||f){if(K!==this._time&&h&&(c+=this._time-K,t+=this._time-K),$=c,u=this._start,s=!(p=this._ts),f&&(h||(K=this._zTime),(t||!r)&&(this._zTime=t)),this._repeat&&(U=this._yoyo,o=h+this._rDelay,$=pa(c%o),c===v?(n=this._repeat,$=h):((n=~~(c/o))&&n===c/o&&($=h,n--),$>h&&($=h)),O=Ue(this._tTime,o),!K&&this._tTime&&O!==n&&(O=n),U&&1&n&&($=h-$,l=1),n!==O&&!this._lock)){var d=U&&1&O,m=d===(U&&1&n);if(n<O&&(d=!d),K=d?0:h,this._lock=1,this.render(K||(l?0:pa(n*o)),r,!h)._lock=0,!r&&this.parent&&mb(this,"onRepeat"),this.vars.repeatRefresh&&!l&&(this.invalidate()._lock=1),K!==this._time||s!==!this._ts)return this;if(h=this._dur,v=this._tDur,m&&(this._lock=2,K=d?h:-1e-4,this.render(K,!0),this.vars.repeatRefresh&&!l&&this.invalidate()),this._lock=0,!this._ts&&!s)return this;Nn(this,l)}if(this._hasPause&&!this._forcing&&this._lock<2&&(_=Lw(this,pa(K),pa($)))&&(c-=$-($=_._start)),this._tTime=c,this._time=$,this._act=!p,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t),!K&&$&&!r&&mb(this,"onStart"),$>=K&&t>=0)for(a=this._first;a;){if(i=a._next,(a._act||$>=a._start)&&a._ts&&_!==a){if(a.parent!==this)return this.render(t,r,e);if(a.render(a._ts>0?($-a._start)*a._ts:(a._dirty?a.totalDuration():a._tDur)+($-a._start)*a._ts,r,e),$!==this._time||!this._ts&&!s){_=0,i&&(c+=this._zTime=-ra);break}}a=i}else{a=this._last;for(var g=t<0?t:$;a;){if(i=a._prev,(a._act||g<=a._end)&&a._ts&&_!==a){if(a.parent!==this)return this.render(t,r,e);if(a.render(a._ts>0?(g-a._start)*a._ts:(a._dirty?a.totalDuration():a._tDur)+(g-a._start)*a._ts,r,e),$!==this._time||!this._ts&&!s){_=0,i&&(c+=this._zTime=g?-ra:ra);break}}a=i}}if(_&&!r&&(this.pause(),_.render($>=K?0:-ra)._zTime=$>=K?1:-1,this._ts))return this._start=u,vj(this),this.render(t,r,e);this._onUpdate&&!r&&mb(this,"onUpdate",!0),(c===v&&v>=this.totalDuration()||!c&&K)&&(u!==this._start&&Math.abs(p)===Math.abs(this._ts)||this._lock||((t||!h)&&(c===v&&this._ts>0||!c&&this._ts<0)&&Ec(this,1),r||t<0&&!K||!c&&!K||(mb(this,c===v?"onComplete":"onReverseComplete",!0),this._prom&&!(c<v&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(t,r){var e=this;if(Eb(r)||(r=Ya(this,r)),!(t instanceof jg)){if(pb(t))return t.forEach(function(t){return e.add(t,r)}),this;if(Ta(t))return this.addLabel(t,r);if(!Ja(t))return this;t=Fa.delayedCall(0,t)}return this!==t?bc(this,t,r):this},e.getChildren=function(t,r,e,$){void 0===t&&(t=!0),void 0===r&&(r=!0),void 0===e&&(e=!0),void 0===$&&($=-Lb);for(var a=[],i=this._first;i;)i._start>=$&&(i instanceof Fa?r&&a.push(i):(e&&a.push(i),t&&a.push.apply(a,i.getChildren(!0,r,e)))),i=i._next;return a},e.getById=function(t){for(var r=this.getChildren(1,1,1),e=r.length;e--;)if(r[e].vars.id===t)return r[e]},e.remove=function(t){return Ta(t)?this.removeLabel(t):Ja(t)?this.killTweensOf(t):(pg(this,t),t===this._recent&&(this._recent=this._last),rd(this))},e.totalTime=function(r,e){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=pa(ob.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),t.prototype.totalTime.call(this,r,e),this._forcing=0,this):this._tTime},e.addLabel=function(t,r){return this.labels[t]=Ya(this,r),this},e.removeLabel=function(t){return delete this.labels[t],this},e.addPause=function(t,r,e){var $=Fa.delayedCall(0,r||If,e);return $.data="isPause",this._hasPause=1,bc(this,$,Ya(this,t))},e.removePause=function(t){var r=this._first;for(t=Ya(this,t);r;)r._start===t&&"isPause"===r.data&&Ec(r),r=r._next},e.killTweensOf=function(t,r,e){for(var $=this.getTweensOf(t,e),a=$.length;a--;)fh!==$[a]&&$[a].kill(t,r);return this},e.getTweensOf=function(t,r){for(var e,$=[],a=Rb(t),i=this._first,n=Eb(r);i;)i instanceof Fa?$w(i._targets,a)&&(n?(!fh||i._initted&&i._ts)&&i.globalTime(0)<=r&&i.globalTime(i.totalDuration())>r:!r||i.isActive())&&$.push(i):(e=i.getTweensOf(a,r)).length&&$.push.apply($,e),i=i._next;return $},e.tweenTo=function(t,r){r=r||{};var e=this,$=Ya(e,t),a=r,i=a.startAt,n=a.onStart,o=a.onStartParams,s=Fa.to(e,wb(r,{ease:"none",lazy:!1,time:$,overwrite:"auto",duration:r.duration||Math.abs(($-(i&&"time"in i?i.time:e._time))/e.timeScale())||ra,onStart:function(){e.pause();var t=r.duration||Math.abs(($-e._time)/e.timeScale());s._dur!==t&&Qe(s,t,0,1).render(s._time,!0,!0),n&&n.apply(s,o||[])}}));return s},e.tweenFromTo=function(t,r,e){return this.tweenTo(r,wb({startAt:{time:Ya(this,t)}},e))},e.recent=function(){return this._recent},e.nextLabel=function(t){return void 0===t&&(t=this._time),Dn(this,Ya(this,t))},e.previousLabel=function(t){return void 0===t&&(t=this._time),Dn(this,Ya(this,t),1)},e.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+ra)},e.shiftChildren=function(t,r,e){void 0===e&&(e=0);for(var $,a=this._first,i=this.labels;a;)a._start>=e&&(a._start+=t,a._end+=t),a=a._next;if(r)for($ in i)i[$]>=e&&(i[$]+=t);return rd(this)},e.invalidate=function(){var r=this._first;for(this._lock=0;r;)r.invalidate(),r=r._next;return t.prototype.invalidate.call(this)},e.clear=function(t){void 0===t&&(t=!0);for(var r,e=this._first;e;)r=e._next,this.remove(e),e=r;return this._time=this._tTime=this._pTime=0,t&&(this.labels={}),rd(this)},e.totalDuration=function(t){var r,e,$,a=0,i=this._last,n=Lb;if(arguments.length)return this.timeScale((this._repeat<0?this.duration():this.totalDuration())/(this.reversed()?-t:t));if(this._dirty){for($=this.parent;i;)r=i._prev,i._dirty&&i.totalDuration(),(e=i._start)>n&&this._sort&&i._ts&&!this._lock?(this._lock=1,bc(this,i,e-i._delay,1)._lock=0):n=e,e<0&&i._ts&&(a-=e,(!$&&!this._dp||$&&$.smoothChildTiming)&&(this._start+=e/this._ts,this._time-=e,this._tTime-=e),this.shiftChildren(-e,!1,-Infinity),n=0),i._end>a&&i._ts&&(a=i._end),i=r;Qe(this,this===Ha&&this._time>a?this._time:a,1,1),this._dirty=0}return this._tDur},r.updateRoot=function(t){if(Ha._ts&&(dn(Ha,og(t,Ha)),ly=ob.frame),ob.frame>=cx){cx+=sb.autoSleep||120;var r=Ha._first;if((!r||!r._ts)&&sb.autoSleep&&ob._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||ob.sleep()}}},r}(jg);wb(db.prototype,{_lock:0,_hasPause:0,_forcing:0});var fh,Rv=function(t,r,e,$,a,i,n){var o,s,_,p,u,O,U,l,K=new bb(this._pt,t,r,0,1,Wn,null,a),v=0,h=0;for(K.b=e,K.e=$,e+="",(U=~($+="").indexOf("random("))&&($=Dg($)),i&&(i(l=[e,$],t,r),e=l[0],$=l[1]),s=e.match(uj)||[];o=uj.exec($);)p=o[0],u=$.substring(v,o.index),_?_=(_+1)%5:"rgba("===u.substr(-5)&&(_=1),p!==s[h++]&&(O=parseFloat(s[h-1])||0,K._pt={_next:K._pt,p:u||1===h?u:",",s:O,c:"="===p.charAt(1)?parseFloat(p.substr(2))*("-"===p.charAt(0)?-1:1):parseFloat(p)-O,m:_&&_<4?Math.round:0},v=uj.lastIndex);return K.c=v<$.length?$.substring(v,$.length):"",K.fp=n,(Bm.test($)||U)&&(K.e=0),this._pt=K,K},Tj=function(t,r,e,$,a,i,n,o,s){Ja($)&&($=$(a||0,t,i));var _,p=t[r],u="get"!==e?e:Ja(p)?s?t[r.indexOf("set")||!Ja(t["get"+r.substr(3)])?r:"get"+r.substr(3)](s):t[r]():p,O=Ja(p)?s?Jv:Un:gk;if(Ta($)&&(~$.indexOf("random(")&&($=Dg($)),"="===$.charAt(1)&&($=parseFloat(u)+parseFloat($.substr(2))*("-"===$.charAt(0)?-1:1)+(Nb(u)||0))),u!==$)return isNaN(u*$)?(!p&&!(r in t)&&fk(r,$),Rv.call(this,t,r,u,$,O,o||sb.stringFilter,s)):(_=new bb(this._pt,t,r,+u||0,$-(u||0),"boolean"==typeof p?Fv:Vn,0,O),s&&(_.fp=s),n&&_.modifier(n,this,t),this._pt=_)},Qv=function(t,r,e,$,a){if(Ja(t)&&(t=pf(t,a,r,e,$)),!kc(t)||t.style&&t.nodeType||pb(t)||ym(t))return Ta(t)?pf(t,a,r,e,$):t;var i,n={};for(i in t)n[i]=pf(t[i],a,r,e,$);return n},Rn=function(t,r,e,$,a,i){var n,o,s,_;if(eb[t]&&!1!==(n=new eb[t]).init(a,n.rawVars?r[t]:Qv(r[t],$,a,i,e),e,$,i)&&(e._pt=o=new bb(e._pt,a,t,0,1,n.render,n,0,n.priority),e!==eg))for(s=e._ptLookup[e._targets.indexOf(a)],_=n._props.length;_--;)s[n._props[_]]=o;return n},Ov=function t(r,e){var $,a,i,n,o,s,_,p,u,O,U,l,K,v=r.vars,h=v.ease,c=v.startAt,f=v.immediateRender,d=v.lazy,m=v.onUpdate,g=v.onUpdateParams,x=v.callbackScope,T=v.runBackwards,y=v.yoyoEase,w=v.keyframes,b=v.autoRevert,P=r._dur,k=r._startAt,E=r._targets,S=r.parent,A=S&&"nested"===S.data?S.parent._targets:E,D="auto"===r._overwrite,C=r.timeline;if(C&&(!w||!h)&&(h="none"),r._ease=je(h,Ld.ease),r._yEase=y?Mn(je(!0===y?h:y,Ld.ease)):0,y&&r._yoyo&&!r._repeat&&(y=r._yEase,r._yEase=r._ease,r._ease=y),!C){if(l=(p=E[0]?pd(E[0]).harness:0)&&v[p.prop],$=Ri(v,ok),k&&k.render(-1,!0).kill(),c){if(Ec(r._startAt=Fa.set(E,wb({data:"isStart",overwrite:!1,parent:S,immediateRender:!0,lazy:ab(d),startAt:null,delay:0,onUpdate:m,onUpdateParams:g,callbackScope:x,stagger:0},c))),f)if(e>0)b||(r._startAt=0);else if(P&&!(e<0&&k))return void(e&&(r._zTime=e))}else if(T&&P)if(k)!b&&(r._startAt=0);else if(e&&(f=!1),i=wb({overwrite:!1,data:"isFromStart",lazy:f&&ab(d),immediateRender:f,stagger:0,parent:S},$),l&&(i[p.prop]=l),Ec(r._startAt=Fa.set(E,i)),f){if(!e)return}else t(r._startAt,ra);for(r._pt=0,d=P&&ab(d)||d&&!P,a=0;a<E.length;a++){if(_=(o=E[a])._gsap||Gk(E)[a]._gsap,r._ptLookup[a]=O={},Xm[_.id]&&zc.length&&wg(),U=A===E?a:A.indexOf(o),p&&!1!==(u=new p).init(o,l||$,r,U,A)&&(r._pt=n=new bb(r._pt,o,u.name,0,1,u.render,u,0,u.priority),u._props.forEach(function(t){O[t]=n}),u.priority&&(s=1)),!p||l)for(i in $)eb[i]&&(u=Rn(i,$,r,U,o,A))?u.priority&&(s=1):O[i]=n=Tj.call(r,o,i,"get",$[i],U,A,0,v.stringFilter);r._op&&r._op[a]&&r.kill(o,r._op[a]),D&&r._pt&&(fh=r,Ha.killTweensOf(o,O,r.globalTime(0)),K=!r.parent,fh=0),r._pt&&d&&(Xm[_.id]=1)}s&&Xn(r),r._onInit&&r._onInit(r)}r._from=!C&&!!v.runBackwards,r._onUpdate=m,r._initted=(!r._op||r._pt)&&!K},Nv=function(t,r){var e,$,a,i,n=t[0]?pd(t[0]).harness:0,o=n&&n.aliases;if(!o)return r;for($ in e=Oe({},r),o)if($ in e)for(a=(i=o[$].split(",")).length;a--;)e[i[a]]=e[$];return e},pf=function(t,r,e,$,a){return Ja(t)?t.call(r,e,$,a):Ta(t)&&~t.indexOf("random(")?Dg(t):t},Tn=Ym+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",Lv=(Tn+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Fa=function(t){function r(r,e,$,a){var i;"number"==typeof e&&($.duration=e,e=$,$=null);var n,o,s,_,p,u,O,U,l=(i=t.call(this,a?e:sg(e),$)||this).vars,K=l.duration,v=l.delay,h=l.immediateRender,c=l.stagger,f=l.overwrite,d=l.keyframes,m=l.defaults,g=l.scrollTrigger,x=l.yoyoEase,T=i.parent,y=(pb(r)||ym(r)?Eb(r[0]):"length"in e)?[r]:Rb(r);if(i._targets=y.length?Gk(y):Jm("GSAP target "+r+" not found. https://greensock.com",!sb.nullTargetWarn)||[],i._ptLookup=[],i._overwrite=f,d||c||wm(K)||wm(v)){if(e=i.vars,(n=i.timeline=new db({data:"nested",defaults:m||{}})).kill(),n.parent=dc(i),d)wb(n.vars.defaults,{ease:"none"}),d.forEach(function(t){return n.to(y,t,">")});else{if(_=y.length,O=c?vn(c):If,kc(c))for(p in c)~Tn.indexOf(p)&&(U||(U={}),U[p]=c[p]);for(o=0;o<_;o++){for(p in s={},e)Lv.indexOf(p)<0&&(s[p]=e[p]);s.stagger=0,x&&(s.yoyoEase=x),U&&Oe(s,U),u=y[o],s.duration=+pf(K,dc(i),o,u,y),s.delay=(+pf(v,dc(i),o,u,y)||0)-i._delay,!c&&1===_&&s.delay&&(i._delay=v=s.delay,i._start+=v,s.delay=0),n.to(u,s,O(o,u,y))}n.duration()?K=v=0:i.timeline=0}K||i.duration(K=n.duration())}else i.timeline=0;return!0===f&&(fh=dc(i),Ha.killTweensOf(y),fh=0),T&&Mj(T,dc(i)),(h||!K&&!d&&i._start===pa(T._time)&&ab(h)&&Rw(dc(i))&&"nested"!==T.data)&&(i._tTime=-ra,i.render(Math.max(0,-v))),g&&mn(dc(i),g),i}Xl(r,t);var e=r.prototype;return e.render=function(t,r,e){var $,a,i,n,o,s,_,p,u,O=this._time,U=this._tDur,l=this._dur,K=t>U-ra&&t>=0?U:t<ra?0:t;if(l){if(K!==this._tTime||!t||e||this._startAt&&this._zTime<0!=t<0){if($=K,p=this.timeline,this._repeat){if(n=l+this._rDelay,$=pa(K%n),K===U?(i=this._repeat,$=l):((i=~~(K/n))&&i===K/n&&($=l,i--),$>l&&($=l)),(s=this._yoyo&&1&i)&&(u=this._yEase,$=l-$),o=Ue(this._tTime,n),$===O&&!e&&this._initted)return this;i!==o&&(p&&this._yEase&&Nn(p,s),!this.vars.repeatRefresh||s||this._lock||(this._lock=e=1,this.render(pa(n*i),!0).invalidate()._lock=0))}if(!this._initted){if(pn(this,t<0?t:$,e,r))return this._tTime=0,this;if(l!==this._dur)return this.render(t,r,e)}for(this._tTime=K,this._time=$,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=_=(u||this._ease)($/l),this._from&&(this.ratio=_=1-_),$&&!O&&!r&&mb(this,"onStart"),a=this._pt;a;)a.r(_,a.d),a=a._next;p&&p.render(t<0?t:!$&&s?-ra:p._dur*_,r,e)||this._startAt&&(this._zTime=t),this._onUpdate&&!r&&(t<0&&this._startAt&&this._startAt.render(t,!0,e),mb(this,"onUpdate")),this._repeat&&i!==o&&this.vars.onRepeat&&!r&&this.parent&&mb(this,"onRepeat"),K!==this._tDur&&K||this._tTime!==K||(t<0&&this._startAt&&!this._onUpdate&&this._startAt.render(t,!0,!0),(t||!l)&&(K===this._tDur&&this._ts>0||!K&&this._ts<0)&&Ec(this,1),r||t<0&&!O||!K&&!O||(mb(this,K===U?"onComplete":"onReverseComplete",!0),this._prom&&!(K<U&&this.timeScale()>0)&&this._prom()))}}else Mw(this,t,r,e);return this},e.targets=function(){return this._targets},e.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._act=this._lazy=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),t.prototype.invalidate.call(this)},e.kill=function(t,r){if(void 0===r&&(r="all"),!(t||r&&"all"!==r)&&(this._lazy=0,this.parent))return Qf(this);if(this.timeline){var e=this.timeline.totalDuration();return this.timeline.killTweensOf(t,r,fh&&!0!==fh.vars.overwrite)._first||Qf(this),this.parent&&e!==this.timeline.totalDuration()&&Qe(this,this._dur*this.timeline._tDur/e,0,1),this}var $,a,i,n,o,s,_,p=this._targets,u=t?Rb(t):p,O=this._ptLookup,U=this._pt;if((!r||"all"===r)&&Uw(p,u))return"all"===r&&(this._pt=0),Qf(this);for($=this._op=this._op||[],"all"!==r&&(Ta(r)&&(o={},fb(r,function(t){return o[t]=1}),r=o),r=Nv(p,r)),_=p.length;_--;)if(~u.indexOf(p[_]))for(o in a=O[_],"all"===r?($[_]=r,n=a,i={}):(i=$[_]=$[_]||{},n=r),n)(s=a&&a[o])&&("kill"in s.d&&!0!==s.d.kill(o)||pg(this,s,"_pt"),delete a[o]),"all"!==i&&(i[o]=1);return this._initted&&!this._pt&&U&&Qf(this),this},r.to=function(t,e){return new r(t,e,arguments[2])},r.from=function(t,e){return new r(t,Uf(arguments,1))},r.delayedCall=function(t,e,$,a){return new r(e,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:e,onReverseComplete:e,onCompleteParams:$,onReverseCompleteParams:$,callbackScope:a})},r.fromTo=function(t,e,$){return new r(t,Uf(arguments,2))},r.set=function(t,e){return e.duration=0,e.repeatDelay||(e.repeat=0),new r(t,e)},r.killTweensOf=function(t,r,e){return Ha.killTweensOf(t,r,e)},r}(jg);wb(Fa.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),fb("staggerTo,staggerFrom,staggerFromTo",function(t){Fa[t]=function(){var r=new db,e=sk.call(arguments,0);return e.splice("staggerFromTo"===t?5:4,0,0),r[t].apply(r,e)}});var gk=function(t,r,e){return t[r]=e},Un=function(t,r,e){return t[r](e)},Jv=function(t,r,e,$){return t[r]($.fp,e)},Iv=function(t,r,e){return t.setAttribute(r,e)},kk=function(t,r){return Ja(t[r])?Un:Ci(t[r])&&t.setAttribute?Iv:gk},Vn=function(t,r){return r.set(r.t,r.p,Math.round(1e4*(r.s+r.c*t))/1e4,r)},Fv=function(t,r){return r.set(r.t,r.p,!!(r.s+r.c*t),r)},Wn=function(t,r){var e=r._pt,$="";if(!t&&r.b)$=r.b;else if(1===t&&r.e)$=r.e;else{for(;e;)$=e.p+(e.m?e.m(e.s+e.c*t):Math.round(1e4*(e.s+e.c*t))/1e4)+$,e=e._next;$+=r.c}r.set(r.t,r.p,$,r)},qk=function(t,r){for(var e=r._pt;e;)e.r(t,e.d),e=e._next},Dv=function(t,r,e,$){for(var a,i=this._pt;i;)a=i._next,i.p===$&&i.modifier(t,r,e),i=a},Cv=function(t){for(var r,e,$=this._pt;$;)e=$._next,$.p===t&&!$.op||$.op===t?pg(this,$,"_pt"):$.dep||(r=1),$=e;return!r},Bv=function(t,r,e,$){$.mSet(t,r,$.m.call($.tween,e,$.mt),$)},Xn=function(t){for(var r,e,$,a,i=t._pt;i;){for(r=i._next,e=$;e&&e.pr>i.pr;)e=e._next;(i._prev=e?e._prev:a)?i._prev._next=i:$=i,(i._next=e)?e._prev=i:a=i,i=r}t._pt=$},bb=function(){function t(t,r,e,$,a,i,n,o,s){this.t=r,this.s=$,this.c=a,this.p=e,this.r=i||Vn,this.d=n||this,this.set=o||gk,this.pr=s||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,r,e){this.mSet=this.mSet||this.set,this.set=Bv,this.m=t,this.mt=e,this.tween=r},t}();fb(Ym+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return ok[t]=1}),jb.TweenMax=jb.TweenLite=Fa,jb.TimelineLite=jb.TimelineMax=db,Ha=new db({sortChildren:!1,defaults:Ld,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),sb.stringFilter=Hn;var Uh={registerPlugin:function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];r.forEach(function(t){return kw(t)})},timeline:function(t){return new db(t)},getTweensOf:function(t,r){return Ha.getTweensOf(t,r)},getProperty:function(t,r,e,$){Ta(t)&&(t=Rb(t)[0]);var a=pd(t||{}).get,i=e?gn:fn;return"native"===e&&(e=""),t?r?i((eb[r]&&eb[r].get||a)(t,r,e,$)):function(r,e,$){return i((eb[r]&&eb[r].get||a)(t,r,e,$))}:t},quickSetter:function(t,r,e){if((t=Rb(t)).length>1){var $=t.map(function(t){return $b.quickSetter(t,r,e)}),a=$.length;return function(t){for(var r=a;r--;)$[r](t)}}t=t[0]||{};var i=eb[r],n=pd(t),o=n.harness&&(n.harness.aliases||{})[r]||r,s=i?function(r){var $=new i;eg._pt=0,$.init(t,e?r+e:r,eg,0,[t]),$.render(1,$),eg._pt&&qk(1,eg)}:n.set(t,o);return i?s:function(r){return s(t,o,e?r+e:r,n,1)}},isTweening:function(t){return Ha.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=je(t.ease,Ld.ease)),jn(Ld,t||{})},config:function(t){return jn(sb,t||{})},registerEffect:function(t){var r=t.name,e=t.effect,$=t.plugins,a=t.defaults,i=t.extendTimeline;($||"").split(",").forEach(function(t){return t&&!eb[t]&&!jb[t]&&Jm(r+" effect requires "+t+" plugin.")}),wk[r]=function(t,r,$){return e(Rb(t),wb(r||{},a),$)},i&&(db.prototype[r]=function(t,e,$){return this.add(wk[r](t,kc(e)?e:($=e)&&{},this),$)})},registerEase:function(t,r){qa[t]=je(r)},parseEase:function(t,r){return arguments.length?je(t,r):qa},getById:function(t){return Ha.getById(t)},exportRoot:function(t,r){void 0===t&&(t={});var e,$,a=new db(t);for(a.smoothChildTiming=ab(t.smoothChildTiming),Ha.remove(a),a._dp=0,a._time=a._tTime=Ha._time,e=Ha._first;e;)$=e._next,!r&&!e._dur&&e instanceof Fa&&e.vars.onComplete===e._targets[0]||bc(a,e,e._start-e._delay),e=$;return bc(Ha,a,0),a},utils:{wrap:pw,wrapYoyo:ow,distribute:vn,random:yn,snap:xn,normalize:vw,getUnit:Nb,clamp:Iw,splitColor:En,toArray:Rb,mapRange:Cn,pipe:Bw,unitize:Aw,interpolate:mw,shuffle:un},install:Em,effects:wk,ticker:ob,updateRoot:db.updateRoot,plugins:eb,globalTimeline:Ha,core:{PropTween:bb,globals:Wm,Tween:Fa,Timeline:db,Animation:jg,getCache:pd,_removeLinkedListItem:pg}};fb("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return Uh[t]=Fa[t]}),ob.add(db.updateRoot),eg=Uh.to({},{duration:0});var zv=function(t,r){for(var e=t._pt;e&&e.p!==r&&e.op!==r&&e.fp!==r;)e=e._next;return e},yv=function(t,r){var e,$,a,i=t._targets;for(e in r)for($=i.length;$--;)(a=t._ptLookup[$][e])&&(a=a.d)&&(a._pt&&(a=zv(a,e)),a&&a.modifier&&a.modifier(r[e],t,i[$],e))},Dk=function(t,r){return{name:t,rawVars:1,init:function(t,e,$){$._onInit=function(t){var $,a;if(Ta(e)&&($={},fb(e,function(t){return $[t]=1}),e=$),r){for(a in $={},e)$[a]=r(e[a]);e=$}yv(t,e)}}}},$b=Uh.registerPlugin({name:"attr",init:function(t,r,e,$,a){var i,n;for(i in r)(n=this.add(t,"setAttribute",(t.getAttribute(i)||0)+"",r[i],$,a,0,0,i))&&(n.op=i),this._props.push(i)}},{name:"endArray",init:function(t,r){for(var e=r.length;e--;)this.add(t,e,t[e]||0,r[e])}},Dk("roundProps",Ck),Dk("modifiers"),Dk("snap",xn))||Uh;Fa.version=db.version=$b.version="3.5.1",my=1,pm()&&we();var b=qa.Power0,c=qa.Power1,d=qa.Power2,e=qa.Power3,f=qa.Power4,g=qa.Linear,h=qa.Quad,i=qa.Cubic,j=qa.Quart,k=qa.Quint,x=qa.Strong,m=qa.Elastic,n=qa.Back,o=qa.SteppedEase,p=qa.Bounce,q=qa.Sine,r=qa.Expo,s=qa.Circ;var ev,pc,gg,$n,Hd,Sh,av,Zu,Xu=function(){return"undefined"!=typeof window},Kc={},Yc=180/Math.PI,Xd=Math.PI/180,Yd=Math.atan2,bo=1e8,fo=/([A-Z])/g,Qu=/(?:left|right|width|margin|padding|x)/i,Pu=/[\s,\(]\S/,Jc={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ho=function(r,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*r))/1e4+t.u,t)},Mu=function(r,t){return t.set(t.t,t.p,1===r?t.e:Math.round(1e4*(t.s+t.c*r))/1e4+t.u,t)},Ku=function(r,t){return t.set(t.t,t.p,r?Math.round(1e4*(t.s+t.c*r))/1e4+t.u:t.b,t)},Iu=function(r,t){var $=t.s+t.c*r;t.set(t.t,t.p,~~($+($<0?-.5:.5))+t.u,t)},io=function(r,t){return t.set(t.t,t.p,r?t.e:t.b,t)},ko=function(r,t){return t.set(t.t,t.p,1!==r?t.b:t.e,t)},su=function(r,t,$){return r.style[t]=$},ru=function(r,t,$){return r.style.setProperty(t,$)},qu=function(r,t,$){return r._gsap[t]=$},pu=function(r,t,$){return r._gsap.scaleX=r._gsap.scaleY=$},ou=function(r,t,$,e,a){var n=r._gsap;n.scaleX=n.scaleY=$,n.renderTransform(a,n)},nu=function(r,t,$,e,a){var n=r._gsap;n[t]=$,n.renderTransform(a,n)},qb="transform",$c=qb+"Origin",Zj=function(r,t){var $=pc.createElementNS?pc.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),r):pc.createElement(r);return $.style?$:pc.createElement(r)},hc=function r(t,$,e){var a=getComputedStyle(t);return a[$]||a.getPropertyValue($.replace(fo,"-$1").toLowerCase())||a.getPropertyValue($)||!e&&r(t,xd($)||$,1)||""},no="O,Moz,ms,Ms,Webkit".split(","),xd=function(r,t,$){var e=(t||Hd).style,a=5;if(r in e&&!$)return r;for(r=r.charAt(0).toUpperCase()+r.substr(1);a--&&!(no[a]+r in e););return a<0?null:(3===a?"ms":a>=0?no[a]:"")+r},bk=function(){Xu()&&window.document&&(ev=window,pc=ev.document,gg=pc.documentElement,Hd=Zj("div")||{style:{}},Sh=Zj("div"),qb=xd(qb),$c=qb+"Origin",Hd.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Zu=!!xd("perspective"),$n=1)},ek=function r(t){var $,e=Zj("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),a=this.parentNode,n=this.nextSibling,o=this.style.cssText;if(gg.appendChild(e),e.appendChild(this),this.style.display="block",t)try{$=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=r}catch(i){}else this._gsapBBox&&($=this._gsapBBox());return a&&(n?a.insertBefore(this,n):a.appendChild(this)),gg.removeChild(e),this.style.cssText=o,$},oo=function(r,t){for(var $=t.length;$--;)if(r.hasAttribute(t[$]))return r.getAttribute(t[$])},po=function(r){var t;try{t=r.getBBox()}catch($){t=ek.call(r,!0)}return t&&(t.width||t.height)||r.getBBox===ek||(t=ek.call(r,!0)),!t||t.width||t.x||t.y?t:{x:+oo(r,["x","cx","x1"])||0,y:+oo(r,["y","cy","y1"])||0,width:0,height:0}},qo=function(r){return!(!r.getCTM||r.parentNode&&!r.ownerSVGElement||!po(r))},Ah=function(r,t){if(t){var $=r.style;t in Kc&&t!==$c&&(t=qb),$.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),$.removeProperty(t.replace(fo,"-$1").toLowerCase())):$.removeAttribute(t)}},Oc=function(r,t,$,e,a,n){var o=new bb(r._pt,t,$,0,1,n?ko:io);return r._pt=o,o.b=e,o.e=a,r._props.push($),o},ro={deg:1,rad:1,turn:1},_c=function r(t,$,e,a){var n,o,i,l,s=parseFloat(e)||0,p=(e+"").trim().substr((s+"").length)||"px",A=Hd.style,_=Qu.test($),v="svg"===t.tagName.toLowerCase(),I=(v?"client":"offset")+(_?"Width":"Height"),Q="px"===a,d="%"===a;return a===p||!s||ro[a]||ro[p]?s:("px"!==p&&!Q&&(s=r(t,$,e,"px")),l=t.getCTM&&qo(t),d&&(Kc[$]||~$.indexOf("adius"))?pa(s/(l?t.getBBox()[_?"width":"height"]:t[I])*100):(A[_?"width":"height"]=100+(Q?p:a),o=~$.indexOf("adius")||"em"===a&&t.appendChild&&!v?t:t.parentNode,l&&(o=(t.ownerSVGElement||{}).parentNode),o&&o!==pc&&o.appendChild||(o=pc.body),(i=o._gsap)&&d&&i.width&&_&&i.time===ob.time?pa(s/i.width*100):((d||"%"===p)&&(A.position=hc(t,"position")),o===t&&(A.position="static"),o.appendChild(Hd),n=Hd[I],o.removeChild(Hd),A.position="absolute",_&&d&&((i=pd(o)).time=ob.time,i.width=o[I]),pa(Q?n*s/100:n&&s?100/n*s:0))))},kf=function(r,t,$,e){var a;return $n||bk(),t in Jc&&"transform"!==t&&~(t=Jc[t]).indexOf(",")&&(t=t.split(",")[0]),Kc[t]&&"transform"!==t?(a=sh(r,e),a="transformOrigin"!==t?a[t]:rh(hc(r,$c))+" "+a.zOrigin+"px"):(!(a=r.style[t])||"auto"===a||e||~(a+"").indexOf("calc("))&&(a=wh[t]&&wh[t](r,t,$)||hc(r,t)||Zm(r,t)||("opacity"===t?1:0)),$&&!~(a+"").indexOf(" ")?_c(r,t,a,$)+$:a},hu=function(r,t,$,e){if(!$||"none"===$){var a=xd(t,r,1),n=a&&hc(r,a,1);n&&n!==$?(t=a,$=n):"borderColor"===t&&($=hc(r,"borderTopColor"))}var o,i,l,s,p,A,_,v,I,Q,d,c,m=new bb(this._pt,r.style,t,0,1,Wn),f=0,g=0;if(m.b=$,m.e=e,$+="","auto"===(e+="")&&(r.style[t]=e,e=hc(r,t)||e,r.style[t]=$),o=[$,e],Hn(o),e=o[1],l=($=o[0]).match(Qd)||[],(e.match(Qd)||[]).length){for(;i=Qd.exec(e);)_=i[0],I=e.substring(f,i.index),p?p=(p+1)%5:"rgba("!==I.substr(-5)&&"hsla("!==I.substr(-5)||(p=1),_!==(A=l[g++]||"")&&(s=parseFloat(A)||0,d=A.substr((s+"").length),(c="="===_.charAt(1)?+(_.charAt(0)+"1"):0)&&(_=_.substr(2)),v=parseFloat(_),Q=_.substr((v+"").length),f=Qd.lastIndex-Q.length,Q||(Q=Q||sb.units[t]||d,f===e.length&&(e+=Q,m.e+=Q)),d!==Q&&(s=_c(r,t,A,Q)||0),m._pt={_next:m._pt,p:I||1===g?I:",",s:s,c:c?c*v:v-s,m:p&&p<4?Math.round:0});m.c=f<e.length?e.substring(f,e.length):""}else m.r="display"===t&&"none"===e?ko:io;return Bm.test(e)&&(m.e=0),this._pt=m,m},so={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},fu=function(r){var t=r.split(" "),$=t[0],e=t[1]||"50%";return"top"!==$&&"bottom"!==$&&"left"!==e&&"right"!==e||(r=$,$=e,e=r),t[0]=so[$]||$,t[1]=so[e]||e,t.join(" ")},eu=function(r,t){if(t.tween&&t.tween._time===t.tween._dur){var $,e,a,n=t.t,o=n.style,i=t.u,l=n._gsap;if("all"===i||!0===i)o.cssText="",e=1;else for(a=(i=i.split(",")).length;--a>-1;)$=i[a],Kc[$]&&(e=1,$="transformOrigin"===$?$c:qb),Ah(n,$);e&&(Ah(n,qb),l&&(l.svg&&n.removeAttribute("transform"),sh(n,1),l.uncache=1))}},wh={clearProps:function(r,t,$,e,a){if("isFromStart"!==a.data){var n=r._pt=new bb(r._pt,t,$,0,0,eu);return n.u=e,n.pr=-10,n.tween=a,r._props.push($),1}}},sf=[1,0,0,1,0,0],to={},uo=function(r){return"matrix(1, 0, 0, 1, 0, 0)"===r||"none"===r||!r},vo=function(r){var t=hc(r,qb);return uo(t)?sf:t.substr(7).match(zm).map(pa)},Ak=function(r,t){var $,e,a,n,o=r._gsap||pd(r),i=r.style,l=vo(r);return o.svg&&r.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(a=r.transform.baseVal.consolidate().matrix).a,a.b,a.c,a.d,a.e,a.f]).join(",")?sf:l:(l!==sf||r.offsetParent||r===gg||o.svg||(a=i.display,i.display="block",($=r.parentNode)&&r.offsetParent||(n=1,e=r.nextSibling,gg.appendChild(r)),l=vo(r),a?i.display=a:Ah(r,"display"),n&&(e?$.insertBefore(r,e):$?$.appendChild(r):gg.removeChild(r))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Bk=function(r,t,$,e,a,n){var o,i,l,s=r._gsap,p=a||Ak(r,!0),A=s.xOrigin||0,_=s.yOrigin||0,v=s.xOffset||0,I=s.yOffset||0,Q=p[0],d=p[1],c=p[2],m=p[3],f=p[4],g=p[5],u=t.split(" "),h=parseFloat(u[0])||0,x=parseFloat(u[1])||0;$?p!==sf&&(i=Q*m-d*c)&&(l=h*(-d/i)+x*(Q/i)-(Q*g-d*f)/i,h=h*(m/i)+x*(-c/i)+(c*g-m*f)/i,x=l):(h=(o=po(r)).x+(~u[0].indexOf("%")?h/100*o.width:h),x=o.y+(~(u[1]||u[0]).indexOf("%")?x/100*o.height:x)),e||!1!==e&&s.smooth?(f=h-A,g=x-_,s.xOffset=v+(f*Q+g*c)-f,s.yOffset=I+(f*d+g*m)-g):s.xOffset=s.yOffset=0,s.xOrigin=h,s.yOrigin=x,s.smooth=!!e,s.origin=t,s.originIsAbsolute=!!$,r.style[$c]="0px 0px",n&&(Oc(n,s,"xOrigin",A,h),Oc(n,s,"yOrigin",_,x),Oc(n,s,"xOffset",v,s.xOffset),Oc(n,s,"yOffset",I,s.yOffset)),r.setAttribute("data-svg-origin",h+" "+x)},sh=function(r,t){var $=r._gsap||new Qn(r);if("x"in $&&!t&&!$.uncache)return $;var e,a,n,o,i,l,s,p,A,_,v,I,Q,d,c,m,f,g,u,h,x,P,y,w,T,S,O,b,C,D,E,M,B=r.style,k=$.scaleX<0,N=hc(r,$c)||"0";return e=a=n=l=s=p=A=_=v=0,o=i=1,$.svg=!(!r.getCTM||!qo(r)),d=Ak(r,$.svg),$.svg&&(w=!$.uncache&&r.getAttribute("data-svg-origin"),Bk(r,w||N,!!w||$.originIsAbsolute,!1!==$.smooth,d)),I=$.xOrigin||0,Q=$.yOrigin||0,d!==sf&&(g=d[0],u=d[1],h=d[2],x=d[3],e=P=d[4],a=y=d[5],6===d.length?(o=Math.sqrt(g*g+u*u),i=Math.sqrt(x*x+h*h),l=g||u?Yd(u,g)*Yc:0,(A=h||x?Yd(h,x)*Yc+l:0)&&(i*=Math.cos(A*Xd)),$.svg&&(e-=I-(I*g+Q*h),a-=Q-(I*u+Q*x))):(M=d[6],D=d[7],O=d[8],b=d[9],C=d[10],E=d[11],e=d[12],a=d[13],n=d[14],s=(c=Yd(M,C))*Yc,c&&(w=P*(m=Math.cos(-c))+O*(f=Math.sin(-c)),T=y*m+b*f,S=M*m+C*f,O=P*-f+O*m,b=y*-f+b*m,C=M*-f+C*m,E=D*-f+E*m,P=w,y=T,M=S),p=(c=Yd(-h,C))*Yc,c&&(m=Math.cos(-c),E=x*(f=Math.sin(-c))+E*m,g=w=g*m-O*f,u=T=u*m-b*f,h=S=h*m-C*f),l=(c=Yd(u,g))*Yc,c&&(w=g*(m=Math.cos(c))+u*(f=Math.sin(c)),T=P*m+y*f,u=u*m-g*f,y=y*m-P*f,g=w,P=T),s&&Math.abs(s)+Math.abs(l)>359.9&&(s=l=0,p=180-p),o=pa(Math.sqrt(g*g+u*u+h*h)),i=pa(Math.sqrt(y*y+M*M)),c=Yd(P,y),A=Math.abs(c)>2e-4?c*Yc:0,v=E?1/(E<0?-E:E):0),$.svg&&(w=r.getAttribute("transform"),$.forceCSS=r.setAttribute("transform","")||!uo(hc(r,qb)),w&&r.setAttribute("transform",w))),Math.abs(A)>90&&Math.abs(A)<270&&(k?(o*=-1,A+=l<=0?180:-180,l+=l<=0?180:-180):(i*=-1,A+=A<=0?180:-180)),$.x=(($.xPercent=e&&Math.round(r.offsetWidth/2)===Math.round(-e)?-50:0)?0:e)+"px",$.y=(($.yPercent=a&&Math.round(r.offsetHeight/2)===Math.round(-a)?-50:0)?0:a)+"px",$.z=n+"px",$.scaleX=pa(o),$.scaleY=pa(i),$.rotation=pa(l)+"deg",$.rotationX=pa(s)+"deg",$.rotationY=pa(p)+"deg",$.skewX=A+"deg",$.skewY=_+"deg",$.transformPerspective=v+"px",($.zOrigin=parseFloat(N.split(" ")[2])||0)&&(B[$c]=rh(N)),$.xOffset=$.yOffset=0,$.force3D=sb.force3D,$.renderTransform=$.svg?$t:Zu?wo:au,$.uncache=0,$},rh=function(r){return(r=r.split(" "))[0]+" "+r[1]},Ek=function(r,t,$){var e=Nb(t);return pa(parseFloat(t)+parseFloat(_c(r,"x",$+"px",e)))+e},au=function(r,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,wo(r,t)},cd="0deg",Jf="0px",dd=") ",wo=function(r,t){var $=t||this,e=$.xPercent,a=$.yPercent,n=$.x,o=$.y,i=$.z,l=$.rotation,s=$.rotationY,p=$.rotationX,A=$.skewX,_=$.skewY,v=$.scaleX,I=$.scaleY,Q=$.transformPerspective,d=$.force3D,c=$.target,m=$.zOrigin,f="",g="auto"===d&&r&&1!==r||!0===d;if(m&&(p!==cd||s!==cd)){var u,h=parseFloat(s)*Xd,x=Math.sin(h),P=Math.cos(h);h=parseFloat(p)*Xd,u=Math.cos(h),n=Ek(c,n,x*u*-m),o=Ek(c,o,-Math.sin(h)*-m),i=Ek(c,i,P*u*-m+m)}Q!==Jf&&(f+="perspective("+Q+dd),(e||a)&&(f+="translate("+e+"%, "+a+"%) "),(g||n!==Jf||o!==Jf||i!==Jf)&&(f+=i!==Jf||g?"translate3d("+n+", "+o+", "+i+") ":"translate("+n+", "+o+dd),l!==cd&&(f+="rotate("+l+dd),s!==cd&&(f+="rotateY("+s+dd),p!==cd&&(f+="rotateX("+p+dd),A===cd&&_===cd||(f+="skew("+A+", "+_+dd),1===v&&1===I||(f+="scale("+v+", "+I+dd),c.style[qb]=f||"translate(0, 0)"},$t=function(r,t){var $,e,a,n,o,i=t||this,l=i.xPercent,s=i.yPercent,p=i.x,A=i.y,_=i.rotation,v=i.skewX,I=i.skewY,Q=i.scaleX,d=i.scaleY,c=i.target,m=i.xOrigin,f=i.yOrigin,g=i.xOffset,u=i.yOffset,h=i.forceCSS,x=parseFloat(p),P=parseFloat(A);_=parseFloat(_),v=parseFloat(v),(I=parseFloat(I))&&(v+=I=parseFloat(I),_+=I),_||v?(_*=Xd,v*=Xd,$=Math.cos(_)*Q,e=Math.sin(_)*Q,a=Math.sin(_-v)*-d,n=Math.cos(_-v)*d,v&&(I*=Xd,o=Math.tan(v-I),a*=o=Math.sqrt(1+o*o),n*=o,I&&(o=Math.tan(I),$*=o=Math.sqrt(1+o*o),e*=o)),$=pa($),e=pa(e),a=pa(a),n=pa(n)):($=Q,n=d,e=a=0),(x&&!~(p+"").indexOf("px")||P&&!~(A+"").indexOf("px"))&&(x=_c(c,"x",p,"px"),P=_c(c,"y",A,"px")),(m||f||g||u)&&(x=pa(x+m-(m*$+f*a)+g),P=pa(P+f-(m*e+f*n)+u)),(l||s)&&(o=c.getBBox(),x=pa(x+l/100*o.width),P=pa(P+s/100*o.height)),o="matrix("+$+","+e+","+a+","+n+","+x+","+P+")",c.setAttribute("transform",o),h&&(c.style[qb]=o)},Zt=function(r,t,$,e,a,n){var o,i,l=Ta(a),s=parseFloat(a)*(l&&~a.indexOf("rad")?Yc:1),p=n?s*n:s-e,A=e+p+"deg";return l&&("short"===(o=a.split("_")[1])&&(p%=360)!==p%180&&(p+=p<0?360:-360),"cw"===o&&p<0?p=(p+360*bo)%360-360*~~(p/360):"ccw"===o&&p>0&&(p=(p-360*bo)%360-360*~~(p/360))),r._pt=i=new bb(r._pt,t,$,e,p,Mu),i.e=A,i.u="deg",r._props.push($),i},Xt=function(r,t,$){var e,a,n,o,i,l,s,p=Sh.style,A=$._gsap;for(a in p.cssText=getComputedStyle($).cssText+";position:absolute;display:block;",p[qb]=t,pc.body.appendChild(Sh),e=sh(Sh,1),Kc)(n=A[a])!==(o=e[a])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(a)<0&&(i=Nb(n)!==(s=Nb(o))?_c($,a,n,s):parseFloat(n),l=parseFloat(o),r._pt=new bb(r._pt,A,a,i,l-i,ho),r._pt.u=s||0,r._props.push(a));pc.body.removeChild(Sh)};fb("padding,margin,Width,Radius",function(r,t){var $="Top",e="Right",a="Bottom",n="Left",o=(t<3?[$,e,a,n]:[$+n,$+e,a+e,a+n]).map(function($){return t<2?r+$:"border"+$+r});wh[t>1?"border"+r:r]=function(r,t,$,e,a){var n,i;if(arguments.length<4)return n=o.map(function(t){return kf(r,t,$)}),5===(i=n.join(" ")).split(n[0]).length?n[0]:i;n=(e+"").split(" "),i={},o.forEach(function(r,t){return i[r]=n[t]=n[t]||n[(t-1)/2|0]}),r.init(t,i,a)}});var yo={name:"css",register:bk,targetTest:function(r){return r.style&&r.nodeType},init:function(r,t,$,e,a){var n,o,i,l,s,p,A,_,v,I,Q,d,c,m,f,g=this._props,u=r.style;for(A in $n||bk(),t)if("autoRound"!==A&&(o=t[A],!eb[A]||!Rn(A,t,$,e,r,a)))if(s=typeof o,p=wh[A],"function"===s&&(s=typeof(o=o.call($,e,r,a))),"string"===s&&~o.indexOf("random(")&&(o=Dg(o)),p)p(this,r,A,o,$)&&(f=1);else if("--"===A.substr(0,2))this.add(u,"setProperty",getComputedStyle(r).getPropertyValue(A)+"",o+"",e,a,0,0,A);else if("undefined"!==s){if(n=kf(r,A),l=parseFloat(n),(I="string"===s&&"="===o.charAt(1)?+(o.charAt(0)+"1"):0)&&(o=o.substr(2)),i=parseFloat(o),A in Jc&&("autoAlpha"===A&&(1===l&&"hidden"===kf(r,"visibility")&&i&&(l=0),Oc(this,u,"visibility",l?"inherit":"hidden",i?"inherit":"hidden",!i)),"scale"!==A&&"transform"!==A&&~(A=Jc[A]).indexOf(",")&&(A=A.split(",")[0])),Q=A in Kc){if(d||((c=r._gsap).renderTransform||sh(r),m=!1!==t.smoothOrigin&&c.smooth,(d=this._pt=new bb(this._pt,u,qb,0,1,c.renderTransform,c,0,-1)).dep=1),"scale"===A)this._pt=new bb(this._pt,c,"scaleY",c.scaleY,I?I*i:i-c.scaleY),g.push("scaleY",A),A+="X";else{if("transformOrigin"===A){o=fu(o),c.svg?Bk(r,o,0,m,0,this):((v=parseFloat(o.split(" ")[2])||0)!==c.zOrigin&&Oc(this,c,"zOrigin",c.zOrigin,v),Oc(this,u,A,rh(n),rh(o)));continue}if("svgOrigin"===A){Bk(r,o,1,m,0,this);continue}if(A in to){Zt(this,c,A,l,o,I);continue}if("smoothOrigin"===A){Oc(this,c,"smooth",c.smooth,o);continue}if("force3D"===A){c[A]=o;continue}if("transform"===A){Xt(this,o,r);continue}}}else A in u||(A=xd(A)||A);if(Q||(i||0===i)&&(l||0===l)&&!Pu.test(o)&&A in u)i||(i=0),(_=(n+"").substr((l+"").length))!==(v=Nb(o)||(A in sb.units?sb.units[A]:_))&&(l=_c(r,A,n,v)),this._pt=new bb(this._pt,Q?c:u,A,l,I?I*i:i-l,"px"!==v||!1===t.autoRound||Q?ho:Iu),this._pt.u=v||0,_!==v&&(this._pt.b=n,this._pt.r=Ku);else if(A in u)hu.call(this,r,A,n,o);else{if(!(A in r)){fk(A,o);continue}this.add(r,A,r[A],o,e,a)}g.push(A)}f&&Xn(this)},get:kf,aliases:Jc,getSetter:function(r,t,$){var e=Jc[t];return e&&e.indexOf(",")<0&&(t=e),t in Kc&&t!==$c&&(r._gsap.x||kf(r,"x"))?$&&av===$?"scale"===t?pu:qu:(av=$||{})&&("scale"===t?ou:nu):r.style&&!Ci(r.style[t])?su:~t.indexOf("-")?ru:kk(r,t)},core:{_removeProperty:Ah,_getMatrix:Ak}};$b.utils.checkPrefix=xd,function(r,t,$,e){var a=fb("x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+t+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(r){Kc[r]=1});fb(t,function(r){sb.units[r]="deg",to[r]=1}),Jc[a[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+t,fb("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(r){var t=r.split(":");Jc[t[1]]=a[t[0]]})}(0,"rotation,rotationX,rotationY,skewX,skewY"),fb("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){sb.units[r]="px"}),$b.registerPlugin(yo);var ba=$b.registerPlugin(yo)||$b,t=ba.core.Tween;var oi,pi={};var qi,ri,u,Tt=false;function Rt(){if(Tt)return;Tt=true;ri={};u=arguments[0];!function(e,t){"function"==typeof qi&&qi.amd?qi(t):ri?ri=t():e.EvEmitter=t()}("undefined"!=typeof window?window:ri,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var n=this._events=this._events||{},i=n[e]=n[e]||[];return-1==i.indexOf(t)&&i.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var n=this._onceEvents=this._onceEvents||{};return(n[e]=n[e]||{})[t]=!0,this}},t.off=function(e,t){var n=this._events&&this._events[e];if(n&&n.length){var i=n.indexOf(t);return-1!=i&&n.splice(i,1),this}},t.emitEvent=function(e,t){var n=this._events&&this._events[e];if(n&&n.length){n=n.slice(0),t=t||[];for(var i=this._onceEvents&&this._onceEvents[e],s=0;s<n.length;s++){var r=n[s];i&&i[r]&&(this.off(e,r),delete i[r]),r.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e})}!function(e,t){"function"==typeof oi&&oi.amd?oi(["ev-emitter/ev-emitter"],function(i){return t(e,i)}):pi?pi=t(e,(Rt(),ri)):e.imagesLoaded=t(e,e.EvEmitter)}("undefined"!=typeof window?window:pi,function(e,t){var i=e.jQuery,o=e.console;function r(e,t){for(var i in t)e[i]=t[i];return e}var n=Array.prototype.slice;function s(e,t,h){if(!(this instanceof s))return new s(e,t,h);var a,m=e;("string"==typeof e&&(m=document.querySelectorAll(e)),m)?(this.elements=(a=m,Array.isArray(a)?a:"object"==typeof a&&"number"==typeof a.length?n.call(a):[a]),this.options=r({},this.options),"function"==typeof t?h=t:r(this.options,t),h&&this.on("always",h),this.getImages(),i&&(this.jqDeferred=new i.Deferred),setTimeout(this.check.bind(this))):o.error("Bad element for imagesLoaded "+(m||e))}s.prototype=Object.create(t.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),!0===this.options.background&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&h[t]){for(var i=e.querySelectorAll("img"),o=0;o<i.length;o++){var r=i[o];this.addImage(r)}if("string"==typeof this.options.background){var n=e.querySelectorAll(this.options.background);for(o=0;o<n.length;o++){var s=n[o];this.addElementBackgroundImages(s)}}}};var h={1:!0,9:!0,11:!0};function a(e){this.img=e}function m(e,t){this.url=e,this.element=t,this.img=new Image}return s.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,o=i.exec(t.backgroundImage);null!==o;){var r=o&&o[2];r&&this.addBackground(r,e),o=i.exec(t.backgroundImage)}},s.prototype.addImage=function(e){var t=new a(e);this.images.push(t)},s.prototype.addBackground=function(e,t){var i=new m(e,t);this.images.push(i)},s.prototype.check=function(){var e=this;function t(t,i,o){setTimeout(function(){e.progress(t,i,o)})}this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach(function(e){e.once("progress",t),e.check()}):this.complete()},s.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&o&&o.log("progress: "+i,e,t)},s.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},a.prototype=Object.create(t.prototype),a.prototype.check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},a.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},a.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},a.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},a.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},a.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},a.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},m.prototype=Object.create(a.prototype),m.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},m.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},m.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},s.makeJQueryPlugin=function(t){(t=t||e.jQuery)&&((i=t).fn.imagesLoaded=function(e,t){return new s(this,e,t).jqDeferred.promise(i(this))})},s.makeJQueryPlugin(),s});function Ao(){return new Promise(function(e,r){pi(document.querySelectorAll("img"),{background:!0},e)})}function Pt(r,$,e){return r*(1-e)+$*e}function Ot(t,e){var r,o;return function(){var $=this,n=+new Date,p=arguments;r&&n<r+e?(clearTimeout(o),o=setTimeout(function(){r=n,t.apply($,p)},e)):(r=n,t.apply($,p))}}function Nt(e){var o=0,t=0;return e||(e=window.event),e.pageX||e.pageY?(o=e.pageX,t=e.pageY):(e.clientX||e.clientY)&&(o=e.clientX+body.scrollLeft+document.documentElement.scrollLeft,t=e.clientY+body.scrollTop+document.documentElement.scrollTop),{x:o,y:t}}function ig(){return{width:window.innerWidth,height:window.innerHeight}}var Mt=function(e){window.cancelAnimationFrame?window.cancelAnimationFrame(e.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(e.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(e.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(e.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(e.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(e.value):clearInterval(e)};var Lt=function(){function t(){xy(this,t),this.els=[],this.target=0,this.current=0,this.currentRounded=0,this.ease=1,this.tickFunc=this.tick.bind(this),this.init()}return uy(t,[{key:"tick",value:function(){this.current=this.target,this.currentRounded=Math.round(100*this.current)/100,Ia.emit("tick",{els:this.els,target:this.target,current:-this.currentRounded})}},{key:"onScroll",value:function(t){this.els=t.els,this.target=t.x}},{key:"on",value:function(){ba.ticker.add(this.tickFunc),Ia.on("scroll",this.onScroll.bind(this)),Ia.on("stopRaf",this.off.bind(this))}},{key:"off",value:function(){ba.ticker.remove(this.tickFunc),Ia.off("stopRaf"),Ia.off("tick")}},{key:"init",value:function(){this.on()}}]),t}(),v=new Lt;function Gt(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Eo(e,r){for(var t=0;t<r.length;t++){var $=r[t];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function Et(e,r,t){return r&&Eo(e.prototype,r),t&&Eo(e,t),e}var Dt=function(){function e(){Gt(this,e),this.init()}return Et(e,[{key:"onResize",value:function(){Ia.emit("resize")}},{key:"on",value:function(){window.addEventListener("resize",Ot(this.onResize,50))}},{key:"init",value:function(){this.on()}}]),e}(),w=new Dt;var Sg={};Sg=function(e,{tagName:t="span",split:n,setClassName:r=function(e){return"char"+e}}={}){e.normalize();let o=1;function a(e){const a=e.parentNode,i=e.nodeValue;(n?n(i):i.split("")).forEach(function(n){const i=document.createElement(t),c=r(o++,n);c&&(i.className=c),i.appendChild(document.createTextNode(n)),i.setAttribute("aria-hidden","true"),a.insertBefore(i,e)}),""!==i.trim()&&a.setAttribute("aria-label",i),a.removeChild(e)}!function e(t){if(3===t.nodeType)return a(t);const n=Array.prototype.slice.call(t.childNodes);if(1===n.length&&3===n[0].nodeType)return a(n[0]);n.forEach(function(t){e(t)})}(e)};var wt={namespace:"homepage",beforeEnter:function(t){},afterEnter:function(t){}},vt=function(t){return{name:"homepage-transition",to:{namespace:["homepage"]},once:function(e){e.current,e.next,e.trigger;window.addEventListener("load",function(){var e=document.getElementById("js-loader-subtitle");var $qP5t$$interop$default=zb(Sg);$qP5t$$interop$default.d(e,{setClassName:function(t,e){return"char letter-".concat(e)}});var o=ba.timeline();o.set("#js-loader-title-out",{opacity:0}),o.to("#js-loader-title",{opacity:.8,duration:1}),o.to("#js-loader-slider",{scaleY:0,duration:1,ease:"Power2.easeInOut"},"-=.5"),o.call(t,null,"-=.25"),o.set("#js-loader-title-out",{opacity:1},"-=.5"),o.from("#js-loader-date",{opacity:0,duration:1},"-=.2"),o.from(e.querySelectorAll(".char"),{opacity:0,duration:1,stagger:{from:"random",amount:1}},"-=1.2"),o.to("#js-loader-title",{opacity:0,duration:1},"-=1"),o.from(".js-header",{opacity:0,duration:1},"-=1"),o.to("#js-loader-content",{autoAlpha:1,duration:1},"-=.6"),o.to("#js-loader-circle",{strokeDashoffset:0,duration:1},"-=1.6"),o.to("#js-loader-arrow",{autoAlpha:1,duration:1},"-=.8");var r=document.querySelector(".dom-gl");ba.to(r,{autoAlpha:1,duration:.5})})},leave:function(t){var e=t.current;t.next,t.trigger;return new Promise(function(t){var o=document.querySelector(".dom-gl");ba.to(o,{autoAlpha:0,duration:.5}),ba.to(e.container,{autoAlpha:0,duration:.6,onComplete:function(){t()}})})},enter:function(e){var o=this,r=(e.current,e.next),a=(e.trigger,document.querySelector(".dom-gl")),n=document.getElementById("js-loader-subtitle");var $qP5t$$interop$default=zb(Sg);$qP5t$$interop$default.d(n,{setClassName:function(t,e){return"char letter-".concat(e)}}),ba.to(a,{autoAlpha:1,duration:.5}),ba.set("#js-loader-slider",{scaleY:0}),ba.from("#js-loader-date",{opacity:0,duration:1}),ba.from(n.querySelectorAll(".char"),{opacity:0,duration:1,stagger:{from:"random",amount:1}}),ba.to("#js-loader-content",{autoAlpha:1,duration:1,delay:1}),ba.to("#js-loader-circle",{strokeDashoffset:0,duration:1,delay:1}),ba.to("#js-loader-arrow",{autoAlpha:1,duration:1,delay:1.2}),ba.from(r.container,{autoAlpha:0,duration:1}),setTimeout(function(e){return t.call(o)},100)}}};function Jo(r){return nt(r)||pt(r)||rt(r)||st()}function st(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rt(r,o){if(r){if("string"==typeof r)return dj(r,o);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?dj(r,o):void 0}}function pt(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function nt(r){if(Array.isArray(r))return dj(r)}function dj(r,o){(null==o||o>r.length)&&(o=r.length);for(var e=0,t=new Array(o);e<o;e++)t[e]=r[e];return t}var mt={namespace:"serie",beforeEnter:function(r){},afterEnter:function(r){}},lt={name:"serie-transition",leave:function(r){var o=r.current;r.next,r.trigger;return new Promise(function(r){var e=document.querySelector(".dom-gl");ba.to(e,{autoAlpha:0,duration:.6}),ba.to(o.container,{autoAlpha:0,duration:.6,onComplete:function(){r()}})})},enter:function(r){r.current;var o=r.next,e=(r.trigger,document.querySelector(".dom-gl")),t=Jo(o.container.querySelectorAll(".js-sub-links"));ba.to(e,{autoAlpha:1,duration:.5}),ba.from(o.container,{autoAlpha:0,duration:1}),ba.fromTo(t,{autoAlpha:0},{autoAlpha:function(r,o){return o.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},once:function(r){r.current;var o=r.next,e=(r.trigger,document.querySelector(".dom-gl")),t=Jo(o.container.querySelectorAll(".js-sub-links"));ba.to(e,{autoAlpha:1,duration:.5}),ba.from(o.container,{autoAlpha:0,duration:1}),ba.fromTo(t,{autoAlpha:0},{autoAlpha:function(r,o){return o.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},to:{namespace:["serie"]}};function No(r){return ft(r)||gt(r)||ht(r)||it()}function it(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ht(r,t){if(r){if("string"==typeof r)return qj(r,t);var a=Object.prototype.toString.call(r).slice(8,-1);return"Object"===a&&r.constructor&&(a=r.constructor.name),"Map"===a||"Set"===a?Array.from(r):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?qj(r,t):void 0}}function gt(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function ft(r){if(Array.isArray(r))return qj(r)}function qj(r,t){(null==t||t>r.length)&&(t=r.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=r[a];return o}var et={namespace:"about",beforeEnter:function(r){},afterEnter:function(r){}},dt={name:"about-transition",leave:function(r){var t=r.current;r.next,r.trigger;return new Promise(function(r){var a=document.querySelector(".dom-gl");ba.to(a,{autoAlpha:0,duration:.6}),ba.to(t.container,{autoAlpha:0,duration:.6,onComplete:function(){r()}})})},enter:function(r){r.current;var t=r.next,a=(r.trigger,document.querySelector(".dom-gl")),o=No(t.container.querySelectorAll(".js-sub-links"));ba.to(a,{autoAlpha:1,duration:.5}),ba.from(t.container,{autoAlpha:0,duration:1}),ba.fromTo(o,{autoAlpha:0},{autoAlpha:function(r,t){return t.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},once:function(r){r.current;var t=r.next,a=(r.trigger,document.querySelector(".dom-gl")),o=No(t.container.querySelectorAll(".js-sub-links"));ba.to(a,{autoAlpha:1,duration:.5}),ba.from(t.container,{autoAlpha:0,duration:1}),ba.fromTo(o,{autoAlpha:0},{autoAlpha:function(r,t){return t.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},to:{namespace:["about"]}};function Oo(r){return $s(r)||_s(r)||at(r)||bt()}function bt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function at(r,a){if(r){if("string"==typeof r)return Ej(r,a);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ej(r,a):void 0}}function _s(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function $s(r){if(Array.isArray(r))return Ej(r)}function Ej(r,a){(null==a||a>r.length)&&(a=r.length);for(var t=0,e=new Array(a);t<a;t++)e[t]=r[t];return e}var Ys={namespace:"exhibitions",beforeEnter:function(r){},afterEnter:function(r){}},Vs={name:"exhibitions-transition",leave:function(r){var a=r.current;r.next,r.trigger;return new Promise(function(r){var t=document.querySelector(".dom-gl");ba.to(t,{autoAlpha:0,duration:.6}),ba.to(a.container,{autoAlpha:0,duration:.6,onComplete:function(){r()}})})},enter:function(r){r.current;var a=r.next,t=(r.trigger,document.querySelector(".dom-gl")),e=Oo(a.container.querySelectorAll(".js-sub-links"));ba.to(t,{autoAlpha:1,duration:.5}),ba.from(a.container,{autoAlpha:0,duration:1}),ba.fromTo(e,{autoAlpha:0},{autoAlpha:function(r,a){return a.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},once:function(r){r.current;var a=r.next,t=(r.trigger,document.querySelector(".dom-gl")),e=Oo(a.container.querySelectorAll(".js-sub-links"));ba.to(t,{autoAlpha:1,duration:.5}),ba.from(a.container,{autoAlpha:0,duration:1}),ba.fromTo(e,{autoAlpha:0},{autoAlpha:function(r,a){return a.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},to:{namespace:["exhibitions"]}};function Ro(r){return ls(r)||Ls(r)||Ms(r)||Ts()}function Ts(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ms(r,e){if(r){if("string"==typeof r)return Oj(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Oj(r,e):void 0}}function Ls(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function ls(r){if(Array.isArray(r))return Oj(r)}function Oj(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=r[t];return o}var hs={namespace:"collectors",beforeEnter:function(r){},afterEnter:function(r){}},bs={name:"collectors-transition",leave:function(r){var e=r.current;r.next,r.trigger;return new Promise(function(r){var t=document.querySelector(".dom-gl");ba.to(t,{autoAlpha:0,duration:.6}),ba.to(e.container,{autoAlpha:0,duration:.6,onComplete:function(){r()}})})},enter:function(r){r.current;var e=r.next,t=(r.trigger,document.querySelector(".dom-gl")),o=Ro(e.container.querySelectorAll(".js-sub-links"));ba.to(t,{autoAlpha:1,duration:.5}),ba.from(e.container,{autoAlpha:0,duration:1}),ba.fromTo(o,{autoAlpha:0},{autoAlpha:function(r,e){return e.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},once:function(r){r.current;var e=r.next,t=(r.trigger,document.querySelector(".dom-gl")),o=Ro(e.container.querySelectorAll(".js-sub-links"));ba.to(t,{autoAlpha:1,duration:.5}),ba.from(e.container,{autoAlpha:0,duration:1}),ba.fromTo(o,{autoAlpha:0},{autoAlpha:function(r,e){return e.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},to:{namespace:["collectors"]}};function bp(r){return ir(r)||jr(r)||kr(r)||Ur()}function Ur(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kr(r,a){if(r){if("string"==typeof r)return Wj(r,a);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Wj(r,a):void 0}}function jr(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function ir(r){if(Array.isArray(r))return Wj(r)}function Wj(r,a){(null==a||a>r.length)&&(a=r.length);for(var t=0,e=new Array(a);t<a;t++)e[t]=r[t];return e}var $q={namespace:"awards",beforeEnter:function(r){},afterEnter:function(r){}},Zq={name:"awards-transition",leave:function(r){var a=r.current;r.next,r.trigger;return new Promise(function(r){var t=document.querySelector(".dom-gl");ba.to(t,{autoAlpha:0,duration:.6}),ba.to(a.container,{autoAlpha:0,duration:.6,onComplete:function(){r()}})})},enter:function(r){r.current;var a=r.next,t=(r.trigger,document.querySelector(".dom-gl")),e=bp(a.container.querySelectorAll(".js-sub-links"));ba.to(t,{autoAlpha:1,duration:.5}),ba.from(a.container,{autoAlpha:0,duration:1}),ba.fromTo(e,{autoAlpha:0},{autoAlpha:function(r,a){return a.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},once:function(r){r.current;var a=r.next,t=(r.trigger,document.querySelector(".dom-gl")),e=bp(a.container.querySelectorAll(".js-sub-links"));ba.to(t,{autoAlpha:1,duration:.5}),ba.from(a.container,{autoAlpha:0,duration:1}),ba.fromTo(e,{autoAlpha:0},{autoAlpha:function(r,a){return a.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},to:{namespace:["awards"]}};function np(r){return lu(r)||ku(r)||Jq(r)||Kq()}function Kq(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Jq(r,t){if(r){if("string"==typeof r)return ck(r,t);var a=Object.prototype.toString.call(r).slice(8,-1);return"Object"===a&&r.constructor&&(a=r.constructor.name),"Map"===a||"Set"===a?Array.from(r):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ck(r,t):void 0}}function ku(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function lu(r){if(Array.isArray(r))return ck(r)}function ck(r,t){(null==t||t>r.length)&&(t=r.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=r[a];return o}var uu={namespace:"publications",beforeEnter:function(r){},afterEnter:function(r){}},vu={name:"publications-transition",leave:function(r){var t=r.current;r.next,r.trigger;return new Promise(function(r){var a=document.querySelector(".dom-gl");ba.to(a,{autoAlpha:0,duration:.6}),ba.to(t.container,{autoAlpha:0,duration:.6,onComplete:function(){r()}})})},enter:function(r){r.current;var t=r.next,a=(r.trigger,document.querySelector(".dom-gl")),o=np(t.container.querySelectorAll(".js-sub-links"));ba.to(a,{autoAlpha:1,duration:.5}),ba.from(t.container,{autoAlpha:0,duration:1}),ba.fromTo(o,{autoAlpha:0},{autoAlpha:function(r,t){return t.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},once:function(r){r.current;var t=r.next,a=(r.trigger,document.querySelector(".dom-gl")),o=np(t.container.querySelectorAll(".js-sub-links"));ba.to(a,{autoAlpha:1,duration:.5}),ba.from(t.container,{autoAlpha:0,duration:1}),ba.fromTo(o,{autoAlpha:0},{autoAlpha:function(r,t){return t.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},to:{namespace:["publications"]}};function jo(r){return Su(r)||Ou(r)||Nu(r)||wu()}function wu(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Nu(r,t){if(r){if("string"==typeof r)return lk(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?lk(r,t):void 0}}function Ou(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function Su(r){if(Array.isArray(r))return lk(r)}function lk(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,a=new Array(t);e<t;e++)a[e]=r[e];return a}var Uu={namespace:"press",beforeEnter:function(r){},afterEnter:function(r){}},Vu={name:"press-transition",leave:function(r){var t=r.current;r.next,r.trigger;return new Promise(function(r){var e=document.querySelector(".dom-gl");ba.to(e,{autoAlpha:0,duration:.6}),ba.to(t.container,{autoAlpha:0,duration:.6,onComplete:function(){r()}})})},enter:function(r){r.current;var t=r.next,e=(r.trigger,document.querySelector(".dom-gl")),a=jo(t.container.querySelectorAll(".js-sub-links"));ba.to(e,{autoAlpha:1,duration:.5}),ba.from(t.container,{autoAlpha:0,duration:1}),ba.fromTo(a,{autoAlpha:0},{autoAlpha:function(r,t){return t.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},once:function(r){r.current;var t=r.next,e=(r.trigger,document.querySelector(".dom-gl")),a=jo(t.container.querySelectorAll(".js-sub-links"));ba.to(e,{autoAlpha:1,duration:.5}),ba.from(t.container,{autoAlpha:0,duration:1}),ba.fromTo(a,{autoAlpha:0},{autoAlpha:function(r,t){return t.classList.contains("c-innernav_link--active")?1:.5},duration:.6,stagger:.1})},to:{namespace:["press"]}};var Wu={namespace:"contact",beforeEnter:function(t){},afterEnter:function(t){}},$u={name:"contact-transition",leave:function(t){var o=t.current;t.next,t.trigger;return new Promise(function(t){var a=document.querySelector(".dom-gl");ba.to(a,{autoAlpha:0,duration:.6}),ba.to(o.container,{autoAlpha:0,duration:.6,onComplete:function(){t()}})})},enter:function(t){t.current;var o=t.next,a=(t.trigger,document.querySelector(".dom-gl"));ba.to(a,{autoAlpha:1,duration:.5}),ba.from(o.container,{autoAlpha:0,duration:1}),ba.to(".js-contact-anim",{autoAlpha:1,duration:1.4,stagger:.12}),ba.to(".js-contact",{"--rotate-contact":"rotate(14deg)",duration:1.2}),ba.to(".js-contact",{"--scale-contact":"scaleY(1)",duration:1.2})},once:function(t){t.current;var o=t.next,a=(t.trigger,document.querySelector(".dom-gl"));ba.to(a,{autoAlpha:1,duration:.5}),ba.from(o.container,{autoAlpha:0,duration:1}),ba.to(".js-contact-anim",{autoAlpha:1,duration:1.4,stagger:.12}),ba.to(".js-contact",{"--rotate-contact":"rotate(14deg)",duration:1.2}),ba.to(".js-contact",{"--scale-contact":"scaleY(1)",duration:1.2})},to:{namespace:["contact"]}};var _u={namespace:"error",beforeEnter:function(r){},afterEnter:function(r){}},Av={name:"error-transition",leave:function(r){var o=r.current;r.next,r.trigger;return new Promise(function(r){var e=document.querySelector(".dom-gl");ba.to(e,{autoAlpha:0,duration:.6}),ba.to(o.container,{autoAlpha:0,duration:.6,onComplete:function(){r()}})})},enter:function(r){r.current;var o=r.next,e=(r.trigger,document.querySelector(".dom-gl"));ba.to(e,{autoAlpha:1,duration:.5}),ba.from(o.container,{autoAlpha:0,duration:1})},once:function(r){r.current;var o=r.next,e=(r.trigger,document.querySelector(".dom-gl"));ba.to(e,{autoAlpha:1,duration:.5}),ba.from(o.container,{autoAlpha:0,duration:1})},to:{namespace:["error"]}};var Ev=function(r){Hy(t,Zb);var e=Fy(t);function t(r){return Ny(this,t),e.call(this,r)}return Ly(t,[{key:"init",value:function(){var r=this;var $aBFI$$interop$default=zb(Eh);this.links=[],this.loadedViews=[mt,wt,et,Ys,hs,$q,uu,Uu,Wu,_u],this.loadedTransition=[lt,vt(function(e){return r.call("appear","","Homepage")}),dt,Vs,bs,Zq,vu,Vu,$u,Av],this.views=[],this.transitions=[],this._updateModules(),this._createModules("views",this.loadedViews),this._createModules("transitions",this.loadedTransition),$aBFI$$interop$default.d.init({views:this.views,transitions:this.transitions})}},{key:"_createModules",value:function(r){var e=this;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(t){return e[r].push(t)})}},{key:"_updateModules",value:function(){var r=this,e=function(r){Ia.emit("cursorEnter",{target:r.target})},t=function(){Ia.emit("cursorLeave")};this.loadedViews.forEach(function(n){var o=n.afterEnter?n.afterEnter:null;n.beforeLeave&&n.beforeLeave;n.beforeLeave=function(n){r.links.forEach(function(r){r.removeEventListener("mouseenter",e),r.removeEventListener("mouseleave",t)}),r.links=[]},n.afterEnter=function(n){o&&o(),Ia.emit("pageLoad"),r.linksFaked=yl(n.next.container.querySelectorAll(".a")),r.links=yl(n.next.container.querySelectorAll("a")).concat(r.linksFaked),r.links.forEach(function(r){r.addEventListener("mouseenter",e),r.addEventListener("mouseleave",t)}),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"Pageview",pagePath:n.next.url.path,pageTitle:document.title}),n.current.container&&(r.call("destroy",n.current.container,"app"),r.call("update",n.next.container,"app"))}})}},{key:"destroy",value:function(){var $aBFI$$interop$default=zb(Eh);$aBFI$$interop$default.d.destroy()}}]),t}();function Gv(e){return(Gv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function op(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Sn(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pv(e,r,t){return r&&Sn(e.prototype,r),t&&Sn(e,t),e}function Sv(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Tv(e,r)}function Tv(e,r){return(Tv=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function Uv(e){var r=dw();return function(){var t,n=Jn(e);if(r){var o=Jn(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Vv(this,t)}}function Vv(e,r){return!r||"object"!==Gv(r)&&"function"!=typeof r?cw(e):r}function cw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dw(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Jn(e){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=ig();window.addEventListener("resize",function(){l=ig()});var ug={x:0,y:0},fw=function(e){Sv(t,Zb);var r=Uv(t);function t(e){return op(this,t),r.call(this,e)}return Pv(t,[{key:"init",value:function(){var e=this;this.DOM={el:this.el},this.DOM.el.style.opacity=0,this.DOM.circleInner=this.DOM.el.querySelector(".cursor__inner"),this.firstLaod=!0,this.filterId="#filter-1",this.DOM.feTurbulence=document.querySelector("".concat(this.filterId," > feTurbulence")),this.primitiveValues={turbulence:0},this.createTimeline(),this.bounds=this.DOM.el.getBoundingClientRect(),this.renderedStyles={tx:{previous:0,current:0,amt:.2},ty:{previous:0,current:0,amt:.2},radius:{previous:60,current:60,amt:.2},stroke:{previous:1,current:1,amt:.2}},this.listen(),this.onMouseMoveEv=function(){e.firstLaod=!1,e.renderedStyles.tx.previous=e.renderedStyles.tx.current=ug.x-e.bounds.width/2,e.renderedStyles.ty.previous=e.renderedStyles.ty.previous=ug.y-e.bounds.height/2,ba.to(e.DOM.el,{duration:.9,ease:"Power3.easeOut",opacity:1}),requestAnimationFrame(function(){return e.render()}),window.removeEventListener("mousemove",e.onMouseMoveEv)},window.addEventListener("mousemove",function(e){return ug=Nt(e)}),window.addEventListener("mousemove",this.onMouseMoveEv)}},{key:"render",value:function(){var e=this;for(var r in this.renderedStyles.tx.current=ug.x-this.bounds.width/2,this.renderedStyles.ty.current=ug.y-this.bounds.height/2,this.renderedStyles)this.renderedStyles[r].previous=Pt(this.renderedStyles[r].previous,this.renderedStyles[r].current,this.renderedStyles[r].amt);this.DOM.el.style.transform="translateX(".concat(this.renderedStyles.tx.previous,"px) translateY(").concat(this.renderedStyles.ty.previous,"px)"),this.DOM.circleInner.setAttribute("r",this.renderedStyles.radius.previous),this.DOM.circleInner.style.strokeWidth="".concat(this.renderedStyles.stroke.previous,"px"),requestAnimationFrame(function(){return e.render()})}},{key:"createTimeline",value:function(){var e=this;this.tl=ba.timeline({paused:!0,onStart:function(){e.DOM.circleInner.style.filter="url(".concat(e.filterId)},onUpdate:function(){e.DOM.feTurbulence.setAttribute("baseFrequency",e.primitiveValues.turbulence)},onComplete:function(){e.DOM.circleInner.style.filter="none"}}).to(this.primitiveValues,{duration:.6,ease:"rough({ template: none.out, strength: 2, points: 120, taper: 'none', randomize: true, clamp: false})",startAt:{turbulence:.03},turbulence:0})}},{key:"displayArrow",value:function(e){ba.killTweensOf(this.$("arrow")),ba.to(this.$("arrow"),{autoAlpha:1,duration:1}),ba.to(this.$("arrow"),{rotate:"next"===e?90:-90,transformOrigin:"center",duration:.5})}},{key:"hideArrow",value:function(e){ba.killTweensOf(this.$("arrow")),ba.to(this.$("arrow"),{autoAlpha:0,duration:.5}),ba.to(this.$("arrow"),{rotate:0,duration:.5})}},{key:"disapear",value:function(){ba.to(this.DOM.el,{duration:.5,ease:"Power3.easeOut",opacity:0})}},{key:"appear",value:function(){ba.to(this.DOM.el,{duration:.5,ease:"Power3.easeOut",opacity:1})}},{key:"enter",value:function(e){this.renderedStyles.radius.current=45,this.renderedStyles.stroke.current=2,e&&"menu"===e.dataset.link&&this.disapear(),this.tl.restart()}},{key:"leave",value:function(){this.renderedStyles.radius.current=60,this.renderedStyles.stroke.current=1,this.tl.progress(1).kill(),this.appear()}},{key:"listen",value:function(){var e=this;Ia.on("cursorEnter",function(r){var t=r.target;return e.enter(t)}),Ia.on("cursorLeave",function(){return e.leave()}),Ia.on("pageLoad",function(){return e.firstLaod||e.leave()}),Ia.on("cursorAppear",function(){return e.appear()}),Ia.on("cursorDisapear",function(){return e.disapear()})}},{key:"destroy",value:function(){}}]),t}();function hw(e){return(hw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qg(e){return nw(e)||lw(e)||jw(e)||iw()}function iw(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jw(e,t){if(e){if("string"==typeof e)return ii(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ii(e,t):void 0}}function lw(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function nw(e){if(Array.isArray(e))return ii(e)}function ii(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function qw(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function An(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function rw(e,t,r){return t&&An(e.prototype,t),r&&An(e,r),e}function Cw(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dw(e,t)}function Dw(e,t){return(Dw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ew(e){var t=Kw();return function(){var r,a=rn(e);if(t){var o=rn(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return Fw(this,r)}}function Fw(e,t){return!t||"object"!==hw(t)&&"function"!=typeof t?Hw(e):t}function Hw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kw(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function rn(e){return(rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function qn(t){return Qw(t)||Pw(t)||Ow(t)||Nw()}function Nw(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ow(t,e){if(t){if("string"==typeof t)return zi(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?zi(t,e):void 0}}function Pw(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Qw(t){if(Array.isArray(t))return zi(t)}function zi(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ai=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.name="scroll",this.DOM={},this.config={},this.move={},this.callback=[],this.scrollStatut="start",this.init(t,e)};Ai.prototype=function(){var t=function(t){var i=Math.abs(t.deltaY)>Math.abs(t.deltaX)?t.deltaY:t.deltaX;this.move.dest+=this.runFirefox&&1==t.deltaMode?i*this.config.speed*this.config.multFirefox:i*this.config.speed,e.call(this)},e=function(){this.config.ticking||(this.rAF=requestAnimationFrame(i.bind(this)),this.config.ticking=!0)},i=function t(){var e=this;if(cancelAnimationFrame(this.rAF),this.rAF=requestAnimationFrame(t.bind(this)),this.move.dest>=this.config.scrollMax&&"end"!==this.scrollStatut?(this.config.scrollFuncs.endFunc(),this.scrollStatut="end"):this.move.dest<=0&&"start"!==this.scrollStatut?(this.config.scrollFuncs.startFunc(),this.scrollStatut="start"):this.move.dest>0&&this.move.dest<this.config.scrollMax&&"running"!==this.scrollStatut&&(this.config.scrollFuncs.runningFunc(),this.scrollStatut="running"),this.move.dest=Math.round(Math.max(0,Math.min(this.move.dest,this.config.scrollMax))),this.move.prev!==this.move.dest){this.move.current+=(this.move.dest-this.move.current)*this.config.delay;for(var i=-this.move.current.toFixed(2),n=this.sections.length-1;n>=0;n--)this.move.current>this.sections[n].offset&&this.move.current<this.sections[n].limit?(this.sections[n].el.style.transform=this.enableSmoothScroll&&!this.prevent&&"translate3D(".concat("horizontal"===this.config.direction?i:0,"px,").concat("vertical"===this.config.direction?i:0,"px, 0)"),!this.sections[n].isInView&&(this.sections[n].el.style.visibility="visible"),this.sections[n].isInView=!0):(this.sections[n].isInView&&(this.sections[n].el.style.visibility="hidden"),this.sections[n].isInView=!1);this.callback.length>0&&this.callback.forEach(function(t){return"function"==typeof t&&t(i,e.move.prev,e.config.scrollMax)}),this.move.prev=Math.round(this.move.current)}else this.config.ticking=!1,cancelAnimationFrame(this.rAF)},n=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bind",n="bind"===i?"addEventListener":"unbind"===i?"removeEventListener":null;if(null===n)throw"_domEvent function - wrong method! expect 'bind' || 'unbind' : got "+i;!0===this.config.resize&&(this._resize=this._resize||c.bind(this),window[n]("resize",this._resize,!1)),this.enableSmoothScroll?(this.deviceHasEvents.wheel&&(this._wheelFunc||(this._wheelFunc=t.bind(this)))&&document[n]("wheel",this._wheelFunc,!1),this.deviceHasEvents.mouseWheel&&(this._mouWheelFunc||(this._mouWheelFunc=t.bind(this)))&&document[n]("mousewheel",this._mouWheelFunc,!1),this.deviceHasEvents.keys&&(this._keysFunc||(this._keysFunc=function(t){38!==t.keyCode&&40!==t.keyCode||t.preventDefault(),this.move.dest+=38===t.keyCode?-this.config.jump:40===t.keyCode?this.config.jump:0,e.call(this)}.bind(this)))&&document[n]("keydown",this._keysFunc,!1),this.deviceHasEvents.touch&&(!this._touchStatFunc&&(this._touchStatFunc=function(t){var e=t.targetTouches?t.targetTouches[0]:t;this.move.touch={pageY:e.pageY,pageX:e.pageX}}.bind(this)),!this._touchMoveFunc&&(this._touchMoveFunc=function(t){var i=t.targetTouches?t.targetTouches[0]:t,n=i.pageY,o=i.pageX,r=Math.abs(i.pageY-this.move.touch.pageY)>Math.abs(i.pageX-this.move.touch.pageX)?"pageY":"pageX",s="pageY"===r?n:o;this.move.dest+=-(s-this.move.touch[r])*this.config.touchSpeed,this.move.touch={pageY:n,pageX:o},e.call(this)}.bind(this)),document[n]("touchstart",this._touchStatFunc),document[n]("touchmove",this._touchMoveFunc))):this.config.parallax&&(!this._scrollFunc&&(this._scrollFunc=function(t){this.move.dest=window.scrollY||window.pageYOffset,e.call(this)}.bind(this)),document[n]("scroll",this._scrollFunc,!1))},o=function(){var t=this,e=qn(this.DOM.scroller.querySelectorAll("img[src], video"));if(!(e.length<=0)){var i=!!window.Promise,n=!!window.fetch,o=i?[]:null,r=function(){t.config.scrollMax="vertical"===t.config.direction?t.DOM.scroller.offsetHeight-(document.documentElement.clientHeight||window.innerHeight):t.DOM.scroller.offsetWidth-(document.documentElement.clientWidth||window.innerWidth),t.resize(),t.config.initFuncs.length>0&&t.config.initFuncs.forEach(function(t){return t()})};e.forEach(function(e,s,c){var a="img"===e.nodeName.toLowerCase()?"load":"loadstart",l=document.createElement(e.nodeName.toLowerCase());if(i){var h=null;h=n?fetch(e.src).then(function(e){if(e.ok)return e;throw t.config.preloadFuncs.error(e),new Error(e.url+" Is not a 2xx response")}).catch(function(t){return console.error("Fetch error: "+t.message)}):new Promise(function(i,n){l.src=e.src,l.addEventListener(a,function(t){return i()},!1),l.addEventListener("error",function(e){return t.config.preloadFuncs.error(),n(new Error("Media failed loading"))},!1)}),o.push(h)}else l.onloadstart=l.onload=function(){c.splice(c.indexOf(e),1),0===c.length&&r()}}),i&&Promise.all(o).then(function(t){r()}).catch(function(t){console.error(t.message)})}},r=function(t){var e={};if(window.getComputedStyle){var i=getComputedStyle(t),n=i.transform||i.webkitTransform||i.mozTransform,o=n.match(/^matrix3d\((.+)\)$/);return o?parseFloat(o[1].split(", ")[13]):(o=n.match(/^matrix\((.+)\)$/),e.x=o?parseFloat(o[1].split(", ")[4]):0,e.y=o?parseFloat(o[1].split(", ")[5]):0,e)}},s=function(){this.enableSmoothScroll&&function(){return this.config.fixedClass?this.DOM.container.classList.add(this.config.fixedClass):(this.DOM.container.style.overflow="hidden",this.DOM.container.style.height="100vh"),!0}.call(this),n.call(this,"bind")},c=function(){(function(){var t=this;this.sections=[];var e=this.DOM.scroller.querySelectorAll("[data-".concat(this.name,"-section]"));0===e.length&&(e=this.DOM.scroller),qn(e).forEach(function(e){var i={isInView:!1};i.el=e,i.boundrect=i.el.getBoundingClientRect(),"vertical"===t.config.direction?(i.offset=i.boundrect.top-1.5*window.innerHeight-r(i.el).y,i.limit=i.offset+i.boundrect.height+2*window.innerHeight):(i.offset=i.boundrect.left-1.5*window.innerWidth-r(i.el).x,i.limit=i.offset+i.boundrect.width+2*window.innerWidth),t.sections.push(i)}),this.sections.sort(function(e,i){return"vertical"===t.config.direction?e.boundrect.top-i.boundrect.top:e.boundrect.left-i.boundrect.left})}).call(this),this.config.scrollMax="vertical"===this.config.direction?this.DOM.scroller.offsetHeight-(document.documentElement.clientHeight||window.innerHeight):this.DOM.scroller.offsetWidth-(document.documentElement.clientWidth||window.innerWidth)};return{init:function(t,e){var i;this.DOM.scroller=t.section,this.DOM.container=this.DOM.scroller.parentNode,this.config=(_a(i={delay:t.delay||.1,direction:t.direction||"vertical",speed:t.speed||1},"delay",t.delay||0),_a(i,"touchSpeed",t.touchSpeed||1.5),_a(i,"jump",t.jump||110),_a(i,"callback",t.callback||[]),_a(i,"touch",t.touch||!1),_a(i,"fixedClass",e||!1),_a(i,"resize",t.resize||!0),_a(i,"preload",t.preload||!0),_a(i,"multFirefox",15),_a(i,"scrollMax",0),_a(i,"ticking",!1),_a(i,"initFuncs",t.initFuncs||[]),_a(i,"scrollFuncs",t.scrollFuncs||{}),_a(i,"preloadFuncs",t.preloadFuncs||{}),i),this.move={current:0,dest:0,prev:0,touch:0},this.config.preload&&o.call(this),c.call(this),this.runFirefox=navigator.userAgent.indexOf("Firefox")>-1,this.deviceHasEvents={wheel:"onwheel"in document,mouseWheel:"onmousewheel"in document,touch:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,keys:"onkeydown"in document},this.enableSmoothScroll=!this.deviceHasEvents.touch||this.config.touch,this.callback=this.config.callback,s.call(this)},resize:c,bindEvent:s,unbindEvent:function(){n.call(this,"unbind"),void 0!==this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null)},scrollTo:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.move.dest=t,i||e.call(this),i&&(this.DOM.scroller.style.transform=this.enableSmoothScroll&&"translate3D(".concat("horizontal"===this.config.direction?t:0,"px,").concat("vertical"===this.config.direction?t:0,"px, 0)"))},scrollOf:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.move.dest+=t,i||e.call(this),i&&(this.DOM.scroller.style.transform=this.enableSmoothScroll&&"translate3D(".concat("horizontal"===this.config.direction?dir:0,"px,").concat("vertical"===this.config.direction?dir:0,"px, 0)")),"true"},destroy:function(){for(var t in this.unbindEvent.call(this),this)Object.prototype.hasOwnProperty.call(this,t)&&(this[t]=null,delete this[t]);return null}}}(),Object.defineProperty(Ai.prototype,"preventScroll",{set:function(t){this.prevent=t}});function Vw(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function hn(e,i){for(var r=0;r<i.length;r++){var t=i[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function Xw(e,i,r){return i&&hn(e.prototype,i),r&&hn(e,r),e}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let r=1;r<arguments.length;r++){const e=arguments[r];if(null!=e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t});const Yw=0,en=1,Zw=2,cn=1,_w=2,Yf=3,Wf=0,Oa=1,Bg=2,Ic=0,Sf=1,an=2,_m=3,$m=4,bx=5,Ee=100,dx=101,ex=102,gx=200,hx=201,ix=202,jx=203,Qm=204,Pm=205,kx=206,nx=207,ox=208,px=209,qx=210,rx=0,sx=1,tx=2,ij=3,ux=4,yx=5,Ax=6,Bx=7,Ug=0,Cx=1,Dx=2,Md=0,Ex=1,Gx=2,Hx=3,Ix=4,Jx=5,wj=301,xj=302,rm=303,zj=304,kg=306,Bj=307,ah=1e3,cb=1001,ch=1002,Pa=1003,Gj=1004,Hj=1005,Na=1006,qm=1007,gh=1008,ag=1009,Tx=1010,Vx=1011,kh=1012,Wx=1013,mh=1014,Dc=1015,oh=1016,Yx=1017,Zx=1018,$x=1019,Bf=1020,cy=1021,ad=1022,Cb=1023,dy=1024,ey=1025,fy=Cb,yd=1026,cf=1027,gy=1028,iy=1029,ky=1030,ny=1031,py=1032,wy=1033,Ul=33776,Tl=33777,Sl=33778,Pl=33779,Ol=35840,Ll=35841,Kl=35842,Jl=35843,By=36196,Fl=37492,El=37496,My=37808,Qy=37809,Ry=37810,Uy=37811,Wy=37812,$y=37813,az=37814,dz=37815,gz=37816,hz=37817,kz=37818,oz=37819,Bz=37820,Jz=37821,Kz=36492,bA=37840,kA=37841,WA=37842,eB=37843,mB=37844,qB=37845,yB=37846,CB=37847,MB=37848,Bt=37849,Kt=37850,kv=37851,pv=37852,xv=37853,KB=2201,Ed=2400,Pk=2500,$a=3e3,di=3001,Mk=3007,Lk=3002,OA=3003,dl=3004,el=3005,fl=3006,EA=3200,uA=3201,Jd=0,jA=1,Jk=7680,Nz=519,bi=35044,gf=35048;function oc(){}Object.assign(oc.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}},dispatchEvent:function(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const r=t.slice(0);for(let t=0,o=r.length;t<o;t++)r[t].call(this,e)}}});const Ra=[];for(let e=0;e<256;e++)Ra[e]=(e<16?"0":"")+e.toString(16);const ma={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;return(Ra[255&e]+Ra[e>>8&255]+Ra[e>>16&255]+Ra[e>>24&255]+"-"+Ra[255&t]+Ra[t>>8&255]+"-"+Ra[t>>16&15|64]+Ra[t>>24&255]+"-"+Ra[63&r|128]+Ra[r>>8&255]+"-"+Ra[r>>16&255]+Ra[r>>24&255]+Ra[255&o]+Ra[o>>8&255]+Ra[o>>16&255]+Ra[o>>24&255]).toUpperCase()},clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,o,n){return o+(e-t)*(n-o)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*ma.DEG2RAD},radToDeg:function(e){return e*ma.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,r,o,n){const i=Math.cos,a=Math.sin,s=i(r/2),l=a(r/2),$=i((t+o)/2),c=a((t+o)/2),p=i((t-o)/2),u=a((t-o)/2),h=i((o-t)/2),d=a((o-t)/2);switch(n){case"XYX":e.set(s*c,l*p,l*u,s*$);break;case"YZY":e.set(l*u,s*c,l*p,s*$);break;case"ZXZ":e.set(l*p,l*u,s*c,s*$);break;case"XZX":e.set(s*c,l*d,l*h,s*$);break;case"YXY":e.set(l*h,s*c,l*d,s*$);break;case"ZYZ":e.set(l*d,l*h,s*c,s*$);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n);}}};function ca(e=0,t=0){this.x=e,this.y=t}function Xa(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let rf;Object.defineProperties(ca.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(ca.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){const t=this.x,r=this.y,o=e.elements;return this.x=o[0]*t+o[3]*r+o[6],this.y=o[1]*t+o[4]*r+o[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){const r=Math.cos(t),o=Math.sin(t),n=this.x-e.x,i=this.y-e.y;return this.x=n*r-i*o+e.x,this.y=n*o+i*r+e.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(Xa.prototype,{isMatrix3:!0,set:function(e,t,r,o,n,i,a,s,l){const $=this.elements;return $[0]=e,$[1]=o,$[2]=a,$[3]=t,$[4]=n,$[5]=s,$[6]=r,$[7]=i,$[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this},extractBasis:function(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){const r=e.elements,o=t.elements,n=this.elements,i=r[0],a=r[3],s=r[6],l=r[1],$=r[4],c=r[7],p=r[2],u=r[5],h=r[8],d=o[0],f=o[3],m=o[6],x=o[1],g=o[4],v=o[7],F=o[2],K=o[5],y=o[8];return n[0]=i*d+a*x+s*F,n[3]=i*f+a*g+s*K,n[6]=i*m+a*v+s*y,n[1]=l*d+$*x+c*F,n[4]=l*f+$*g+c*K,n[7]=l*m+$*v+c*y,n[2]=p*d+u*x+h*F,n[5]=p*f+u*g+h*K,n[8]=p*m+u*v+h*y,this},multiplyScalar:function(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){const e=this.elements,t=e[0],r=e[1],o=e[2],n=e[3],i=e[4],a=e[5],s=e[6],l=e[7],$=e[8];return t*i*$-t*a*l-r*n*$+r*a*s+o*n*l-o*i*s},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const r=e.elements,o=this.elements,n=r[0],i=r[1],a=r[2],s=r[3],l=r[4],$=r[5],c=r[6],p=r[7],u=r[8],h=u*l-$*p,d=$*c-u*s,f=p*s-l*c,m=n*h+i*d+a*f;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const x=1/m;return o[0]=h*x,o[1]=(a*p-u*i)*x,o[2]=($*i-a*l)*x,o[3]=d*x,o[4]=(u*n-a*c)*x,o[5]=(a*s-$*n)*x,o[6]=f*x,o[7]=(i*c-p*n)*x,o[8]=(l*n-i*s)*x,this},transpose:function(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,r,o,n,i,a){const s=Math.cos(n),l=Math.sin(n);this.set(r*s,r*l,-r*(s*i+l*a)+i+e,-o*l,o*s,-o*(-l*i+s*a)+a+t,0,0,1)},scale:function(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this},rotate:function(e){const t=Math.cos(e),r=Math.sin(e),o=this.elements,n=o[0],i=o[3],a=o[6],s=o[1],l=o[4],$=o[7];return o[0]=t*n+r*s,o[3]=t*i+r*l,o[6]=t*a+r*$,o[1]=-r*n+t*s,o[4]=-r*i+t*l,o[7]=-r*a+t*$,this},translate:function(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this},equals:function(e){const t=this.elements,r=e.elements;for(let o=0;o<9;o++)if(t[o]!==r[o])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}});const fd={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===rf&&(rf=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),rf.width=e.width,rf.height=e.height;const r=rf.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=rf}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}};let _y=0;function va(e,t,r,o,n,i,a,s,l,$){Object.defineProperty(this,"id",{value:_y++}),this.uuid=ma.generateUUID(),this.name="",this.image=void 0!==e?e:va.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:va.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:cb,this.wrapT=void 0!==o?o:cb,this.magFilter=void 0!==n?n:Na,this.minFilter=void 0!==i?i:gh,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:Cb,this.internalFormat=null,this.type=void 0!==s?s:ag,this.offset=new ca(0,0),this.repeat=new ca(1,1),this.center=new ca(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xa,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==$?$:$a,this.version=0,this.onUpdate=null}function sa(e=0,t=0,r=0,o=1){this.x=e,this.y=t,this.z=r,this.w=o}function vb(e,t,r){this.width=e,this.height=t,this.scissor=new sa(0,0,e,t),this.scissorTest=!1,this.viewport=new sa(0,0,e,t),r=r||{},this.texture=new va(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:Na,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function zl(e,t,r){vb.call(this,e,t,r),this.samples=4}function Ka(e=0,t=0,r=0,o=1){this._x=e,this._y=t,this._z=r,this._w=o}va.DEFAULT_IMAGE=void 0,va.DEFAULT_MAPPING=300,va.prototype=Object.assign(Object.create(oc.prototype),{constructor:va,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const o=this.image;if(void 0===o.uuid&&(o.uuid=ma.generateUUID()),!t&&void 0===e.images[o.uuid]){let t;if(Array.isArray(o)){t=[];for(let e=0,r=o.length;e<r;e++)t.push(fd.getDataURL(o[e]))}else t=fd.getDataURL(o);e.images[o.uuid]={uuid:o.uuid,url:t}}r.image=o.uuid}return t||(e.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ah:e.x=e.x-Math.floor(e.x);break;case cb:e.x=e.x<0?0:1;break;case ch:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);}if(e.y<0||e.y>1)switch(this.wrapT){case ah:e.y=e.y-Math.floor(e.y);break;case cb:e.y=e.y<0?0:1;break;case ch:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(va.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(sa.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(sa.prototype,{isVector4:!0,set:function(e,t,r,o){return this.x=e,this.y=t,this.z=r,this.w=o,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){const t=this.x,r=this.y,o=this.z,n=this.w,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*o+i[12]*n,this.y=i[1]*t+i[5]*r+i[9]*o+i[13]*n,this.z=i[2]*t+i[6]*r+i[10]*o+i[14]*n,this.w=i[3]*t+i[7]*r+i[11]*o+i[15]*n,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){let t,r,o,n;const i=e.elements,a=i[0],s=i[4],l=i[8],$=i[1],c=i[5],p=i[9],u=i[2],h=i[6],d=i[10];if(Math.abs(s-$)<.01&&Math.abs(l-u)<.01&&Math.abs(p-h)<.01){if(Math.abs(s+$)<.1&&Math.abs(l+u)<.1&&Math.abs(p+h)<.1&&Math.abs(a+c+d-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const e=(a+1)/2,i=(c+1)/2,f=(d+1)/2,m=(s+$)/4,x=(l+u)/4,g=(p+h)/4;return e>i&&e>f?e<.01?(r=0,o=.707106781,n=.707106781):(o=m/(r=Math.sqrt(e)),n=x/r):i>f?i<.01?(r=.707106781,o=0,n=.707106781):(r=m/(o=Math.sqrt(i)),n=g/o):f<.01?(r=.707106781,o=.707106781,n=0):(r=x/(n=Math.sqrt(f)),o=g/n),this.set(r,o,n,t),this}let f=Math.sqrt((h-p)*(h-p)+(l-u)*(l-u)+($-s)*($-s));return Math.abs(f)<.001&&(f=1),this.x=(h-p)/f,this.y=(l-u)/f,this.z=($-s)/f,this.w=Math.acos((a+c+d-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),vb.prototype=Object.assign(Object.create(oc.prototype),{constructor:vb,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),zl.prototype=Object.assign(Object.create(vb.prototype),{constructor:zl,isWebGLMultisampleRenderTarget:!0,copy:function(e){return vb.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(Ka,{slerp:function(e,t,r,o){return r.copy(e).slerp(t,o)},slerpFlat:function(e,t,r,o,n,i,a){let s=r[o+0],l=r[o+1],$=r[o+2],c=r[o+3];const p=n[i+0],u=n[i+1],h=n[i+2],d=n[i+3];if(c!==d||s!==p||l!==u||$!==h){let e=1-a,t=s*p+l*u+$*h+c*d,r=t>=0?1:-1,o=1-t*t;if(o>Number.EPSILON){const n=Math.sqrt(o),i=Math.atan2(n,t*r);e=Math.sin(e*i)/n,a=Math.sin(a*i)/n}const n=a*r;if(s=s*e+p*n,l=l*e+u*n,$=$*e+h*n,c=c*e+d*n,e===1-a){const e=1/Math.sqrt(s*s+l*l+$*$+c*c);s*=e,l*=e,$*=e,c*=e}}e[t]=s,e[t+1]=l,e[t+2]=$,e[t+3]=c},multiplyQuaternionsFlat:function(e,t,r,o,n,i){const a=r[o],s=r[o+1],l=r[o+2],$=r[o+3],c=n[i],p=n[i+1],u=n[i+2],h=n[i+3];return e[t]=a*h+$*c+s*u-l*p,e[t+1]=s*h+$*p+l*c-a*u,e[t+2]=l*h+$*u+a*p-s*c,e[t+3]=$*h-a*c-s*p-l*u,e}}),Object.defineProperties(Ka.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(Ka.prototype,{isQuaternion:!0,set:function(e,t,r,o){return this._x=e,this._y=t,this._z=r,this._w=o,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const r=e._x,o=e._y,n=e._z,i=e.order,a=Math.cos,s=Math.sin,l=a(r/2),$=a(o/2),c=a(n/2),p=s(r/2),u=s(o/2),h=s(n/2);switch(i){case"XYZ":this._x=p*$*c+l*u*h,this._y=l*u*c-p*$*h,this._z=l*$*h+p*u*c,this._w=l*$*c-p*u*h;break;case"YXZ":this._x=p*$*c+l*u*h,this._y=l*u*c-p*$*h,this._z=l*$*h-p*u*c,this._w=l*$*c+p*u*h;break;case"ZXY":this._x=p*$*c-l*u*h,this._y=l*u*c+p*$*h,this._z=l*$*h+p*u*c,this._w=l*$*c-p*u*h;break;case"ZYX":this._x=p*$*c-l*u*h,this._y=l*u*c+p*$*h,this._z=l*$*h-p*u*c,this._w=l*$*c+p*u*h;break;case"YZX":this._x=p*$*c+l*u*h,this._y=l*u*c+p*$*h,this._z=l*$*h-p*u*c,this._w=l*$*c-p*u*h;break;case"XZY":this._x=p*$*c-l*u*h,this._y=l*u*c-p*$*h,this._z=l*$*h+p*u*c,this._w=l*$*c+p*u*h;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+i);}return!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){const r=t/2,o=Math.sin(r);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(r),this._onChangeCallback(),this},setFromRotationMatrix:function(e){const t=e.elements,r=t[0],o=t[4],n=t[8],i=t[1],a=t[5],s=t[9],l=t[2],$=t[6],c=t[10],p=r+a+c;if(p>0){const e=.5/Math.sqrt(p+1);this._w=.25/e,this._x=($-s)*e,this._y=(n-l)*e,this._z=(i-o)*e}else if(r>a&&r>c){const e=2*Math.sqrt(1+r-a-c);this._w=($-s)/e,this._x=.25*e,this._y=(o+i)/e,this._z=(n+l)/e}else if(a>c){const e=2*Math.sqrt(1+a-r-c);this._w=(n-l)/e,this._x=(o+i)/e,this._y=.25*e,this._z=(s+$)/e}else{const e=2*Math.sqrt(1+c-r-a);this._w=(i-o)/e,this._x=(n+l)/e,this._y=(s+$)/e,this._z=.25*e}return this._onChangeCallback(),this},setFromUnitVectors:function(e,t){let r=e.dot(t)+1;return r<1e-6?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(ma.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){const r=this.angleTo(e);if(0===r)return this;const o=Math.min(1,t/r);return this.slerp(e,o),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){const r=e._x,o=e._y,n=e._z,i=e._w,a=t._x,s=t._y,l=t._z,$=t._w;return this._x=r*$+i*a+o*l-n*s,this._y=o*$+i*s+n*a-r*l,this._z=n*$+i*l+r*s-o*a,this._w=i*$-r*a-o*s-n*l,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,o=this._y,n=this._z,i=this._w;let a=i*e._w+r*e._x+o*e._y+n*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=i,this._x=r,this._y=o,this._z=n,this;const s=1-a*a;if(s<=Number.EPSILON){const e=1-t;return this._w=e*i+t*this._w,this._x=e*r+t*this._x,this._y=e*o+t*this._y,this._z=e*n+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(s),$=Math.atan2(l,a),c=Math.sin((1-t)*$)/l,p=Math.sin(t*$)/l;return this._w=i*c+this._w*p,this._x=r*c+this._x*p,this._y=o*c+this._y*p,this._z=n*c+this._z*p,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},fromBufferAttribute:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});const vk=new aa,Cl=new Ka;function aa(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}Object.assign(aa.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Cl.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(Cl.setFromAxisAngle(e,t))},applyMatrix3:function(e){const t=this.x,r=this.y,o=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*o,this.y=n[1]*t+n[4]*r+n[7]*o,this.z=n[2]*t+n[5]*r+n[8]*o,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){const t=this.x,r=this.y,o=this.z,n=e.elements,i=1/(n[3]*t+n[7]*r+n[11]*o+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*o+n[12])*i,this.y=(n[1]*t+n[5]*r+n[9]*o+n[13])*i,this.z=(n[2]*t+n[6]*r+n[10]*o+n[14])*i,this},applyQuaternion:function(e){const t=this.x,r=this.y,o=this.z,n=e.x,i=e.y,a=e.z,s=e.w,l=s*t+i*o-a*r,$=s*r+a*t-n*o,c=s*o+n*r-i*t,p=-n*t-i*r-a*o;return this.x=l*s+p*-n+$*-a-c*-i,this.y=$*s+p*-i+c*-n-l*-a,this.z=c*s+p*-a+l*-i-$*-n,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){const t=this.x,r=this.y,o=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*o,this.y=n[1]*t+n[5]*r+n[9]*o,this.z=n[2]*t+n[6]*r+n[10]*o,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){const r=e.x,o=e.y,n=e.z,i=t.x,a=t.y,s=t.z;return this.x=o*s-n*a,this.y=n*i-r*s,this.z=r*a-o*i,this},projectOnVector:function(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)},projectOnPlane:function(e){return vk.copy(this).projectOnVector(e),this.sub(vk)},reflect:function(e){return this.sub(vk.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(ma.clamp(r,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){const t=this.x-e.x,r=this.y-e.y,o=this.z-e.z;return t*t+r*r+o*o},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,r){const o=Math.sin(t)*e;return this.x=o*Math.sin(r),this.y=Math.cos(t)*e,this.z=o*Math.cos(r),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=o,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const be=new aa,Bb=new na,Jy=new aa(0,0,0),Iy=new aa(1,1,1),wc=new aa,Mh=new aa,lb=new aa;function na(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(na.prototype,{isMatrix4:!0,set:function(e,t,r,o,n,i,a,s,l,$,c,p,u,h,d,f){const m=this.elements;return m[0]=e,m[4]=t,m[8]=r,m[12]=o,m[1]=n,m[5]=i,m[9]=a,m[13]=s,m[2]=l,m[6]=$,m[10]=c,m[14]=p,m[3]=u,m[7]=h,m[11]=d,m[15]=f,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new na().fromArray(this.elements)},copy:function(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this},copyPosition:function(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:function(e){const t=this.elements,r=e.elements,o=1/be.setFromMatrixColumn(e,0).length(),n=1/be.setFromMatrixColumn(e,1).length(),i=1/be.setFromMatrixColumn(e,2).length();return t[0]=r[0]*o,t[1]=r[1]*o,t[2]=r[2]*o,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*i,t[9]=r[9]*i,t[10]=r[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,r=e.x,o=e.y,n=e.z,i=Math.cos(r),a=Math.sin(r),s=Math.cos(o),l=Math.sin(o),$=Math.cos(n),c=Math.sin(n);if("XYZ"===e.order){const e=i*$,r=i*c,o=a*$,n=a*c;t[0]=s*$,t[4]=-s*c,t[8]=l,t[1]=r+o*l,t[5]=e-n*l,t[9]=-a*s,t[2]=n-e*l,t[6]=o+r*l,t[10]=i*s}else if("YXZ"===e.order){const e=s*$,r=s*c,o=l*$,n=l*c;t[0]=e+n*a,t[4]=o*a-r,t[8]=i*l,t[1]=i*c,t[5]=i*$,t[9]=-a,t[2]=r*a-o,t[6]=n+e*a,t[10]=i*s}else if("ZXY"===e.order){const e=s*$,r=s*c,o=l*$,n=l*c;t[0]=e-n*a,t[4]=-i*c,t[8]=o+r*a,t[1]=r+o*a,t[5]=i*$,t[9]=n-e*a,t[2]=-i*l,t[6]=a,t[10]=i*s}else if("ZYX"===e.order){const e=i*$,r=i*c,o=a*$,n=a*c;t[0]=s*$,t[4]=o*l-r,t[8]=e*l+n,t[1]=s*c,t[5]=n*l+e,t[9]=r*l-o,t[2]=-l,t[6]=a*s,t[10]=i*s}else if("YZX"===e.order){const e=i*s,r=i*l,o=a*s,n=a*l;t[0]=s*$,t[4]=n-e*c,t[8]=o*c+r,t[1]=c,t[5]=i*$,t[9]=-a*$,t[2]=-l*$,t[6]=r*c+o,t[10]=e-n*c}else if("XZY"===e.order){const e=i*s,r=i*l,o=a*s,n=a*l;t[0]=s*$,t[4]=-c,t[8]=l*$,t[1]=e*c+n,t[5]=i*$,t[9]=r*c-o,t[2]=o*c-r,t[6]=a*$,t[10]=n*c+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(Jy,e,Iy)},lookAt:function(e,t,r){const o=this.elements;return lb.subVectors(e,t),0===lb.lengthSq()&&(lb.z=1),lb.normalize(),wc.crossVectors(r,lb),0===wc.lengthSq()&&(1===Math.abs(r.z)?lb.x+=1e-4:lb.z+=1e-4,lb.normalize(),wc.crossVectors(r,lb)),wc.normalize(),Mh.crossVectors(lb,wc),o[0]=wc.x,o[4]=Mh.x,o[8]=lb.x,o[1]=wc.y,o[5]=Mh.y,o[9]=lb.y,o[2]=wc.z,o[6]=Mh.z,o[10]=lb.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){const r=e.elements,o=t.elements,n=this.elements,i=r[0],a=r[4],s=r[8],l=r[12],$=r[1],c=r[5],p=r[9],u=r[13],h=r[2],d=r[6],f=r[10],m=r[14],x=r[3],g=r[7],v=r[11],F=r[15],K=o[0],y=o[4],_=o[8],b=o[12],M=o[1],w=o[5],S=o[9],T=o[13],A=o[2],E=o[6],L=o[10],C=o[14],R=o[3],B=o[7],P=o[11],G=o[15];return n[0]=i*K+a*M+s*A+l*R,n[4]=i*y+a*w+s*E+l*B,n[8]=i*_+a*S+s*L+l*P,n[12]=i*b+a*T+s*C+l*G,n[1]=$*K+c*M+p*A+u*R,n[5]=$*y+c*w+p*E+u*B,n[9]=$*_+c*S+p*L+u*P,n[13]=$*b+c*T+p*C+u*G,n[2]=h*K+d*M+f*A+m*R,n[6]=h*y+d*w+f*E+m*B,n[10]=h*_+d*S+f*L+m*P,n[14]=h*b+d*T+f*C+m*G,n[3]=x*K+g*M+v*A+F*R,n[7]=x*y+g*w+v*E+F*B,n[11]=x*_+g*S+v*L+F*P,n[15]=x*b+g*T+v*C+F*G,this},multiplyScalar:function(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){const e=this.elements,t=e[0],r=e[4],o=e[8],n=e[12],i=e[1],a=e[5],s=e[9],l=e[13],$=e[2],c=e[6],p=e[10],u=e[14];return e[3]*(+n*s*c-o*l*c-n*a*p+r*l*p+o*a*u-r*s*u)+e[7]*(+t*s*u-t*l*p+n*i*p-o*i*u+o*l*$-n*s*$)+e[11]*(+t*l*c-t*a*u-n*i*c+r*i*u+n*a*$-r*l*$)+e[15]*(-o*a*$-t*s*c+t*a*p+o*i*c-r*i*p+r*s*$)},transpose:function(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,r){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=t,o[14]=r),this},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const r=this.elements,o=e.elements,n=o[0],i=o[1],a=o[2],s=o[3],l=o[4],$=o[5],c=o[6],p=o[7],u=o[8],h=o[9],d=o[10],f=o[11],m=o[12],x=o[13],g=o[14],v=o[15],F=h*g*p-x*d*p+x*c*f-$*g*f-h*c*v+$*d*v,K=m*d*p-u*g*p-m*c*f+l*g*f+u*c*v-l*d*v,y=u*x*p-m*h*p+m*$*f-l*x*f-u*$*v+l*h*v,_=m*h*c-u*x*c-m*$*d+l*x*d+u*$*g-l*h*g,b=n*F+i*K+a*y+s*_;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/b;return r[0]=F*M,r[1]=(x*d*s-h*g*s-x*a*f+i*g*f+h*a*v-i*d*v)*M,r[2]=($*g*s-x*c*s+x*a*p-i*g*p-$*a*v+i*c*v)*M,r[3]=(h*c*s-$*d*s-h*a*p+i*d*p+$*a*f-i*c*f)*M,r[4]=K*M,r[5]=(u*g*s-m*d*s+m*a*f-n*g*f-u*a*v+n*d*v)*M,r[6]=(m*c*s-l*g*s-m*a*p+n*g*p+l*a*v-n*c*v)*M,r[7]=(l*d*s-u*c*s+u*a*p-n*d*p-l*a*f+n*c*f)*M,r[8]=y*M,r[9]=(m*h*s-u*x*s-m*i*f+n*x*f+u*i*v-n*h*v)*M,r[10]=(l*x*s-m*$*s+m*i*p-n*x*p-l*i*v+n*$*v)*M,r[11]=(u*$*s-l*h*s-u*i*p+n*h*p+l*i*f-n*$*f)*M,r[12]=_*M,r[13]=(u*x*a-m*h*a+m*i*d-n*x*d-u*i*g+n*h*g)*M,r[14]=(m*$*a-l*x*a-m*i*c+n*x*c+l*i*g-n*$*g)*M,r[15]=(l*h*a-u*$*a+u*i*c-n*h*c-l*i*d+n*$*d)*M,this},scale:function(e){const t=this.elements,r=e.x,o=e.y,n=e.z;return t[0]*=r,t[4]*=o,t[8]*=n,t[1]*=r,t[5]*=o,t[9]*=n,t[2]*=r,t[6]*=o,t[10]*=n,t[3]*=r,t[7]*=o,t[11]*=n,this},getMaxScaleOnAxis:function(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],o=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,o))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){const r=Math.cos(t),o=Math.sin(t),n=1-r,i=e.x,a=e.y,s=e.z,l=n*i,$=n*a;return this.set(l*i+r,l*a-o*s,l*s+o*a,0,l*a+o*s,$*a+r,$*s-o*i,0,l*s-o*a,$*s+o*i,n*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){const o=this.elements,n=t._x,i=t._y,a=t._z,s=t._w,l=n+n,$=i+i,c=a+a,p=n*l,u=n*$,h=n*c,d=i*$,f=i*c,m=a*c,x=s*l,g=s*$,v=s*c,F=r.x,K=r.y,y=r.z;return o[0]=(1-(d+m))*F,o[1]=(u+v)*F,o[2]=(h-g)*F,o[3]=0,o[4]=(u-v)*K,o[5]=(1-(p+m))*K,o[6]=(f+x)*K,o[7]=0,o[8]=(h+g)*y,o[9]=(f-x)*y,o[10]=(1-(p+d))*y,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this},decompose:function(e,t,r){const o=this.elements;let n=be.set(o[0],o[1],o[2]).length(),i=be.set(o[4],o[5],o[6]).length(),a=be.set(o[8],o[9],o[10]).length();this.determinant()<0&&(n=-n),e.x=o[12],e.y=o[13],e.z=o[14],Bb.copy(this);const s=1/n,l=1/i,$=1/a;return Bb.elements[0]*=s,Bb.elements[1]*=s,Bb.elements[2]*=s,Bb.elements[4]*=l,Bb.elements[5]*=l,Bb.elements[6]*=l,Bb.elements[8]*=$,Bb.elements[9]*=$,Bb.elements[10]*=$,t.setFromRotationMatrix(Bb),r.x=n,r.y=i,r.z=a,this},makePerspective:function(e,t,r,o,n,i){void 0===i&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,s=2*n/(t-e),l=2*n/(r-o),$=(t+e)/(t-e),c=(r+o)/(r-o),p=-(i+n)/(i-n),u=-2*i*n/(i-n);return a[0]=s,a[4]=0,a[8]=$,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=p,a[14]=u,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,r,o,n,i){const a=this.elements,s=1/(t-e),l=1/(r-o),$=1/(i-n),c=(t+e)*s,p=(r+o)*l,u=(i+n)*$;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-p,a[2]=0,a[6]=0,a[10]=-2*$,a[14]=-u,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){const t=this.elements,r=e.elements;for(let o=0;o<16;o++)if(t[o]!==r[o])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}});const Ml=new na,Nl=new Ka;function Te(e=0,t=0,r=0,o=Te.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=o}function mk(){this.mask=1}Te.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Te.DefaultOrder="XYZ",Object.defineProperties(Te.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(Te.prototype,{isEuler:!0,set:function(e,t,r,o){return this._x=e,this._y=t,this._z=r,this._order=o||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){const o=ma.clamp,n=e.elements,i=n[0],a=n[4],s=n[8],l=n[1],$=n[5],c=n[9],p=n[2],u=n[6],h=n[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(o(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(u,$),this._z=0);break;case"YXZ":this._x=Math.asin(-o(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,h),this._z=Math.atan2(l,$)):(this._y=Math.atan2(-p,i),this._z=0);break;case"ZXY":this._x=Math.asin(o(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-p,h),this._z=Math.atan2(-a,$)):(this._y=0,this._z=Math.atan2(l,i));break;case"ZYX":this._y=Math.asin(-o(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(u,h),this._z=Math.atan2(l,i)):(this._x=0,this._z=Math.atan2(-a,$));break;case"YZX":this._z=Math.asin(o(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,$),this._y=Math.atan2(-p,i)):(this._x=0,this._y=Math.atan2(s,h));break;case"XZY":this._z=Math.asin(-o(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(u,$),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t);}return this._order=t,!1!==r&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,r){return Ml.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ml,t,r)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return Nl.setFromEuler(this),this.setFromQuaternion(Nl,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new aa(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(mk.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});let yy=0;const Rl=new aa,ud=new Ka,gc=new na,Gh=new aa,mg=new aa,vy=new aa,ty=new Ka,Yl=new aa(1,0,0),Zl=new aa(0,1,0),$l=new aa(0,0,1),sy={type:"added"},ry={type:"removed"};function da(){Object.defineProperty(this,"id",{value:yy++}),this.uuid=ma.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=da.DefaultUp.clone();const e=new aa,t=new Te,r=new Ka,o=new aa(1,1,1);t._onChange(function(){r.setFromEuler(t,!1)}),r._onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new na},normalMatrix:{value:new Xa}}),this.matrix=new na,this.matrixWorld=new na,this.matrixAutoUpdate=da.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new mk,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Ye(){da.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}da.DefaultUp=new aa(0,1,0),da.DefaultMatrixAutoUpdate=!0,da.prototype=Object.assign(Object.create(oc.prototype),{constructor:da,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return ud.setFromAxisAngle(e,t),this.quaternion.multiply(ud),this},rotateOnWorldAxis:function(e,t){return ud.setFromAxisAngle(e,t),this.quaternion.premultiply(ud),this},rotateX:function(e){return this.rotateOnAxis(Yl,e)},rotateY:function(e){return this.rotateOnAxis(Zl,e)},rotateZ:function(e){return this.rotateOnAxis($l,e)},translateOnAxis:function(e,t){return Rl.copy(e).applyQuaternion(this.quaternion),this.position.add(Rl.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Yl,e)},translateY:function(e){return this.translateOnAxis(Zl,e)},translateZ:function(e){return this.translateOnAxis($l,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(gc.getInverse(this.matrixWorld))},lookAt:function(e,t,r){e.isVector3?Gh.copy(e):Gh.set(e,t,r);const o=this.parent;this.updateWorldMatrix(!0,!1),mg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?gc.lookAt(mg,Gh,this.up):gc.lookAt(Gh,mg,this.up),this.quaternion.setFromRotationMatrix(gc),o&&(gc.extractRotation(o.matrixWorld),ud.setFromRotationMatrix(gc),this.quaternion.premultiply(ud.inverse()))},add:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(sy)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ry)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),gc.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),gc.multiply(e.parent.matrixWorld)),e.applyMatrix4(gc),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(let r=0,o=this.children.length;r<o;r++){const o=this.children[r].getObjectByProperty(e,t);if(void 0!==o)return o}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new aa),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Ka),this.updateMatrixWorld(!0),this.matrixWorld.decompose(mg,e,vy),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new aa),this.updateMatrixWorld(!0),this.matrixWorld.decompose(mg,ty,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new aa),this.updateMatrixWorld(!0);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);const t=this.children;for(let r=0,o=t.length;r<o;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1===this.visible)return;e(this);const t=this.children;for(let r=0,o=t.length;r<o;r++)t[r].traverseVisible(e)},traverseAncestors:function(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,o=t.length;r<o;r++)t[r].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){const r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].updateWorldMatrix(!1,!0)}},toJSON:function(e){const t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const o={};function n(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){o.geometry=n(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const r=t.shapes;if(Array.isArray(r))for(let t=0,o=r.length;t<o;t++){const o=r[t];n(e.shapes,o)}else n(e.shapes,r)}}if(void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let r=0,o=this.material.length;r<o;r++)t.push(n(e.materials,this.material[r]));o.material=t}else o.material=n(e.materials,this.material);if(this.children.length>0){o.children=[];for(let t=0;t<this.children.length;t++)o.children.push(this.children[t].toJSON(e).object)}if(t){const t=i(e.geometries),o=i(e.materials),n=i(e.textures),a=i(e.images),s=i(e.shapes);t.length>0&&(r.geometries=t),o.length>0&&(r.materials=o),n.length>0&&(r.textures=n),a.length>0&&(r.images=a),s.length>0&&(r.shapes=s)}return r.object=o,r;function i(e){const t=[];for(const r in e){const o=e[r];delete o.metadata,t.push(o)}return t}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let r=0;r<e.children.length;r++){const t=e.children[r];this.add(t.clone())}return this}}),Ye.prototype=Object.assign(Object.create(da.prototype),{constructor:Ye,isScene:!0,copy:function(e,t){return da.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){const t=da.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});const fc=[new aa,new aa,new aa,new aa,new aa,new aa,new aa,new aa],af=new aa,dk=new Tb,Bd=new aa,Cd=new aa,Dd=new aa,Pc=new aa,yc=new aa,bd=new aa,Mf=new aa,lh=new aa,fi=new aa,ed=new aa;function Tb(e,t){this.min=void 0!==e?e:new aa(1/0,1/0,1/0),this.max=void 0!==t?t:new aa(-1/0,-1/0,-1/0)}function yj(e,t,r,o,n){for(let i=0,a=e.length-3;i<=a;i+=3){ed.fromArray(e,i);const a=n.x*Math.abs(ed.x)+n.y*Math.abs(ed.y)+n.z*Math.abs(ed.z),s=t.dot(ed),l=r.dot(ed),$=o.dot(ed);if(Math.max(-Math.max(s,l,$),Math.min(s,l,$))>a)return!1}return!0}Object.assign(Tb.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){let t=1/0,r=1/0,o=1/0,n=-1/0,i=-1/0,a=-1/0;for(let s=0,l=e.length;s<l;s+=3){const l=e[s],$=e[s+1],c=e[s+2];l<t&&(t=l),$<r&&(r=$),c<o&&(o=c),l>n&&(n=l),$>i&&(i=$),c>a&&(a=c)}return this.min.set(t,r,o),this.max.set(n,i,a),this},setFromBufferAttribute:function(e){let t=1/0,r=1/0,o=1/0,n=-1/0,i=-1/0,a=-1/0;for(let s=0,l=e.count;s<l;s++){const l=e.getX(s),$=e.getY(s),c=e.getZ(s);l<t&&(t=l),$<r&&(r=$),c<o&&(o=c),l>n&&(n=l),$>i&&(i=$),c>a&&(a=c)}return this.min.set(t,r,o),this.max.set(n,i,a),this},setFromPoints:function(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){const r=af.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new aa),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new aa),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),dk.copy(t.boundingBox),dk.applyMatrix4(e.matrixWorld),this.union(dk));const r=e.children;for(let o=0,n=r.length;o<n;o++)this.expandByObject(r[o]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new aa),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,af),af.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(Mf),lh.subVectors(this.max,Mf),Bd.subVectors(e.a,Mf),Cd.subVectors(e.b,Mf),Dd.subVectors(e.c,Mf),Pc.subVectors(Cd,Bd),yc.subVectors(Dd,Cd),bd.subVectors(Bd,Dd);let t=[0,-Pc.z,Pc.y,0,-yc.z,yc.y,0,-bd.z,bd.y,Pc.z,0,-Pc.x,yc.z,0,-yc.x,bd.z,0,-bd.x,-Pc.y,Pc.x,0,-yc.y,yc.x,0,-bd.y,bd.x,0];return!!yj(t,Bd,Cd,Dd,lh)&&!!yj(t=[1,0,0,0,1,0,0,0,1],Bd,Cd,Dd,lh)&&(fi.crossVectors(Pc,yc),yj(t=[fi.x,fi.y,fi.z],Bd,Cd,Dd,lh))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new aa),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return af.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(af).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(fc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),fc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),fc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),fc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),fc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),fc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),fc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),fc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(fc),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});const Sx=new Tb;function _b(e,t){this.center=void 0!==e?e:new aa,this.radius=void 0!==t?t:-1}Object.assign(_b.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){const r=this.center;void 0!==t?r.copy(t):Sx.setFromPoints(e).getCenter(r);let o=0;for(let n=0,i=e.length;n<i;n++)o=Math.max(o,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){const r=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new aa),t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Tb),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});const rc=new aa,tj=new aa,Yg=new aa,Nc=new aa,pj=new aa,Vg=new aa,mj=new aa;function Nd(e,t){this.origin=void 0!==e?e:new aa,this.direction=void 0!==t?t:new aa(0,0,-1)}Object.assign(Nd.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new aa),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,rc)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new aa),t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){const t=rc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(rc.copy(this.direction).multiplyScalar(t).add(this.origin),rc.distanceToSquared(e))},distanceSqToSegment:function(e,t,r,o){tj.copy(e).add(t).multiplyScalar(.5),Yg.copy(t).sub(e).normalize(),Nc.copy(this.origin).sub(tj);const n=.5*e.distanceTo(t),i=-this.direction.dot(Yg),a=Nc.dot(this.direction),s=-Nc.dot(Yg),l=Nc.lengthSq(),$=Math.abs(1-i*i);let c,p,u,h;if($>0){if(p=i*a-s,h=n*$,(c=i*s-a)>=0){if(p>=-h){if(p<=h){const e=1/$;u=(c*=e)*(c+i*(p*=e)+2*a)+p*(i*c+p+2*s)+l}else p=n,u=-(c=Math.max(0,-(i*p+a)))*c+p*(p+2*s)+l;}else p=-n,u=-(c=Math.max(0,-(i*p+a)))*c+p*(p+2*s)+l;}else p<=-h?u=-(c=Math.max(0,-(-i*n+a)))*c+(p=c>0?-n:Math.min(Math.max(-n,-s),n))*(p+2*s)+l:p<=h?(c=0,u=(p=Math.min(Math.max(-n,-s),n))*(p+2*s)+l):u=-(c=Math.max(0,-(i*n+a)))*c+(p=c>0?n:Math.min(Math.max(-n,-s),n))*(p+2*s)+l;}else p=i>0?-n:n,u=-(c=Math.max(0,-(i*p+a)))*c+p*(p+2*s)+l;return r&&r.copy(this.direction).multiplyScalar(c).add(this.origin),o&&o.copy(Yg).multiplyScalar(p).add(tj),u},intersectSphere:function(e,t){rc.subVectors(e.center,this.origin);const r=rc.dot(this.direction),o=rc.dot(rc)-r*r,n=e.radius*e.radius;if(o>n)return null;const i=Math.sqrt(n-o),a=r-i,s=r+i;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){let r,o,n,i,a,s;const l=1/this.direction.x,$=1/this.direction.y,c=1/this.direction.z,p=this.origin;return l>=0?(r=(e.min.x-p.x)*l,o=(e.max.x-p.x)*l):(r=(e.max.x-p.x)*l,o=(e.min.x-p.x)*l),$>=0?(n=(e.min.y-p.y)*$,i=(e.max.y-p.y)*$):(n=(e.max.y-p.y)*$,i=(e.min.y-p.y)*$),r>i||n>o?null:((n>r||r!=r)&&(r=n),(i<o||o!=o)&&(o=i),c>=0?(a=(e.min.z-p.z)*c,s=(e.max.z-p.z)*c):(a=(e.max.z-p.z)*c,s=(e.min.z-p.z)*c),r>s||a>o?null:((a>r||r!=r)&&(r=a),(s<o||o!=o)&&(o=s),o<0?null:this.at(r>=0?r:o,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,rc)},intersectTriangle:function(e,t,r,o,n){pj.subVectors(t,e),Vg.subVectors(r,e),mj.crossVectors(pj,Vg);let i,a=this.direction.dot(mj);if(a>0){if(o)return null;i=1}else{if(!(a<0))return null;i=-1,a=-a}Nc.subVectors(this.origin,e);const s=i*this.direction.dot(Vg.crossVectors(Nc,Vg));if(s<0)return null;const l=i*this.direction.dot(pj.cross(Nc));if(l<0)return null;if(s+l>a)return null;const $=-i*Nc.dot(mj);return $<0?null:this.at($/a,n)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});const kj=new aa,xx=new aa,wx=new Xa;function Pb(e,t){this.normal=void 0!==e?e:new aa(1,0,0),this.constant=void 0!==t?t:0}Object.assign(Pb.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,o){return this.normal.set(e,t,r),this.constant=o,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,r){const o=kj.subVectors(r,t).cross(xx.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new aa),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new aa);const r=e.delta(kj),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;const n=-(e.start.dot(this.normal)+this.constant)/o;return n<0||n>1?void 0:t.copy(r).multiplyScalar(n).add(e.start)},intersectsLine:function(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new aa),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){const r=t||wx.getNormalMatrix(e),o=this.coplanarPoint(kj).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-o.dot(n),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});const Fb=new aa,jc=new aa,fj=new aa,ic=new aa,Rd=new aa,Sd=new aa,Mm=new aa,bj=new aa,aj=new aa,_i=new aa;function Qa(e,t,r){this.a=void 0!==e?e:new aa,this.b=void 0!==t?t:new aa,this.c=void 0!==r?r:new aa}Object.assign(Qa,{getNormal:function(e,t,r,o){void 0===o&&(console.warn("THREE.Triangle: .getNormal() target is now required"),o=new aa),o.subVectors(r,t),Fb.subVectors(e,t),o.cross(Fb);const n=o.lengthSq();return n>0?o.multiplyScalar(1/Math.sqrt(n)):o.set(0,0,0)},getBarycoord:function(e,t,r,o,n){Fb.subVectors(o,t),jc.subVectors(r,t),fj.subVectors(e,t);const i=Fb.dot(Fb),a=Fb.dot(jc),s=Fb.dot(fj),l=jc.dot(jc),$=jc.dot(fj),c=i*l-a*a;if(void 0===n&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),n=new aa),0===c)return n.set(-2,-1,-1);const p=1/c,u=(l*s-a*$)*p,h=(i*$-a*s)*p;return n.set(1-u-h,h,u)},containsPoint:function(e,t,r,o){return Qa.getBarycoord(e,t,r,o,ic),ic.x>=0&&ic.y>=0&&ic.x+ic.y<=1},getUV:function(e,t,r,o,n,i,a,s){return this.getBarycoord(e,t,r,o,ic),s.set(0,0),s.addScaledVector(n,ic.x),s.addScaledVector(i,ic.y),s.addScaledVector(a,ic.z),s},isFrontFacing:function(e,t,r,o){return Fb.subVectors(r,t),jc.subVectors(e,t),Fb.cross(jc).dot(o)<0}}),Object.assign(Qa.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,o){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[o]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return Fb.subVectors(this.c,this.b),jc.subVectors(this.a,this.b),.5*Fb.cross(jc).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new aa),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Qa.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Pb),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Qa.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,r,o,n){return Qa.getUV(e,this.a,this.b,this.c,t,r,o,n)},containsPoint:function(e){return Qa.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Qa.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new aa);const r=this.a,o=this.b,n=this.c;let i,a;Rd.subVectors(o,r),Sd.subVectors(n,r),bj.subVectors(e,r);const s=Rd.dot(bj),l=Sd.dot(bj);if(s<=0&&l<=0)return t.copy(r);aj.subVectors(e,o);const $=Rd.dot(aj),c=Sd.dot(aj);if($>=0&&c<=$)return t.copy(o);const p=s*c-$*l;if(p<=0&&s>=0&&$<=0)return i=s/(s-$),t.copy(r).addScaledVector(Rd,i);_i.subVectors(e,n);const u=Rd.dot(_i),h=Sd.dot(_i);if(h>=0&&u<=h)return t.copy(n);const d=u*l-s*h;if(d<=0&&l>=0&&h<=0)return a=l/(l-h),t.copy(r).addScaledVector(Sd,a);const f=$*h-u*c;if(f<=0&&c-$>=0&&u-h>=0)return Mm.subVectors(n,o),a=(c-$)/(c-$+(u-h)),t.copy(o).addScaledVector(Mm,a);const m=1/(f+d+p);return i=d*m,a=p*m,t.copy(r).addScaledVector(Rd,i).addScaledVector(Sd,a)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});const Rm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Gb={h:0,s:0,l:0},Kg={h:0,s:0,l:0};function ha(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}function Wi(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}function Vi(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Ui(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function Hg(e,t,r,o,n,i){this.a=e,this.b=t,this.c=r,this.normal=o&&o.isVector3?o:new aa,this.vertexNormals=Array.isArray(o)?o:[],this.color=n&&n.isColor?n:new ha,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==i?i:0}Object.assign(ha.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(e,t,r){if(e=ma.euclideanModulo(e,1),t=ma.clamp(t,0,1),r=ma.clamp(r,0,1),0===t)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+t):r+t-r*t,n=2*r-o;this.r=Wi(n,o,e+1/3),this.g=Wi(n,o,e),this.b=Wi(n,o,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){let e;const o=r[1],n=r[2];switch(o){case"rgb":case"rgba":if(e=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,t(e[5]),this;if(e=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,t(e[5]),this;break;case"hsl":case"hsla":if(e=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){const r=parseFloat(e[1])/360,o=parseInt(e[2],10)/100,n=parseInt(e[3],10)/100;return t(e[5]),this.setHSL(r,o,n)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){const e=r[1],t=e.length;if(3===t)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===t)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){const t=Rm[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);const r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=Vi(e.r),this.g=Vi(e.g),this.b=Vi(e.b),this},copyLinearToSRGB:function(e){return this.r=Ui(e.r),this.g=Ui(e.g),this.b=Ui(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});const t=this.r,r=this.g,o=this.b,n=Math.max(t,r,o),i=Math.min(t,r,o);let a,s;const l=(i+n)/2;if(i===n)a=0,s=0;else{const e=n-i;switch(s=l<=.5?e/(n+i):e/(2-n-i),n){case t:a=(r-o)/e+(r<o?6:0);break;case r:a=(o-t)/e+2;break;case o:a=(t-r)/e+4;}a/=6}return e.h=a,e.s=s,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){return this.getHSL(Gb),Gb.h+=e,Gb.s+=t,Gb.l+=r,this.setHSL(Gb.h,Gb.s,Gb.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Gb),e.getHSL(Kg);const r=ma.lerp(Gb.h,Kg.h,t),o=ma.lerp(Gb.s,Kg.s,t),n=ma.lerp(Gb.l,Kg.l,t);return this.setHSL(r,o,n),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},fromBufferAttribute:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),ha.NAMES=Rm,Object.assign(Hg.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});let ax=0;function ja(){Object.defineProperty(this,"id",{value:ax++}),this.uuid=ma.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Sf,this.side=Wf,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Qm,this.blendDst=Pm,this.blendEquation=Ee,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ij,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Nz,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Jk,this.stencilZFail=Jk,this.stencilZPass=Jk,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Ib(e){ja.call(this),this.type="MeshBasicMaterial",this.color=new ha(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ug,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}ja.prototype=Object.assign(Object.create(oc.prototype),{constructor:ja,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;continue}const o=this[t];void 0!==o?o&&o.isColor?o.set(r):o&&o.isVector3&&r&&r.isVector3?o.copy(r):this[t]=r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}},toJSON:function(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function o(e){const t=[];for(const r in e){const o=e[r];delete o.metadata,t.push(o)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(r.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,r.reflectivity=this.reflectivity,r.refractionRatio=this.refractionRatio,void 0!==this.combine&&(r.combine=this.combine),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Sf&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==Wf&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.morphNormals&&(r.morphNormals=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){const t=o(e.textures),n=o(e.images);t.length>0&&(r.textures=t),n.length>0&&(r.images=n)}return r},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const e=t.length;r=new Array(e);for(let o=0;o!==e;++o)r[o]=t[o].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ja.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Ib.prototype=Object.create(ja.prototype),Ib.prototype.constructor=Ib,Ib.prototype.isMeshBasicMaterial=!0,Ib.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};const wa=new aa,xg=new ca;function ka(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0}function Gi(e,t,r){ka.call(this,new Int8Array(e),t,r)}function Fi(e,t,r){ka.call(this,new Uint8Array(e),t,r)}function Ei(e,t,r){ka.call(this,new Uint8ClampedArray(e),t,r)}function Di(e,t,r){ka.call(this,new Int16Array(e),t,r)}function $f(e,t,r){ka.call(this,new Uint16Array(e),t,r)}function Bi(e,t,r){ka.call(this,new Int32Array(e),t,r)}function dg(e,t,r){ka.call(this,new Uint32Array(e),t,r)}function ea(e,t,r){ka.call(this,new Float32Array(e),t,r)}function wi(e,t,r){ka.call(this,new Float64Array(e),t,r)}function nn(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function on(e){if(0===e.length)return-1/0;let t=e[0];for(let r=1,o=e.length;r<o;++r)e[r]>t&&(t=e[r]);return t}Object.defineProperty(ka.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ka.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let o=0,n=this.itemSize;o<n;o++)this.array[e+o]=t.array[r+o];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){const t=this.array;let r=0;for(let o=0,n=e.length;o<n;o++){let n=e[o];void 0===n&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",o),n=new ha),t[r++]=n.r,t[r++]=n.g,t[r++]=n.b}return this},copyVector2sArray:function(e){const t=this.array;let r=0;for(let o=0,n=e.length;o<n;o++){let n=e[o];void 0===n&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",o),n=new ca),t[r++]=n.x,t[r++]=n.y}return this},copyVector3sArray:function(e){const t=this.array;let r=0;for(let o=0,n=e.length;o<n;o++){let n=e[o];void 0===n&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",o),n=new aa),t[r++]=n.x,t[r++]=n.y,t[r++]=n.z}return this},copyVector4sArray:function(e){const t=this.array;let r=0;for(let o=0,n=e.length;o<n;o++){let n=e[o];void 0===n&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",o),n=new sa),t[r++]=n.x,t[r++]=n.y,t[r++]=n.z,t[r++]=n.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)xg.fromBufferAttribute(this,t),xg.applyMatrix3(e),this.setXY(t,xg.x,xg.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)wa.fromBufferAttribute(this,t),wa.applyMatrix3(e),this.setXYZ(t,wa.x,wa.y,wa.z);return this},applyMatrix4:function(e){for(let t=0,r=this.count;t<r;t++)wa.x=this.getX(t),wa.y=this.getY(t),wa.z=this.getZ(t),wa.applyMatrix4(e),this.setXYZ(t,wa.x,wa.y,wa.z);return this},applyNormalMatrix:function(e){for(let t=0,r=this.count;t<r;t++)wa.x=this.getX(t),wa.y=this.getY(t),wa.z=this.getZ(t),wa.applyNormalMatrix(e),this.setXYZ(t,wa.x,wa.y,wa.z);return this},transformDirection:function(e){for(let t=0,r=this.count;t<r;t++)wa.x=this.getX(t),wa.y=this.getY(t),wa.z=this.getZ(t),wa.transformDirection(e),this.setXYZ(t,wa.x,wa.y,wa.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,o){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=o,this},setXYZW:function(e,t,r,o,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=o,this.array[e+3]=n,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Gi.prototype=Object.create(ka.prototype),Gi.prototype.constructor=Gi,Fi.prototype=Object.create(ka.prototype),Fi.prototype.constructor=Fi,Ei.prototype=Object.create(ka.prototype),Ei.prototype.constructor=Ei,Di.prototype=Object.create(ka.prototype),Di.prototype.constructor=Di,$f.prototype=Object.create(ka.prototype),$f.prototype.constructor=$f,Bi.prototype=Object.create(ka.prototype),Bi.prototype.constructor=Bi,dg.prototype=Object.create(ka.prototype),dg.prototype.constructor=dg,ea.prototype=Object.create(ka.prototype),ea.prototype.constructor=ea,wi.prototype=Object.create(ka.prototype),wi.prototype.constructor=wi,Object.assign(nn.prototype,{computeGroups:function(e){const t=[];let r,o,n=void 0;const i=e.faces;for(o=0;o<i.length;o++){const e=i[o];e.materialIndex!==n&&(n=e.materialIndex,void 0!==r&&(r.count=3*o-r.start,t.push(r)),r={start:3*o,materialIndex:n})}void 0!==r&&(r.count=3*o-r.start,t.push(r)),this.groups=t},fromGeometry:function(e){const t=e.faces,r=e.vertices,o=e.faceVertexUvs,n=o[0]&&o[0].length>0,i=o[1]&&o[1].length>0,a=e.morphTargets,s=a.length;let l;if(s>0){l=[];for(let e=0;e<s;e++)l[e]={name:a[e].name,data:[]};this.morphTargets.position=l}const $=e.morphNormals,c=$.length;let p;if(c>0){p=[];for(let e=0;e<c;e++)p[e]={name:$[e].name,data:[]};this.morphTargets.normal=p}const u=e.skinIndices,h=e.skinWeights,d=u.length===r.length,f=h.length===r.length;r.length>0&&0===t.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let m=0;m<t.length;m++){const e=t[m];this.vertices.push(r[e.a],r[e.b],r[e.c]);const x=e.vertexNormals;if(3===x.length)this.normals.push(x[0],x[1],x[2]);else{const t=e.normal;this.normals.push(t,t,t)}const g=e.vertexColors;if(3===g.length)this.colors.push(g[0],g[1],g[2]);else{const t=e.color;this.colors.push(t,t,t)}if(!0===n){const e=o[0][m];void 0!==e?this.uvs.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new ca,new ca,new ca))}if(!0===i){const e=o[1][m];void 0!==e?this.uvs2.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new ca,new ca,new ca))}for(let t=0;t<s;t++){const r=a[t].vertices;l[t].data.push(r[e.a],r[e.b],r[e.c])}for(let t=0;t<c;t++){const e=$[t].vertexNormals[m];p[t].data.push(e.a,e.b,e.c)}d&&this.skinIndices.push(u[e.a],u[e.b],u[e.c]),f&&this.skinWeights.push(h[e.a],h[e.b],h[e.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});const Sb=new na,ui=new da,Pe=new aa,ib=new Tb,hg=new Tb,La=new aa;function ga(){Object.defineProperty(this,"id",{value:2}),this.uuid=ma.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}ga.prototype=Object.assign(Object.create(oc.prototype),{constructor:ga,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(on(e)>65535?dg:$f)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const t=new Xa().getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}const o=this.attributes.tangent;return void 0!==o&&(o.transformDirection(e),o.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return Sb.makeRotationX(e),this.applyMatrix4(Sb),this},rotateY:function(e){return Sb.makeRotationY(e),this.applyMatrix4(Sb),this},rotateZ:function(e){return Sb.makeRotationZ(e),this.applyMatrix4(Sb),this},translate:function(e,t,r){return Sb.makeTranslation(e,t,r),this.applyMatrix4(Sb),this},scale:function(e,t,r){return Sb.makeScale(e,t,r),this.applyMatrix4(Sb),this},lookAt:function(e){return ui.lookAt(e),ui.updateMatrix(),this.applyMatrix4(ui.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Pe).negate(),this.translate(Pe.x,Pe.y,Pe.z),this},setFromObject:function(e){const t=e.geometry;if(e.isPoints||e.isLine){const e=new ea(3*t.vertices.length,3),r=new ea(3*t.colors.length,3);if(this.setAttribute("position",e.copyVector3sArray(t.vertices)),this.setAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){const e=new ea(t.lineDistances.length,1);this.setAttribute("lineDistance",e.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){const t=[];for(let r=0,o=e.length;r<o;r++){const o=e[r];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new ea(t,3)),this},updateFromObject:function(e){let t=e.geometry;if(e.isMesh){let e=t.__directGeometry;if(!0===t.elementsNeedUpdate&&(e=void 0,t.elementsNeedUpdate=!1),void 0===e)return this.fromGeometry(t);e.verticesNeedUpdate=t.verticesNeedUpdate,e.normalsNeedUpdate=t.normalsNeedUpdate,e.colorsNeedUpdate=t.colorsNeedUpdate,e.uvsNeedUpdate=t.uvsNeedUpdate,e.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=e}if(!0===t.verticesNeedUpdate){const e=this.attributes.position;void 0!==e&&(e.copyVector3sArray(t.vertices),e.needsUpdate=!0),t.verticesNeedUpdate=!1}if(!0===t.normalsNeedUpdate){const e=this.attributes.normal;void 0!==e&&(e.copyVector3sArray(t.normals),e.needsUpdate=!0),t.normalsNeedUpdate=!1}if(!0===t.colorsNeedUpdate){const e=this.attributes.color;void 0!==e&&(e.copyColorsArray(t.colors),e.needsUpdate=!0),t.colorsNeedUpdate=!1}if(t.uvsNeedUpdate){const e=this.attributes.uv;void 0!==e&&(e.copyVector2sArray(t.uvs),e.needsUpdate=!0),t.uvsNeedUpdate=!1}if(t.lineDistancesNeedUpdate){const e=this.attributes.lineDistance;void 0!==e&&(e.copyArray(t.lineDistances),e.needsUpdate=!0),t.lineDistancesNeedUpdate=!1}return t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new nn().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){const t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new ka(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){const t=new Float32Array(3*e.normals.length);this.setAttribute("normal",new ka(t,3).copyVector3sArray(e.normals))}if(e.colors.length>0){const t=new Float32Array(3*e.colors.length);this.setAttribute("color",new ka(t,3).copyColorsArray(e.colors))}if(e.uvs.length>0){const t=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new ka(t,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){const t=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new ka(t,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(const r in e.morphTargets){const t=[],o=e.morphTargets[r];for(let e=0,r=o.length;e<r;e++){const r=o[e],n=new ea(3*r.data.length,3);n.name=r.name,t.push(n.copyVector3sArray(r.data))}this.morphAttributes[r]=t}if(e.skinIndices.length>0){const t=new ea(4*e.skinIndices.length,4);this.setAttribute("skinIndex",t.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){const t=new ea(4*e.skinWeights.length,4);this.setAttribute("skinWeight",t.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Tb);const e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const e=t[r];ib.setFromBufferAttribute(e),this.morphTargetsRelative?(La.addVectors(this.boundingBox.min,ib.min),this.boundingBox.expandByPoint(La),La.addVectors(this.boundingBox.max,ib.max),this.boundingBox.expandByPoint(La)):(this.boundingBox.expandByPoint(ib.min),this.boundingBox.expandByPoint(ib.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error("THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.",this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new _b);const e=this.attributes.position,t=this.morphAttributes.position;if(e){const r=this.boundingSphere.center;if(ib.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const r=t[e];hg.setFromBufferAttribute(r),this.morphTargetsRelative?(La.addVectors(ib.min,hg.min),ib.expandByPoint(La),La.addVectors(ib.max,hg.max),ib.expandByPoint(La)):(ib.expandByPoint(hg.min),ib.expandByPoint(hg.max))}ib.getCenter(r);let o=0;for(let t=0,n=e.count;t<n;t++)La.fromBufferAttribute(e,t),o=Math.max(o,r.distanceToSquared(La));if(t)for(let n=0,i=t.length;n<i;n++){const i=t[n],a=this.morphTargetsRelative;for(let t=0,n=i.count;t<n;t++)La.fromBufferAttribute(i,t),a&&(Pe.fromBufferAttribute(e,t),La.add(Pe)),o=Math.max(o,r.distanceToSquared(La))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error("THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.",this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new ka(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);const o=new aa,n=new aa,i=new aa,a=new aa,s=new aa,l=new aa,$=new aa,c=new aa;if(e)for(let p=0,u=e.count;p<u;p+=3){const u=e.getX(p+0),h=e.getX(p+1),d=e.getX(p+2);o.fromBufferAttribute(t,u),n.fromBufferAttribute(t,h),i.fromBufferAttribute(t,d),$.subVectors(i,n),c.subVectors(o,n),$.cross(c),a.fromBufferAttribute(r,u),s.fromBufferAttribute(r,h),l.fromBufferAttribute(r,d),a.add($),s.add($),l.add($),r.setXYZ(u,a.x,a.y,a.z),r.setXYZ(h,s.x,s.y,s.z),r.setXYZ(d,l.x,l.y,l.z)}else for(let e=0,p=t.count;e<p;e+=3)o.fromBufferAttribute(t,e+0),n.fromBufferAttribute(t,e+1),i.fromBufferAttribute(t,e+2),$.subVectors(i,n),c.subVectors(o,n),$.cross(c),r.setXYZ(e+0,$.x,$.y,$.z),r.setXYZ(e+1,$.x,$.y,$.z),r.setXYZ(e+2,$.x,$.y,$.z);this.normalizeNormals(),r.needsUpdate=!0}},merge:function(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const r=this.attributes;for(const o in r){if(void 0===e.attributes[o])continue;const n=r[o].array,i=e.attributes[o],a=i.array,s=i.itemSize*t,l=Math.min(a.length,n.length-s);for(let e=0,t=s;e<l;e++,t++)n[t]=a[e]}return this},normalizeNormals:function(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)La.fromBufferAttribute(e,t),La.normalize(),e.setXYZ(t,La.x,La.y,La.z)},toNonIndexed:function(){function e(e,t){const r=e.array,o=e.itemSize,n=e.normalized,i=new r.constructor(t.length*o);let a=0,s=0;for(let l=0,$=t.length;l<$;l++){a=t[l]*o;for(let e=0;e<o;e++)i[s++]=r[a++]}return new ka(i,o,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const t=new ga,r=this.index.array,o=this.attributes;for(const a in o){const n=e(o[a],r);t.setAttribute(a,n)}const n=this.morphAttributes;for(const a in n){const o=[],i=n[a];for(let t=0,n=i.length;t<n;t++){const n=e(i[t],r);o.push(n)}t.morphAttributes[a]=o}t.morphTargetsRelative=this.morphTargetsRelative;const i=this.groups;for(let a=0,s=i.length;a<s;a++){const e=i[a];t.addGroup(e.start,e.count,e.materialIndex)}return t},toJSON:function(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const s in r){const t=r[s],o=t.toJSON(e.data);""!==t.name&&(o.name=t.name),e.data.attributes[s]=o}const o={};let n=!1;for(const s in this.morphAttributes){const t=this.morphAttributes[s],r=[];for(let o=0,n=t.length;o<n;o++){const n=t[o],i=n.toJSON(e.data);""!==n.name&&(i.name=n.name),r.push(i)}r.length>0&&(o[s]=r,n=!0)}n&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const i=this.groups;i.length>0&&(e.data.groups=JSON.parse(JSON.stringify(i)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e},clone:function(){return new ga().copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const o=e.attributes;for(const l in o){const e=o[l];this.setAttribute(l,e.clone(t))}const n=e.morphAttributes;for(const l in n){const e=[],r=n[l];for(let o=0,n=r.length;o<n;o++)e.push(r[o].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const i=e.groups;for(let l=0,$=i.length;l<$;l++){const e=i[l];this.addGroup(e.start,e.count,e.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const wn=new na,sd=new Nd,mi=new _b,Mc=new aa,Rc=new aa,Tc=new aa,hi=new aa,gi=new aa,Qk=new aa,jh=new aa,rg=new aa,tg=new aa,Ne=new ca,Me=new ca,Le=new ca,_f=new aa,vg=new aa;function ua(e,t){da.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new ga,this.material=void 0!==t?t:new Ib,this.updateMorphTargets()}function On(e,t,r,o,n,i,a,s){let l;if(null===(l=t.side===Oa?o.intersectTriangle(a,i,n,!0,s):o.intersectTriangle(n,i,a,t.side!==Bg,s)))return null;vg.copy(s),vg.applyMatrix4(e.matrixWorld);const $=r.ray.origin.distanceTo(vg);return $<r.near||$>r.far?null:{distance:$,point:vg.clone(),object:e}}function yg(e,t,r,o,n,i,a,s,l,$,c,p){Mc.fromBufferAttribute(n,$),Rc.fromBufferAttribute(n,c),Tc.fromBufferAttribute(n,p);const u=e.morphTargetInfluences;if(t.morphTargets&&i&&u){jh.set(0,0,0),rg.set(0,0,0),tg.set(0,0,0);for(let e=0,t=i.length;e<t;e++){const t=u[e],r=i[e];0!==t&&(hi.fromBufferAttribute(r,$),gi.fromBufferAttribute(r,c),Qk.fromBufferAttribute(r,p),a?(jh.addScaledVector(hi,t),rg.addScaledVector(gi,t),tg.addScaledVector(Qk,t)):(jh.addScaledVector(hi.sub(Mc),t),rg.addScaledVector(gi.sub(Rc),t),tg.addScaledVector(Qk.sub(Tc),t)))}Mc.add(jh),Rc.add(rg),Tc.add(tg)}e.isSkinnedMesh&&(e.boneTransform($,Mc),e.boneTransform(c,Rc),e.boneTransform(p,Tc));const h=On(e,t,r,o,Mc,Rc,Tc,_f);if(h){s&&(Ne.fromBufferAttribute(s,$),Me.fromBufferAttribute(s,c),Le.fromBufferAttribute(s,p),h.uv=Qa.getUV(_f,Mc,Rc,Tc,Ne,Me,Le,new ca)),l&&(Ne.fromBufferAttribute(l,$),Me.fromBufferAttribute(l,c),Le.fromBufferAttribute(l,p),h.uv2=Qa.getUV(_f,Mc,Rc,Tc,Ne,Me,Le,new ca));const e=new Hg($,c,p);Qa.getNormal(Mc,Rc,Tc,e.normal),h.face=e}return h}ua.prototype=Object.assign(Object.create(da.prototype),{constructor:ua,isMesh:!0,copy:function(e){return da.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){const r=this.geometry,o=this.material,n=this.matrixWorld;if(void 0===o)return;if(null===r.boundingSphere&&r.computeBoundingSphere(),mi.copy(r.boundingSphere),mi.applyMatrix4(n),!1===e.ray.intersectsSphere(mi))return;if(wn.getInverse(n),sd.copy(e.ray).applyMatrix4(wn),null!==r.boundingBox&&!1===sd.intersectsBox(r.boundingBox))return;let i;if(r.isBufferGeometry){const n=r.index,a=r.attributes.position,s=r.morphAttributes.position,l=r.morphTargetsRelative,$=r.attributes.uv,c=r.attributes.uv2,p=r.groups,u=r.drawRange;if(null!==n){if(Array.isArray(o))for(let r=0,h=p.length;r<h;r++){const h=p[r],d=o[h.materialIndex];for(let r=Math.max(h.start,u.start),o=Math.min(h.start+h.count,u.start+u.count);r<o;r+=3){const o=n.getX(r),p=n.getX(r+1),u=n.getX(r+2);(i=yg(this,d,e,sd,a,s,l,$,c,o,p,u))&&(i.faceIndex=Math.floor(r/3),i.face.materialIndex=h.materialIndex,t.push(i))}}else{for(let r=Math.max(0,u.start),p=Math.min(n.count,u.start+u.count);r<p;r+=3){const p=n.getX(r),u=n.getX(r+1),h=n.getX(r+2);(i=yg(this,o,e,sd,a,s,l,$,c,p,u,h))&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}else if(void 0!==a)if(Array.isArray(o))for(let r=0,h=p.length;r<h;r++){const n=p[r],h=o[n.materialIndex];for(let r=Math.max(n.start,u.start),o=Math.min(n.start+n.count,u.start+u.count);r<o;r+=3){(i=yg(this,h,e,sd,a,s,l,$,c,r,r+1,r+2))&&(i.faceIndex=Math.floor(r/3),i.face.materialIndex=n.materialIndex,t.push(i))}}else{for(let r=Math.max(0,u.start),n=Math.min(a.count,u.start+u.count);r<n;r+=3){(i=yg(this,o,e,sd,a,s,l,$,c,r,r+1,r+2))&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}else if(r.isGeometry){const n=Array.isArray(o),a=r.vertices,s=r.faces;let l;const $=r.faceVertexUvs[0];$.length>0&&(l=$);for(let r=0,c=s.length;r<c;r++){const $=s[r],c=n?o[$.materialIndex]:o;if(void 0===c)continue;const p=a[$.a],u=a[$.b],h=a[$.c];if(i=On(this,c,e,sd,p,u,h,_f)){if(l&&l[r]){const e=l[r];Ne.copy(e[0]),Me.copy(e[1]),Le.copy(e[2]),i.uv=Qa.getUV(_f,p,u,h,Ne,Me,Le,new ca)}i.face=$,i.faceIndex=r,t.push(i)}}}}});const Ob=new na,yk=new da,zg=new aa;function la(){Object.defineProperty(this,"id",{value:2}),this.uuid=ma.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}la.prototype=Object.assign(Object.create(oc.prototype),{constructor:la,isGeometry:!0,applyMatrix4:function(e){const t=new Xa().getNormalMatrix(e);for(let r=0,o=this.vertices.length;r<o;r++){this.vertices[r].applyMatrix4(e)}for(let r=0,o=this.faces.length;r<o;r++){const e=this.faces[r];e.normal.applyMatrix3(t).normalize();for(let r=0,o=e.vertexNormals.length;r<o;r++)e.vertexNormals[r].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return Ob.makeRotationX(e),this.applyMatrix4(Ob),this},rotateY:function(e){return Ob.makeRotationY(e),this.applyMatrix4(Ob),this},rotateZ:function(e){return Ob.makeRotationZ(e),this.applyMatrix4(Ob),this},translate:function(e,t,r){return Ob.makeTranslation(e,t,r),this.applyMatrix4(Ob),this},scale:function(e,t,r){return Ob.makeScale(e,t,r),this.applyMatrix4(Ob),this},lookAt:function(e){return yk.lookAt(e),yk.updateMatrix(),this.applyMatrix4(yk.matrix),this},fromBufferGeometry:function(e){const t=this,r=null!==e.index?e.index:void 0,o=e.attributes;if(void 0===o.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const n=o.position,i=o.normal,a=o.color,s=o.uv,l=o.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(let p=0;p<n.count;p++)t.vertices.push(new aa().fromBufferAttribute(n,p)),void 0!==a&&t.colors.push(new ha().fromBufferAttribute(a,p));function $(e,r,o,n){const $=void 0===a?[]:[t.colors[e].clone(),t.colors[r].clone(),t.colors[o].clone()],c=new Hg(e,r,o,void 0===i?[]:[new aa().fromBufferAttribute(i,e),new aa().fromBufferAttribute(i,r),new aa().fromBufferAttribute(i,o)],$,n);t.faces.push(c),void 0!==s&&t.faceVertexUvs[0].push([new ca().fromBufferAttribute(s,e),new ca().fromBufferAttribute(s,r),new ca().fromBufferAttribute(s,o)]),void 0!==l&&t.faceVertexUvs[1].push([new ca().fromBufferAttribute(l,e),new ca().fromBufferAttribute(l,r),new ca().fromBufferAttribute(l,o)])}const c=e.groups;if(c.length>0)for(let p=0;p<c.length;p++){const e=c[p],t=e.start;for(let o=t,n=t+e.count;o<n;o+=3)void 0!==r?$(r.getX(o),r.getX(o+1),r.getX(o+2),e.materialIndex):$(o,o+1,o+2,e.materialIndex)}else if(void 0!==r)for(let p=0;p<r.count;p+=3)$(r.getX(p),r.getX(p+1),r.getX(p+2));else for(let p=0;p<n.count;p+=3)$(p,p+1,p+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(zg).negate(),this.translate(zg.x,zg.y,zg.z),this},normalize:function(){this.computeBoundingSphere();const e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,o=new na;return o.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(o),this},computeFaceNormals:function(){const e=new aa,t=new aa;for(let r=0,o=this.faces.length;r<o;r++){const o=this.faces[r],n=this.vertices[o.a],i=this.vertices[o.b],a=this.vertices[o.c];e.subVectors(a,i),t.subVectors(n,i),e.cross(t),e.normalize(),o.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=!0);const t=new Array(this.vertices.length);for(let r=0,o=this.vertices.length;r<o;r++)t[r]=new aa;if(e){const e=new aa,r=new aa;for(let o=0,n=this.faces.length;o<n;o++){const n=this.faces[o],i=this.vertices[n.a],a=this.vertices[n.b],s=this.vertices[n.c];e.subVectors(s,a),r.subVectors(i,a),e.cross(r),t[n.a].add(e),t[n.b].add(e),t[n.c].add(e)}}else{this.computeFaceNormals();for(let e=0,r=this.faces.length;e<r;e++){const r=this.faces[e];t[r.a].add(r.normal),t[r.b].add(r.normal),t[r.c].add(r.normal)}}for(let r=0,o=this.vertices.length;r<o;r++)t[r].normalize();for(let r=0,o=this.faces.length;r<o;r++){const e=this.faces[r],o=e.vertexNormals;3===o.length?(o[0].copy(t[e.a]),o[1].copy(t[e.b]),o[2].copy(t[e.c])):(o[0]=t[e.a].clone(),o[1]=t[e.b].clone(),o[2]=t[e.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],r=t.vertexNormals;3===r.length?(r[0].copy(t.normal),r[1].copy(t.normal),r[2].copy(t.normal)):(r[0]=t.normal.clone(),r[1]=t.normal.clone(),r[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let t=0,r=this.faces.length;t<r;t++){const e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(let t=0,r=e.vertexNormals.length;t<r;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone()}const e=new la;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];const e=this.morphNormals[t].faceNormals,r=this.morphNormals[t].vertexNormals;for(let t=0,o=this.faces.length;t<o;t++){const t=new aa,o={a:new aa,b:new aa,c:new aa};e.push(t),r.push(o)}}const r=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],o=r.faceNormals[e],n=r.vertexNormals[e];o.copy(t.normal),n.a.copy(t.vertexNormals[0]),n.b.copy(t.vertexNormals[1]),n.c.copy(t.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){const e=this.faces[t];e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Tb),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new _b),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let o,n=this.vertices.length,i=this.vertices,a=e.vertices,s=this.faces,l=e.faces,$=this.colors,c=e.colors;void 0===r&&(r=0),void 0!==t&&(o=new Xa().getNormalMatrix(t));for(let p=0,u=a.length;p<u;p++){const e=a[p].clone();void 0!==t&&e.applyMatrix4(t),i.push(e)}for(let p=0,u=c.length;p<u;p++)$.push(c[p].clone());for(let p=0,u=l.length;p<u;p++){let e,t,i,a=l[p],$=a.vertexNormals,c=a.vertexColors;(e=new Hg(a.a+n,a.b+n,a.c+n)).normal.copy(a.normal),void 0!==o&&e.normal.applyMatrix3(o).normalize();for(let r=0,n=$.length;r<n;r++)t=$[r].clone(),void 0!==o&&t.applyMatrix3(o).normalize(),e.vertexNormals.push(t);e.color.copy(a.color);for(let r=0,o=c.length;r<o;r++)i=c[r],e.vertexColors.push(i.clone());e.materialIndex=a.materialIndex+r,s.push(e)}for(let p=0,u=e.faceVertexUvs.length;p<u;p++){const t=e.faceVertexUvs[p];void 0===this.faceVertexUvs[p]&&(this.faceVertexUvs[p]=[]);for(let e=0,r=t.length;e<r;e++){const r=t[e],o=[];for(let e=0,t=r.length;e<t;e++)o.push(r[e].clone());this.faceVertexUvs[p].push(o)}}},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){const e={},t=[],r=[],o=Math.pow(10,4);for(let a=0,s=this.vertices.length;a<s;a++){const n=this.vertices[a],i=Math.round(n.x*o)+"_"+Math.round(n.y*o)+"_"+Math.round(n.z*o);void 0===e[i]?(e[i]=a,t.push(this.vertices[a]),r[a]=t.length-1):r[a]=r[e[i]]}const n=[];for(let a=0,s=this.faces.length;a<s;a++){const e=this.faces[a];e.a=r[e.a],e.b=r[e.b],e.c=r[e.c];const t=[e.a,e.b,e.c];for(let r=0;r<3;r++)if(t[r]===t[(r+1)%3]){n.push(a);break}}for(let a=n.length-1;a>=0;a--){const e=n[a];this.faces.splice(e,1);for(let t=0,r=this.faceVertexUvs.length;t<r;t++)this.faceVertexUvs[t].splice(e,1)}const i=this.vertices.length-t.length;return this.vertices=t,i},setFromPoints:function(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){const r=e[t];this.vertices.push(new aa(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){const e=this.faces,t=e.length;for(let a=0;a<t;a++)e[a]._id=a;e.sort(function(e,t){return e.materialIndex-t.materialIndex});const r=this.faceVertexUvs[0],o=this.faceVertexUvs[1];let n,i;r&&r.length===t&&(n=[]),o&&o.length===t&&(i=[]);for(let a=0;a<t;a++){const t=e[a]._id;n&&n.push(r[t]),i&&i.push(o[t])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){const e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){const t=this.parameters;for(const r in t)void 0!==t[r]&&(e[r]=t[r]);return e}const t=[];for(let h=0;h<this.vertices.length;h++){const e=this.vertices[h];t.push(e.x,e.y,e.z)}const r=[],o=[],n={},i=[],a={},s=[],l={};for(let h=0;h<this.faces.length;h++){const e=this.faces[h],t=!0,o=!1,n=void 0!==this.faceVertexUvs[0][h],i=e.normal.length()>0,a=e.vertexNormals.length>0,s=1!==e.color.r||1!==e.color.g||1!==e.color.b,l=e.vertexColors.length>0;let d=0;if(d=$(d,0,0),d=$(d,1,t),d=$(d,2,o),d=$(d,3,n),d=$(d,4,i),d=$(d,5,a),d=$(d,6,s),d=$(d,7,l),r.push(d),r.push(e.a,e.b,e.c),r.push(e.materialIndex),n){const e=this.faceVertexUvs[0][h];r.push(u(e[0]),u(e[1]),u(e[2]))}if(i&&r.push(c(e.normal)),a){const t=e.vertexNormals;r.push(c(t[0]),c(t[1]),c(t[2]))}if(s&&r.push(p(e.color)),l){const t=e.vertexColors;r.push(p(t[0]),p(t[1]),p(t[2]))}}function $(e,t,r){return r?e|1<<t:e&~(1<<t)}function c(e){const t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==n[t]?n[t]:(n[t]=o.length/3,o.push(e.x,e.y,e.z),n[t])}function p(e){const t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==a[t]?a[t]:(a[t]=i.length,i.push(e.getHex()),a[t])}function u(e){const t=e.x.toString()+e.y.toString();return void 0!==l[t]?l[t]:(l[t]=s.length/2,s.push(e.x,e.y),l[t])}return e.data={},e.data.vertices=t,e.data.normals=o,i.length>0&&(e.data.colors=i),s.length>0&&(e.data.uvs=[s]),e.data.faces=r,e},clone:function(){return new la().copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;const t=e.vertices;for(let p=0,u=t.length;p<u;p++)this.vertices.push(t[p].clone());const r=e.colors;for(let p=0,u=r.length;p<u;p++)this.colors.push(r[p].clone());const o=e.faces;for(let p=0,u=o.length;p<u;p++)this.faces.push(o[p].clone());for(let p=0,u=e.faceVertexUvs.length;p<u;p++){const t=e.faceVertexUvs[p];void 0===this.faceVertexUvs[p]&&(this.faceVertexUvs[p]=[]);for(let e=0,r=t.length;e<r;e++){const r=t[e],o=[];for(let e=0,t=r.length;e<t;e++){const t=r[e];o.push(t.clone())}this.faceVertexUvs[p].push(o)}}const n=e.morphTargets;for(let p=0,u=n.length;p<u;p++){const e={};if(e.name=n[p].name,void 0!==n[p].vertices){e.vertices=[];for(let t=0,r=n[p].vertices.length;t<r;t++)e.vertices.push(n[p].vertices[t].clone())}if(void 0!==n[p].normals){e.normals=[];for(let t=0,r=n[p].normals.length;t<r;t++)e.normals.push(n[p].normals[t].clone())}this.morphTargets.push(e)}const i=e.morphNormals;for(let p=0,u=i.length;p<u;p++){const e={};if(void 0!==i[p].vertexNormals){e.vertexNormals=[];for(let t=0,r=i[p].vertexNormals.length;t<r;t++){const r=i[p].vertexNormals[t],o={};o.a=r.a.clone(),o.b=r.b.clone(),o.c=r.c.clone(),e.vertexNormals.push(o)}}if(void 0!==i[p].faceNormals){e.faceNormals=[];for(let t=0,r=i[p].faceNormals.length;t<r;t++)e.faceNormals.push(i[p].faceNormals[t].clone())}this.morphNormals.push(e)}const a=e.skinWeights;for(let p=0,u=a.length;p<u;p++)this.skinWeights.push(a[p].clone());const s=e.skinIndices;for(let p=0,u=s.length;p<u;p++)this.skinIndices.push(s[p].clone());const l=e.lineDistances;for(let p=0,u=l.length;p<u;p++)this.lineDistances.push(l[p]);const $=e.boundingBox;null!==$&&(this.boundingBox=$.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Kv extends la{constructor(e,t,r,o,n,i){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:o,heightSegments:n,depthSegments:i},this.fromBufferGeometry(new Ag(e,t,r,o,n,i)),this.mergeVertices()}}class Ag extends ga{constructor(e,t,r,o,n,i){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:o,heightSegments:n,depthSegments:i};const a=this;e=e||1,t=t||1,r=r||1,o=Math.floor(o)||1,n=Math.floor(n)||1,i=Math.floor(i)||1;const s=[],l=[],$=[],c=[];let p=0,u=0;function h(e,t,r,o,n,i,h,d,f,m,x){const g=i/f,v=h/m,F=i/2,K=h/2,y=d/2,_=f+1,b=m+1;let M=0,w=0;const S=new aa;for(let a=0;a<b;a++){const i=a*v-K;for(let s=0;s<_;s++){const p=s*g-F;S[e]=p*o,S[t]=i*n,S[r]=y,l.push(S.x,S.y,S.z),S[e]=0,S[t]=0,S[r]=d>0?1:-1,$.push(S.x,S.y,S.z),c.push(s/f),c.push(1-a/m),M+=1}}for(let a=0;a<m;a++)for(let e=0;e<f;e++){const t=p+e+_*a,r=p+e+_*(a+1),o=p+(e+1)+_*(a+1),n=p+(e+1)+_*a;s.push(t,r,n),s.push(r,o,n),w+=6}a.addGroup(u,w,x),u+=w,p+=M}h("z","y","x",-1,-1,r,t,e,i,n,0),h("z","y","x",1,-1,r,t,-e,i,n,1),h("x","z","y",1,1,e,r,t,o,i,2),h("x","z","y",1,-1,e,r,-t,o,i,3),h("x","y","z",1,-1,e,t,r,o,n,4),h("x","y","z",-1,-1,e,t,-r,o,n,5),this.setIndex(s),this.setAttribute("position",new ea(l,3)),this.setAttribute("normal",new ea($,3)),this.setAttribute("uv",new ea(c,2))}}function Je(e){const t={};for(const r in e){t[r]={};for(const o in e[r]){const n=e[r][o];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?t[r][o]=n.clone():Array.isArray(n)?t[r][o]=n.slice():t[r][o]=n}}return t}function Ua(e){const t={};for(let r=0;r<e.length;r++){const o=Je(e[r]);for(const e in o)t[e]=o[e]}return t}const ov={clone:Je,merge:Ua};var dv="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",bv="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function Sa(e){ja.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=dv,this.fragmentShader=bv,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function ac(){da.call(this),this.type="Camera",this.matrixWorldInverse=new na,this.projectionMatrix=new na,this.projectionMatrixInverse=new na}function Ga(e,t,r,o){ac.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Sa.prototype=Object.create(ja.prototype),Sa.prototype.constructor=Sa,Sa.prototype.isShaderMaterial=!0,Sa.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Je(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this},Sa.prototype.toJSON=function(e){const t=ja.prototype.toJSON.call(this,e);t.uniforms={};for(const o in this.uniforms){const r=this.uniforms[o].value;r&&r.isTexture?t.uniforms[o]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[o]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[o]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[o]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[o]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[o]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[o]={type:"m4",value:r.toArray()}:t.uniforms[o]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const o in this.extensions)!0===this.extensions[o]&&(r[o]=!0);return Object.keys(r).length>0&&(t.extensions=r),t},ac.prototype=Object.assign(Object.create(da.prototype),{constructor:ac,isCamera:!0,copy:function(e,t){return da.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new aa),this.updateMatrixWorld(!0);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){da.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){da.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),Ga.prototype=Object.assign(Object.create(ac.prototype),{constructor:Ga,isPerspectiveCamera:!0,copy:function(e,t){return ac.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){const t=.5*this.getFilmHeight()/e;this.fov=2*ma.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){const e=Math.tan(.5*ma.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*ma.RAD2DEG*Math.atan(Math.tan(.5*ma.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,o,n,i){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=n,this.view.height=i,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let e=this.near,t=e*Math.tan(.5*ma.DEG2RAD*this.fov)/this.zoom,r=2*t,o=this.aspect*r,n=-.5*o,i=this.view;if(null!==this.view&&this.view.enabled){const e=i.fullWidth,a=i.fullHeight;n+=i.offsetX*o/e,t-=i.offsetY*r/a,o*=i.width/e,r*=i.height/a}const a=this.filmOffset;0!==a&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+o,t,t-r,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){const t=da.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});const He=90,Ge=1;function ng(e,t,r){if(da.call(this),this.type="CubeCamera",!0!==r.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=r;const o=new Ga(He,Ge,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new aa(1,0,0)),this.add(o);const n=new Ga(He,Ge,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new aa(-1,0,0)),this.add(n);const i=new Ga(He,Ge,e,t);i.layers=this.layers,i.up.set(0,0,1),i.lookAt(new aa(0,1,0)),this.add(i);const a=new Ga(He,Ge,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new aa(0,-1,0)),this.add(a);const s=new Ga(He,Ge,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new aa(0,0,1)),this.add(s);const l=new Ga(He,Ge,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new aa(0,0,-1)),this.add(l),this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();const $=e.xr.enabled,c=e.getRenderTarget();e.xr.enabled=!1;const p=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,o),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,i),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,s),r.texture.generateMipmaps=p,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.xr.enabled=$},this.clear=function(e,t,o,n){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(r,a),e.clear(t,o,n);e.setRenderTarget(i)}}function Lf(e,t,r){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=r),vb.call(this,e,e,t)}function De(e,t,r,o,n,i,a,s,l,$,c,p){va.call(this,null,i,a,s,l,$,o,n,c,p),this.image={data:e||null,width:t||1,height:r||1},this.magFilter=void 0!==l?l:Pa,this.minFilter=void 0!==$?$:Pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}ng.prototype=Object.create(da.prototype),ng.prototype.constructor=ng,Lf.prototype=Object.create(vb.prototype),Lf.prototype.constructor=Lf,Lf.prototype.isWebGLCubeRenderTarget=!0,Lf.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;const r=new Ye,o={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#include <common>","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV = equirectUv( direction );","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},n=new Sa({name:"CubemapFromEquirect",uniforms:Je(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,side:Oa,blending:Ic});n.uniforms.tEquirect.value=t;const i=new ua(new Ag(5,5,5),n);return r.add(i),new ng(1,10,this).update(e,r),i.geometry.dispose(),i.material.dispose(),this},De.prototype=Object.create(va.prototype),De.prototype.constructor=De,De.prototype.isDataTexture=!0;const Ce=new _b,Jg=new aa;function Hf(e,t,r,o,n,i){this.planes=[void 0!==e?e:new Pb,void 0!==t?t:new Pb,void 0!==r?r:new Pb,void 0!==o?o:new Pb,void 0!==n?n:new Pb,void 0!==i?i:new Pb]}Object.assign(Hf.prototype,{set:function(e,t,r,o,n,i){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(o),a[4].copy(n),a[5].copy(i),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromProjectionMatrix:function(e){const t=this.planes,r=e.elements,o=r[0],n=r[1],i=r[2],a=r[3],s=r[4],l=r[5],$=r[6],c=r[7],p=r[8],u=r[9],h=r[10],d=r[11],f=r[12],m=r[13],x=r[14],g=r[15];return t[0].setComponents(a-o,c-s,d-p,g-f).normalize(),t[1].setComponents(a+o,c+s,d+p,g+f).normalize(),t[2].setComponents(a+n,c+l,d+u,g+m).normalize(),t[3].setComponents(a-n,c-l,d-u,g-m).normalize(),t[4].setComponents(a-i,c-$,d-h,g-x).normalize(),t[5].setComponents(a+i,c+$,d+h,g+x).normalize(),this},intersectsObject:function(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ce.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ce)},intersectsSprite:function(e){return Ce.center.set(0,0,0),Ce.radius=.7071067811865476,Ce.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ce)},intersectsSphere:function(e){const t=this.planes,r=e.center,o=-e.radius;for(let n=0;n<6;n++){if(t[n].distanceToPoint(r)<o)return!1}return!0},intersectsBox:function(e){const t=this.planes;for(let r=0;r<6;r++){const o=t[r];if(Jg.x=o.normal.x>0?e.max.x:e.min.x,Jg.y=o.normal.y>0?e.max.y:e.min.y,Jg.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(Jg)<0)return!1}return!0},containsPoint:function(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}});const fa={common:{diffuse:{value:new ha(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Xa},uv2Transform:{value:new Xa},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ca(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ha(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ha(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Xa}},sprite:{diffuse:{value:new ha(15658734)},opacity:{value:1},center:{value:new ca(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Xa}}};function mo(){let e=null,t=!1,r=null,o=null;function n(t,i){r(t,i),o=e.requestAnimationFrame(n)}return{start:function(){!0!==t&&null!==r&&(o=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(o),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function mu(e,t){const r=t.isWebGL2,o=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),o.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const r=o.get(t);r&&(e.deleteBuffer(r.buffer),o.delete(t))},update:function(t,n){t.isInterleavedBufferAttribute&&(t=t.data);const i=o.get(t);void 0===i?o.set(t,function(t,r){const o=t.array,n=t.usage,i=e.createBuffer();e.bindBuffer(r,i),e.bufferData(r,o,n),t.onUploadCallback();let a=5126;return o instanceof Float32Array?a=5126:o instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):o instanceof Uint16Array?a=5123:o instanceof Int16Array?a=5122:o instanceof Uint32Array?a=5125:o instanceof Int32Array?a=5124:o instanceof Int8Array?a=5120:o instanceof Uint8Array&&(a=5121),{buffer:i,type:a,bytesPerElement:o.BYTES_PER_ELEMENT,version:t.version}}(t,n)):i.version<t.version&&(function(t,o,n){const i=o.array,a=o.updateRange;e.bindBuffer(n,t),-1===a.count?e.bufferSubData(n,0,i):(r?e.bufferSubData(n,a.offset*i.BYTES_PER_ELEMENT,i,a.offset,a.count):e.bufferSubData(n,a.offset*i.BYTES_PER_ELEMENT,i.subarray(a.offset,a.offset+a.count)),a.count=-1)}(i.buffer,t,n),i.version=t.version)}}}function Lg(e,t,r,o){la.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:o},this.fromBufferGeometry(new Cc(e,t,r,o)),this.mergeVertices()}function Cc(e,t,r,o){ga.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:o};const n=(e=e||1)/2,i=(t=t||1)/2,a=Math.floor(r)||1,s=Math.floor(o)||1,l=a+1,$=s+1,c=e/a,p=t/s,u=[],h=[],d=[],f=[];for(let m=0;m<$;m++){const e=m*p-i;for(let t=0;t<l;t++){const r=t*c-n;h.push(r,-e,0),d.push(0,0,1),f.push(t/a),f.push(1-m/s)}}for(let m=0;m<s;m++)for(let e=0;e<a;e++){const t=e+l*m,r=e+l*(m+1),o=e+1+l*(m+1),n=e+1+l*m;u.push(t,r,n),u.push(r,o,n)}this.setIndex(u),this.setAttribute("position",new ea(h,3)),this.setAttribute("normal",new ea(d,3)),this.setAttribute("uv",new ea(f,2))}Lg.prototype=Object.create(la.prototype),Lg.prototype.constructor=Lg,Cc.prototype=Object.create(ga.prototype),Cc.prototype.constructor=Cc;var ju="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",iu="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",gu="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",du="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",cu="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",bu="vec3 transformed = vec3( position );",_t="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",Yt="vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",Wt="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",St="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",Qt="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",Jt="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",It="#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",Ht="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",Ft="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",Ct="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",At="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",xt="#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",ut="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",tt="vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",qt="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",ot="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",kt="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",jt="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",ct="gl_FragColor = linearToOutputTexel( gl_FragColor );",Zs="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",Ws="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",Us="#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",Ps="#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",Js="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",Cs="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",ss="#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",rs="#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",ps="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",js="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",is="#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",as="#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",_r="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",Yr="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",Xr="uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",Vr="#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",Tr="ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",Sr="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lr="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",hr="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",gr="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",fr="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",er="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",dr="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",cr="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",_q="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",Yq="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",pp="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",Mv="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",qp="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",rp="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",sp="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",tp="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",up="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",vp="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",wp="#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",xp="#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",yp="#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",zp="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",Ap="#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",Bp="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",Cp="#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",Dp="#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",Ep="#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",Fp="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",Gp="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",Hp="vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",Ip="#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",Jp="#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",Kp="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",Lp="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",Mp="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",Np="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",Op="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",Pp="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",Qp="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",Rp="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",Sp="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",Tp="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",Up="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",Vp="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",Wp="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",Xp="#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",Yp="#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",Zp="#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",$p="#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",_p="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",aq="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",bq="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",cq="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",dq="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",eq="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",fq="#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",gq="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",hq="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",iq="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",jq="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",kq="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",lq="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",mq="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",nq="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",oq="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",pq="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",qq="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",rq="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",sq="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",tq="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",uq="#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",vq="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",wq="#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",xq="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",yq="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",zq="#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",Aq="#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Bq="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",Cq="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",Dq="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",Eq="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",Fq="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",Gq="#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Hq="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",Iq="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}";const oa={alphamap_fragment:ju,alphamap_pars_fragment:iu,alphatest_fragment:gu,aomap_fragment:du,aomap_pars_fragment:cu,begin_vertex:bu,beginnormal_vertex:_t,bsdfs:Yt,bumpmap_pars_fragment:Wt,clipping_planes_fragment:St,clipping_planes_pars_fragment:Qt,clipping_planes_pars_vertex:Jt,clipping_planes_vertex:It,color_fragment:Ht,color_pars_fragment:Ft,color_pars_vertex:Ct,color_vertex:At,common:xt,cube_uv_reflection_fragment:ut,defaultnormal_vertex:tt,displacementmap_pars_vertex:qt,displacementmap_vertex:ot,emissivemap_fragment:kt,emissivemap_pars_fragment:jt,encodings_fragment:ct,encodings_pars_fragment:Zs,envmap_fragment:Ws,envmap_common_pars_fragment:Us,envmap_pars_fragment:Ps,envmap_pars_vertex:Js,envmap_physical_pars_fragment:Vr,envmap_vertex:Cs,fog_vertex:ss,fog_pars_vertex:rs,fog_fragment:ps,fog_pars_fragment:js,gradientmap_pars_fragment:is,lightmap_fragment:as,lightmap_pars_fragment:_r,lights_lambert_vertex:Yr,lights_pars_begin:Xr,lights_toon_fragment:Tr,lights_toon_pars_fragment:Sr,lights_phong_fragment:lr,lights_phong_pars_fragment:hr,lights_physical_fragment:gr,lights_physical_pars_fragment:fr,lights_fragment_begin:er,lights_fragment_maps:dr,lights_fragment_end:cr,logdepthbuf_fragment:_q,logdepthbuf_pars_fragment:Yq,logdepthbuf_pars_vertex:pp,logdepthbuf_vertex:Mv,map_fragment:qp,map_pars_fragment:rp,map_particle_fragment:sp,map_particle_pars_fragment:tp,metalnessmap_fragment:up,metalnessmap_pars_fragment:vp,morphnormal_vertex:wp,morphtarget_pars_vertex:xp,morphtarget_vertex:yp,normal_fragment_begin:zp,normal_fragment_maps:Ap,normalmap_pars_fragment:Bp,clearcoat_normal_fragment_begin:Cp,clearcoat_normal_fragment_maps:Dp,clearcoat_pars_fragment:Ep,packing:Fp,premultiplied_alpha_fragment:Gp,project_vertex:Hp,dithering_fragment:Ip,dithering_pars_fragment:Jp,roughnessmap_fragment:Kp,roughnessmap_pars_fragment:Lp,shadowmap_pars_fragment:Mp,shadowmap_pars_vertex:Np,shadowmap_vertex:Op,shadowmask_pars_fragment:Pp,skinbase_vertex:Qp,skinning_pars_vertex:Rp,skinning_vertex:Sp,skinnormal_vertex:Tp,specularmap_fragment:Up,specularmap_pars_fragment:Vp,tonemapping_fragment:Wp,tonemapping_pars_fragment:Xp,uv_pars_fragment:Yp,uv_pars_vertex:Zp,uv_vertex:$p,uv2_pars_fragment:_p,uv2_pars_vertex:aq,uv2_vertex:bq,worldpos_vertex:cq,background_frag:dq,background_vert:eq,cube_frag:fq,cube_vert:gq,depth_frag:hq,depth_vert:iq,distanceRGBA_frag:jq,distanceRGBA_vert:kq,equirect_frag:lq,equirect_vert:mq,linedashed_frag:nq,linedashed_vert:oq,meshbasic_frag:pq,meshbasic_vert:qq,meshlambert_frag:rq,meshlambert_vert:sq,meshmatcap_frag:tq,meshmatcap_vert:uq,meshtoon_frag:vq,meshtoon_vert:wq,meshphong_frag:xq,meshphong_vert:yq,meshphysical_frag:zq,meshphysical_vert:Aq,normal_frag:Bq,normal_vert:Cq,points_frag:Dq,points_vert:Eq,shadow_frag:Fq,shadow_vert:Gq,sprite_frag:Hq,sprite_vert:Iq},lc={basic:{uniforms:Ua([fa.common,fa.specularmap,fa.envmap,fa.aomap,fa.lightmap,fa.fog]),vertexShader:oa.meshbasic_vert,fragmentShader:oa.meshbasic_frag},lambert:{uniforms:Ua([fa.common,fa.specularmap,fa.envmap,fa.aomap,fa.lightmap,fa.emissivemap,fa.fog,fa.lights,{emissive:{value:new ha(0)}}]),vertexShader:oa.meshlambert_vert,fragmentShader:oa.meshlambert_frag},phong:{uniforms:Ua([fa.common,fa.specularmap,fa.envmap,fa.aomap,fa.lightmap,fa.emissivemap,fa.bumpmap,fa.normalmap,fa.displacementmap,fa.fog,fa.lights,{emissive:{value:new ha(0)},specular:{value:new ha(1118481)},shininess:{value:30}}]),vertexShader:oa.meshphong_vert,fragmentShader:oa.meshphong_frag},standard:{uniforms:Ua([fa.common,fa.envmap,fa.aomap,fa.lightmap,fa.emissivemap,fa.bumpmap,fa.normalmap,fa.displacementmap,fa.roughnessmap,fa.metalnessmap,fa.fog,fa.lights,{emissive:{value:new ha(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:oa.meshphysical_vert,fragmentShader:oa.meshphysical_frag},toon:{uniforms:Ua([fa.common,fa.aomap,fa.lightmap,fa.emissivemap,fa.bumpmap,fa.normalmap,fa.displacementmap,fa.gradientmap,fa.fog,fa.lights,{emissive:{value:new ha(0)}}]),vertexShader:oa.meshtoon_vert,fragmentShader:oa.meshtoon_frag},matcap:{uniforms:Ua([fa.common,fa.bumpmap,fa.normalmap,fa.displacementmap,fa.fog,{matcap:{value:null}}]),vertexShader:oa.meshmatcap_vert,fragmentShader:oa.meshmatcap_frag},points:{uniforms:Ua([fa.points,fa.fog]),vertexShader:oa.points_vert,fragmentShader:oa.points_frag},dashed:{uniforms:Ua([fa.common,fa.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:oa.linedashed_vert,fragmentShader:oa.linedashed_frag},depth:{uniforms:Ua([fa.common,fa.displacementmap]),vertexShader:oa.depth_vert,fragmentShader:oa.depth_frag},normal:{uniforms:Ua([fa.common,fa.bumpmap,fa.normalmap,fa.displacementmap,{opacity:{value:1}}]),vertexShader:oa.normal_vert,fragmentShader:oa.normal_frag},sprite:{uniforms:Ua([fa.sprite,fa.fog]),vertexShader:oa.sprite_vert,fragmentShader:oa.sprite_frag},background:{uniforms:{uvTransform:{value:new Xa},t2D:{value:null}},vertexShader:oa.background_vert,fragmentShader:oa.background_frag},cube:{uniforms:Ua([fa.envmap,{opacity:{value:1}}]),vertexShader:oa.cube_vert,fragmentShader:oa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:oa.equirect_vert,fragmentShader:oa.equirect_frag},distanceRGBA:{uniforms:Ua([fa.common,fa.displacementmap,{referencePosition:{value:new aa},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:oa.distanceRGBA_vert,fragmentShader:oa.distanceRGBA_frag},shadow:{uniforms:Ua([fa.lights,fa.fog,{color:{value:new ha(0)},opacity:{value:1}}]),vertexShader:oa.shadow_vert,fragmentShader:oa.shadow_frag}};function Lq(e,t,r,o){const n=new ha(0);let i,a,s=0,l=null,$=0,c=null;function p(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,o)}return{getClearColor:function(){return n},setClearColor:function(e,t){n.set(e),p(n,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){p(n,s=e)},render:function(t,o,u,h){let d=!0===o.isScene?o.background:null;const f=e.xr,m=f.getSession&&f.getSession();if(m&&"additive"===m.environmentBlendMode&&(d=null),null===d?p(n,s):d&&d.isColor&&(p(d,1),h=!0),(e.autoClear||h)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLCubeRenderTarget||d.mapping===kg)){void 0===a&&((a=new ua(new Ag(1,1,1),new Sa({name:"BackgroundCubeMaterial",uniforms:Je(lc.cube.uniforms),vertexShader:lc.cube.vertexShader,fragmentShader:lc.cube.fragmentShader,side:Oa,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a));const o=d.isWebGLCubeRenderTarget?d.texture:d;a.material.uniforms.envMap.value=o,a.material.uniforms.flipEnvMap.value=o.isCubeTexture?-1:1,l===d&&$===o.version&&c===e.toneMapping||(a.material.needsUpdate=!0,l=d,$=o.version,c=e.toneMapping),t.unshift(a,a.geometry,a.material,0,0,null)}else d&&d.isTexture&&(void 0===i&&((i=new ua(new Cc(2,2),new Sa({name:"BackgroundMaterial",uniforms:Je(lc.background.uniforms),vertexShader:lc.background.vertexShader,fragmentShader:lc.background.fragmentShader,side:Wf,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(i)),i.material.uniforms.t2D.value=d,!0===d.matrixAutoUpdate&&d.updateMatrix(),i.material.uniforms.uvTransform.value.copy(d.matrix),l===d&&$===d.version&&c===e.toneMapping||(i.material.needsUpdate=!0,l=d,$=d.version,c=e.toneMapping),t.unshift(i,i.geometry,i.material,0,0,null))}}}function Mq(e,t,r,o){const n=e.getParameter(34921),i=o.isWebGL2?null:t.get("OES_vertex_array_object"),a=o.isWebGL2||null!==i,s={},l=u(null);let $=l;function c(t){return o.isWebGL2?e.bindVertexArray(t):i.bindVertexArrayOES(t)}function p(t){return o.isWebGL2?e.deleteVertexArray(t):i.deleteVertexArrayOES(t)}function u(e){const t=[],r=[],o=[];for(let i=0;i<n;i++)t[i]=0,r[i]=0,o[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:o,object:e,attributes:{}}}function h(){const e=$.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function d(e){f(e,0)}function f(r,n){const i=$.newAttributes,a=$.enabledAttributes,s=$.attributeDivisors;if(i[r]=1,0===a[r]&&(e.enableVertexAttribArray(r),a[r]=1),s[r]!==n){(o.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[o.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,n),s[r]=n}}function m(){const t=$.newAttributes,r=$.enabledAttributes;for(let o=0,n=r.length;o<n;o++)r[o]!==t[o]&&(e.disableVertexAttribArray(o),r[o]=0)}function x(t,r,n,i,a,s){!0!==o.isWebGL2||5124!==n&&5125!==n?e.vertexAttribPointer(t,r,n,i,a,s):e.vertexAttribIPointer(t,r,n,i,a,s)}function g(){v(),$!==l&&c(($=l).object)}function v(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(n,l,p,g,v){let F=!1;if(a){const t=function(t,r,n){const a=!0===n.wireframe;let l=s[t.id];void 0===l&&(l={},s[t.id]=l);let $=l[r.id];void 0===$&&($={},l[r.id]=$);let c=$[a];return void 0===c&&(c=u(o.isWebGL2?e.createVertexArray():i.createVertexArrayOES()),$[a]=c),c}(g,p,l);$!==t&&c(($=t).object),(F=function(e){const t=$.attributes,r=e.attributes;if(Object.keys(t).length!==Object.keys(r).length)return!0;for(const o in r){const e=t[o],n=r[o];if(e.attribute!==n)return!0;if(e.data!==n.data)return!0}return!1}(g))&&function(e){const t={},r=e.attributes;for(const o in r){const e=r[o],n={};n.attribute=e,e.data&&(n.data=e.data),t[o]=n}$.attributes=t}(g)}else{const e=!0===l.wireframe;$.geometry===g.id&&$.program===p.id&&$.wireframe===e||($.geometry=g.id,$.program=p.id,$.wireframe=e,F=!0)}!0===n.isInstancedMesh&&(F=!0),null!==v&&r.update(v,34963),F&&(function(n,i,a,s){if(!1===o.isWebGL2&&(n.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;h();const l=s.attributes,$=a.getAttributes(),c=i.defaultAttributeValues;for(const t in $){const o=$[t];if(o>=0){const i=l[t];if(void 0!==i){const t=i.normalized,n=i.itemSize,a=r.get(i);if(void 0===a)continue;const l=a.buffer,$=a.type,c=a.bytesPerElement;if(i.isInterleavedBufferAttribute){const r=i.data,a=r.stride,p=i.offset;r&&r.isInstancedInterleavedBuffer?(f(o,r.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)):d(o),e.bindBuffer(34962,l),x(o,n,$,t,a*c,p*c)}else i.isInstancedBufferAttribute?(f(o,i.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=i.meshPerAttribute*i.count)):d(o),e.bindBuffer(34962,l),x(o,n,$,t,0,0)}else if("instanceMatrix"===t){const t=r.get(n.instanceMatrix);if(void 0===t)continue;const i=t.buffer,a=t.type;f(o+0,1),f(o+1,1),f(o+2,1),f(o+3,1),e.bindBuffer(34962,i),e.vertexAttribPointer(o+0,4,a,!1,64,0),e.vertexAttribPointer(o+1,4,a,!1,64,16),e.vertexAttribPointer(o+2,4,a,!1,64,32),e.vertexAttribPointer(o+3,4,a,!1,64,48)}else if(void 0!==c){const r=c[t];if(void 0!==r)switch(r.length){case 2:e.vertexAttrib2fv(o,r);break;case 3:e.vertexAttrib3fv(o,r);break;case 4:e.vertexAttrib4fv(o,r);break;default:e.vertexAttrib1fv(o,r);}}}}m()}(n,l,p,g),null!==v&&e.bindBuffer(34963,r.get(v).buffer))},reset:g,resetDefaultState:v,dispose:function(){g();for(const e in s){const t=s[e];for(const e in t){const r=t[e];for(const e in r)p(r[e].object),delete r[e];delete t[e]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0===s[e.id])return;const t=s[e.id];for(const r in t){const e=t[r];for(const t in e)p(e[t].object),delete e[t];delete t[r]}delete s[e.id]},releaseStatesOfProgram:function(e){for(const t in s){const r=s[t];if(void 0===r[e.id])continue;const o=r[e.id];for(const e in o)p(o[e].object),delete o[e];delete r[e.id]}},initAttributes:h,enableAttribute:d,disableUnusedAttributes:m}}function Nq(e,t,r,o){const n=o.isWebGL2;let i;this.setMode=function(e){i=e},this.render=function(t,o){e.drawArrays(i,t,o),r.update(o,i)},this.renderInstances=function(o,a,s,l){if(0===l)return;let $,c;if(n)$=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===($=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");$[c](i,a,s,l),r.update(s,i,l)}}function Oq(e,t,r){let o;function n(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const i="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let a=void 0!==r.precision?r.precision:"highp";const s=n(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);const l=!0===r.logarithmicDepthBuffer,$=e.getParameter(34930),c=e.getParameter(35660),p=e.getParameter(3379),u=e.getParameter(34076),h=e.getParameter(34921),d=e.getParameter(36347),f=e.getParameter(36348),m=e.getParameter(36349),x=c>0,g=i||!!t.get("OES_texture_float");return{isWebGL2:i,getMaxAnisotropy:function(){if(void 0!==o)return o;const r=t.get("EXT_texture_filter_anisotropic");return o=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:a,logarithmicDepthBuffer:l,maxTextures:$,maxVertexTextures:c,maxTextureSize:p,maxCubemapSize:u,maxAttributes:h,maxVertexUniforms:d,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:x,floatFragmentTextures:g,floatVertexTextures:x&&g,maxSamples:i?e.getParameter(36183):0}}function Pq(){const e=this;let t=null,r=0,o=!1,n=!1;const i=new Pb,a=new Xa,s={value:null,needsUpdate:!1};function l(){s.value!==t&&(s.value=t,s.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function $(t,r,o,n){let l=null!==t?t.length:0,$=null;if(0!==l){if($=s.value,!0!==n||null===$){const e=o+4*l,n=r.matrixWorldInverse;a.getNormalMatrix(n),(null===$||$.length<e)&&($=new Float32Array(e));for(let r=0,s=o;r!==l;++r,s+=4)i.copy(t[r]).applyMatrix4(n,a),i.normal.toArray($,s),$[s+3]=i.constant}s.value=$,s.needsUpdate=!0}return e.numPlanes=l,e.numIntersection=0,$}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,n,i){const a=0!==e.length||n||0!==r||o;return o=n,t=$(e,i,0),r=e.length,a},this.beginShadows=function(){n=!0,$(null)},this.endShadows=function(){n=!1,l()},this.setState=function(e,i,a,c,p,u){if(!o||null===e||0===e.length||n&&!a)n?$(null):l();else{const o=n?0:r,a=4*o;let l=p.clippingState||null;s.value=l,l=$(e,c,a,u);for(let e=0;e!==a;++e)l[e]=t[e];p.clippingState=l,this.numIntersection=i?this.numPlanes:0,this.numPlanes+=o}}}function Qq(e){const t={};return{get:function(r){if(void 0!==t[r])return t[r];let o;switch(r){case"WEBGL_depth_texture":o=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=e.getExtension(r);}return null===o&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=o,o}}}function Rq(e,t,r,o){const n=new WeakMap,i=new WeakMap;function a(e){const s=e.target,l=n.get(s);null!==l.index&&t.remove(l.index);for(const r in l.attributes)t.remove(l.attributes[r]);s.removeEventListener("dispose",a),n.delete(s);const $=i.get(l);$&&(t.remove($),i.delete(l)),o.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,r.memory.geometries--}function s(e){const r=[],o=e.index,n=e.attributes.position;let a=0;if(null!==o){const e=o.array;a=o.version;for(let t=0,o=e.length;t<o;t+=3){const o=e[t+0],n=e[t+1],i=e[t+2];r.push(o,n,n,i,i,o)}}else{const e=n.array;a=n.version;for(let t=0,o=e.length/3-1;t<o;t+=3){const e=t+0,o=t+1,n=t+2;r.push(e,o,o,n,n,e)}}const s=new(on(r)>65535?dg:$f)(r,1);s.version=a;const l=i.get(e);l&&t.remove(l),i.set(e,s)}return{get:function(e,t){let o=n.get(t);return o||(t.addEventListener("dispose",a),t.isBufferGeometry?o=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=new ga().setFromObject(e)),o=t._bufferGeometry),n.set(t,o),r.memory.geometries++,o)},update:function(e){const r=e.attributes;for(const n in r)t.update(r[n],34962);const o=e.morphAttributes;for(const n in o){const e=o[n];for(let r=0,o=e.length;r<o;r++)t.update(e[r],34962)}},getWireframeAttribute:function(e){const t=i.get(e);if(t){const r=e.index;null!==r&&t.version<r.version&&s(e)}else s(e);return i.get(e)}}}function Sq(e,t,r,o){const n=o.isWebGL2;let i,a,s;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,s=e.bytesPerElement},this.render=function(t,o){e.drawElements(i,o,a,t*s),r.update(o,i)},this.renderInstances=function(o,l,$,c){if(0===c)return;let p,u;if(n)p=e,u="drawElementsInstanced";else if(u="drawElementsInstancedANGLE",null===(p=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[u](i,$,a,l*s,c),r.update($,i,c)}}function Tq(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,r,o){switch(o=o||1,t.calls++,r){case 4:t.triangles+=o*(e/3);break;case 1:t.lines+=o*(e/2);break;case 3:t.lines+=o*(e-1);break;case 2:t.lines+=o*e;break;case 0:t.points+=o*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r);}}}}function Uq(e,t){return e[0]-t[0]}function Vq(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Wq(e){const t={},r=new Float32Array(8),o=[];for(let n=0;n<8;n++)o[n]=[n,0];return{update:function(n,i,a,s){const l=n.morphTargetInfluences,$=void 0===l?0:l.length;let c=t[i.id];if(void 0===c){c=[];for(let e=0;e<$;e++)c[e]=[e,0];t[i.id]=c}for(let e=0;e<$;e++){const t=c[e];t[0]=e,t[1]=l[e]}c.sort(Vq);for(let e=0;e<8;e++)e<$&&c[e][1]?(o[e][0]=c[e][0],o[e][1]=c[e][1]):(o[e][0]=Number.MAX_SAFE_INTEGER,o[e][1]=0);o.sort(Uq);const p=a.morphTargets&&i.morphAttributes.position,u=a.morphNormals&&i.morphAttributes.normal;let h=0;for(let e=0;e<8;e++){const t=o[e],n=t[0],a=t[1];n!==Number.MAX_SAFE_INTEGER&&a?(p&&i.getAttribute("morphTarget"+e)!==p[n]&&i.setAttribute("morphTarget"+e,p[n]),u&&i.getAttribute("morphNormal"+e)!==u[n]&&i.setAttribute("morphNormal"+e,u[n]),r[e]=a,h+=a):(p&&void 0!==i.getAttribute("morphTarget"+e)&&i.deleteAttribute("morphTarget"+e),u&&void 0!==i.getAttribute("morphNormal"+e)&&i.deleteAttribute("morphNormal"+e),r[e]=0)}const d=i.morphTargetsRelative?1:1-h;s.getUniforms().setValue(e,"morphTargetBaseInfluence",d),s.getUniforms().setValue(e,"morphTargetInfluences",r)}}}function Xq(e,t,r,o){let n=new WeakMap;return{update:function(e){const i=o.render.frame,a=e.geometry,s=t.get(e,a);return n.get(s)!==i&&(a.isGeometry&&s.updateFromObject(e),t.update(s),n.set(s,i)),e.isInstancedMesh&&r.update(e.instanceMatrix,34962),s},dispose:function(){n=new WeakMap}}}function Gc(e,t,r,o,n,i,a,s,l,$){e=void 0!==e?e:[],t=void 0!==t?t:wj,a=void 0!==a?a:ad,va.call(this,e,t,r,o,n,i,a,s,l,$),this.flipY=!1}function Af(e,t,r,o){va.call(this,null),this.image={data:e||null,width:t||1,height:r||1,depth:o||1},this.magFilter=Pa,this.minFilter=Pa,this.wrapR=cb,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function zf(e,t,r,o){va.call(this,null),this.image={data:e||null,width:t||1,height:r||1,depth:o||1},this.magFilter=Pa,this.minFilter=Pa,this.wrapR=cb,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}lc.physical={uniforms:Ua([lc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ca(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ha(0)},transparency:{value:0}}]),vertexShader:oa.meshphysical_vert,fragmentShader:oa.meshphysical_frag},Gc.prototype=Object.create(va.prototype),Gc.prototype.constructor=Gc,Gc.prototype.isCubeTexture=!0,Object.defineProperty(Gc.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Af.prototype=Object.create(va.prototype),Af.prototype.constructor=Af,Af.prototype.isDataTexture2DArray=!0,zf.prototype=Object.create(va.prototype),zf.prototype.constructor=zf,zf.prototype.isDataTexture3D=!0;const mp=new va,ar=new Af,br=new zf,lp=new Gc,kp=[],jp=[],ip=new Float32Array(16),hp=new Float32Array(9),gp=new Float32Array(4);function qe(e,t,r){const o=e[0];if(o<=0||o>0)return e;let n=t*r,i=kp[n];if(void 0===i&&(i=new Float32Array(n),kp[n]=i),0!==t){o.toArray(i,0);for(let o=1,n=0;o!==t;++o)n+=r,e[o].toArray(i,n)}return i}function ub(e,t){if(e.length!==t.length)return!1;for(let r=0,o=e.length;r<o;r++)if(e[r]!==t[r])return!1;return!0}function hb(e,t){for(let r=0,o=t.length;r<o;r++)e[r]=t[r]}function fp(e,t){let r=jp[t];void 0===r&&(r=new Int32Array(t),jp[t]=r);for(let o=0;o!==t;++o)r[o]=e.allocateTextureUnit();return r}function mr(e,t){const r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function nr(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(ub(r,t))return;e.uniform2fv(this.addr,t),hb(r,t)}}function or(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(ub(r,t))return;e.uniform3fv(this.addr,t),hb(r,t)}}function pr(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(ub(r,t))return;e.uniform4fv(this.addr,t),hb(r,t)}}function qr(e,t){const r=this.cache,o=t.elements;if(void 0===o){if(ub(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),hb(r,t)}else{if(ub(r,o))return;gp.set(o),e.uniformMatrix2fv(this.addr,!1,gp),hb(r,o)}}function rr(e,t){const r=this.cache,o=t.elements;if(void 0===o){if(ub(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),hb(r,t)}else{if(ub(r,o))return;hp.set(o),e.uniformMatrix3fv(this.addr,!1,hp),hb(r,o)}}function sr(e,t){const r=this.cache,o=t.elements;if(void 0===o){if(ub(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),hb(r,t)}else{if(ub(r,o))return;ip.set(o),e.uniformMatrix4fv(this.addr,!1,ip),hb(r,o)}}function tr(e,t,r){const o=this.cache,n=r.allocateTextureUnit();o[0]!==n&&(e.uniform1i(this.addr,n),o[0]=n),r.safeSetTexture2D(t||mp,n)}function ur(e,t,r){const o=this.cache,n=r.allocateTextureUnit();o[0]!==n&&(e.uniform1i(this.addr,n),o[0]=n),r.setTexture2DArray(t||ar,n)}function vr(e,t,r){const o=this.cache,n=r.allocateTextureUnit();o[0]!==n&&(e.uniform1i(this.addr,n),o[0]=n),r.setTexture3D(t||br,n)}function wr(e,t,r){const o=this.cache,n=r.allocateTextureUnit();o[0]!==n&&(e.uniform1i(this.addr,n),o[0]=n),r.safeSetTextureCube(t||lp,n)}function xr(e,t){const r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function yr(e,t){const r=this.cache;ub(r,t)||(e.uniform2iv(this.addr,t),hb(r,t))}function zr(e,t){const r=this.cache;ub(r,t)||(e.uniform3iv(this.addr,t),hb(r,t))}function Ar(e,t){const r=this.cache;ub(r,t)||(e.uniform4iv(this.addr,t),hb(r,t))}function Br(e,t){const r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function Cr(e){switch(e){case 5126:return mr;case 35664:return nr;case 35665:return or;case 35666:return pr;case 35674:return qr;case 35675:return rr;case 35676:return sr;case 5124:case 35670:return xr;case 35667:case 35671:return yr;case 35668:case 35672:return zr;case 35669:case 35673:return Ar;case 5125:return Br;case 35678:case 36198:case 36298:case 36306:case 35682:return tr;case 35679:case 36299:case 36307:return vr;case 35680:case 36300:case 36308:case 36293:return wr;case 36289:case 36303:case 36311:case 36292:return ur;}}function Dr(e,t){e.uniform1fv(this.addr,t)}function Er(e,t){e.uniform1iv(this.addr,t)}function Fr(e,t){e.uniform2iv(this.addr,t)}function Gr(e,t){e.uniform3iv(this.addr,t)}function Hr(e,t){e.uniform4iv(this.addr,t)}function Ir(e,t){const r=qe(t,this.size,2);e.uniform2fv(this.addr,r)}function Jr(e,t){const r=qe(t,this.size,3);e.uniform3fv(this.addr,r)}function Kr(e,t){const r=qe(t,this.size,4);e.uniform4fv(this.addr,r)}function Lr(e,t){const r=qe(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function Mr(e,t){const r=qe(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function Nr(e,t){const r=qe(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function Or(e,t,r){const o=t.length,n=fp(r,o);e.uniform1iv(this.addr,n);for(let i=0;i!==o;++i)r.safeSetTexture2D(t[i]||mp,n[i])}function Pr(e,t,r){const o=t.length,n=fp(r,o);e.uniform1iv(this.addr,n);for(let i=0;i!==o;++i)r.safeSetTextureCube(t[i]||lp,n[i])}function Qr(e){switch(e){case 5126:return Dr;case 35664:return Ir;case 35665:return Jr;case 35666:return Kr;case 35674:return Lr;case 35675:return Mr;case 35676:return Nr;case 5124:case 35670:return Er;case 35667:case 35671:return Fr;case 35668:case 35672:return Gr;case 35669:case 35673:return Hr;case 35678:case 36198:case 36298:case 36306:case 35682:return Or;case 35680:case 36300:case 36308:case 36293:return Pr;}}function Rr(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=Cr(t.type)}function ep(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=Qr(t.type)}function dp(e){this.id=e,this.seq=[],this.map={}}ep.prototype.updateCache=function(e){let t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),hb(t,e)},dp.prototype.setValue=function(e,t,r){const o=this.seq;for(let n=0,i=o.length;n!==i;++n){const i=o[n];i.setValue(e,t[i.id],r)}};const Sj=/([\w\d_]+)(\])?(\[|\.)?/g;function cp(e,t){e.seq.push(t),e.map[t.id]=t}function Wr(e,t,r){const o=e.name,n=o.length;for(Sj.lastIndex=0;;){const i=Sj.exec(o),a=Sj.lastIndex;let s=i[1],l="]"===i[2],$=i[3];if(l&&(s|=0),void 0===$||"["===$&&a+2===n){cp(r,void 0===$?new Rr(s,e,t):new ep(s,e,t));break}{let e=r.map[s];void 0===e&&cp(r,e=new dp(s)),r=e}}}function tc(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let o=0;o<r;++o){const r=e.getActiveUniform(t,o);Wr(r,e.getUniformLocation(t,r.name),this)}}function ap(e,t,r){const o=e.createShader(t);return e.shaderSource(o,r),e.compileShader(o),o}tc.prototype.setValue=function(e,t,r,o){const n=this.map[t];void 0!==n&&n.setValue(e,r,o)},tc.prototype.setOptional=function(e,t,r){const o=t[r];void 0!==o&&this.setValue(e,r,o)},tc.upload=function(e,t,r,o){for(let n=0,i=t.length;n!==i;++n){const i=t[n],a=r[i.id];!1!==a.needsUpdate&&i.setValue(e,a.value,o)}},tc.seqWithValue=function(e,t){const r=[];for(let o=0,n=e.length;o!==n;++o){const n=e[o];n.id in t&&r.push(n)}return r};let Zr=0;function $r(e){const t=e.split("\n");for(let r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}function _o(e){switch(e){case $a:return["Linear","( value )"];case di:return["sRGB","( value )"];case Lk:return["RGBE","( value )"];case dl:return["RGBM","( value, 7.0 )"];case el:return["RGBM","( value, 16.0 )"];case fl:return["RGBD","( value, 256.0 )"];case Mk:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case OA:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"];}}function $o(e,t,r){const o=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();return o&&""===n?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+n+$r(e.getShaderSource(t))}function uf(e,t){const r=_o(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function cs(e,t){const r=_o(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function ds(e,t){let r;switch(t){case Ex:r="Linear";break;case Gx:r="Reinhard";break;case Hx:r="OptimizedCineon";break;case Ix:r="ACESFilmic";break;case Jx:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear";}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function es(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(tf).join("\n")}function fs(e){const t=[];for(const r in e){const o=e[r];!1!==o&&t.push("#define "+r+" "+o)}return t.join("\n")}function gs(e,t){const r={},o=e.getProgramParameter(t,35721);for(let n=0;n<o;n++){const o=e.getActiveAttrib(t,n).name;r[o]=e.getAttribLocation(t,o)}return r}function tf(e){return""!==e}function Zo(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Yo(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const ks=/^[ \t]*#include +<([\w\d.\/]+)>/gm;function Nj(e){return e.replace(ks,ms)}function ms(e,t){const r=oa[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return Nj(r)}const ns=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,os=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function Xo(e){return e.replace(os,Wo).replace(ns,qs)}function qs(e,t,r,o){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Wo(e,t,r,o)}function Wo(e,t,r,o){let n="";for(let i=parseInt(t);i<parseInt(r);i++)n+=o.replace(/\[ i \]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return n}function Vo(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function ts(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===cn?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===_w?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Yf&&(t="SHADOWMAP_TYPE_VSM"),t}function us(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case wj:case xj:t="ENVMAP_TYPE_CUBE";break;case kg:case Bj:t="ENVMAP_TYPE_CUBE_UV";break;case rm:case zj:t="ENVMAP_TYPE_EQUIREC";}return t}function vs(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case xj:case zj:t="ENVMAP_MODE_REFRACTION";}return t}function ws(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Ug:t="ENVMAP_BLENDING_MULTIPLY";break;case Cx:t="ENVMAP_BLENDING_MIX";break;case Dx:t="ENVMAP_BLENDING_ADD";}return t}function xs(e,t,r,o){const n=e.getContext(),i=r.defines;let a=r.vertexShader,s=r.fragmentShader;const l=ts(r),$=us(r),c=vs(r),p=ws(r),u=e.gammaFactor>0?e.gammaFactor:1,h=r.isWebGL2?"":es(r),d=fs(i),f=n.createProgram();let m,x;if(r.isRawShaderMaterial?((m=[d].filter(tf).join("\n")).length>0&&(m+="\n"),(x=[h,d].filter(tf).join("\n")).length>0&&(x+="\n")):(m=[Vo(r),"#define SHADER_NAME "+r.shaderName,d,r.instancing?"#define USE_INSTANCING":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+u,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(tf).join("\n"),x=[h,Vo(r),"#define SHADER_NAME "+r.shaderName,d,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+u,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+$:"",r.envMap?"#define "+c:"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==Md?"#define TONE_MAPPING":"",r.toneMapping!==Md?oa.tonemapping_pars_fragment:"",r.toneMapping!==Md?ds("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",oa.encodings_pars_fragment,r.map?uf("mapTexelToLinear",r.mapEncoding):"",r.matcap?uf("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?uf("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?uf("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMap?uf("lightMapTexelToLinear",r.lightMapEncoding):"",cs("linearToOutputTexel",r.outputEncoding),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(tf).join("\n")),a=Yo(a=Zo(a=Nj(a),r),r),s=Yo(s=Zo(s=Nj(s),r),r),a=Xo(a),s=Xo(s),r.isWebGL2&&!r.isRawShaderMaterial){let e=!1;const t=/^\s*#version\s+300\s+es\s*\n/;r.isShaderMaterial&&null!==a.match(t)&&null!==s.match(t)&&(e=!0,a=a.replace(t,""),s=s.replace(t,"")),m=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,x=["#version 300 es\n","#define varying in",e?"":"out highp vec4 pc_fragColor;",e?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x}const g=x+s,v=ap(n,35633,m+a),F=ap(n,35632,g);if(n.attachShader(f,v),n.attachShader(f,F),void 0!==r.index0AttributeName?n.bindAttribLocation(f,0,r.index0AttributeName):!0===r.morphTargets&&n.bindAttribLocation(f,0,"position"),n.linkProgram(f),e.debug.checkShaderErrors){const e=n.getProgramInfoLog(f).trim(),t=n.getShaderInfoLog(v).trim(),r=n.getShaderInfoLog(F).trim();let o=!0,i=!0;if(!1===n.getProgramParameter(f,35714)){o=!1;const t=$o(n,v,"vertex"),r=$o(n,F,"fragment");console.error("THREE.WebGLProgram: shader error: ",n.getError(),"35715",n.getProgramParameter(f,35715),"gl.getProgramInfoLog",e,t,r)}else""!==e?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):""!==t&&""!==r||(i=!1);i&&(this.diagnostics={runnable:o,programLog:e,vertexShader:{log:t,prefix:m},fragmentShader:{log:r,prefix:x}})}let K,y;return n.deleteShader(v),n.deleteShader(F),this.getUniforms=function(){return void 0===K&&(K=new tc(n,f)),K},this.getAttributes=function(){return void 0===y&&(y=gs(n,f)),y},this.destroy=function(){o.releaseStatesOfProgram(this),n.deleteProgram(f),this.program=void 0},this.name=r.shaderName,this.id=Zr++,this.cacheKey=t,this.usedTimes=1,this.program=f,this.vertexShader=v,this.fragmentShader=F,this}function ys(e,t,r,o){const n=[],i=r.isWebGL2,a=r.logarithmicDepthBuffer,s=r.floatVertexTextures,l=r.maxVertexUniforms,$=r.vertexTextures;let c=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},u=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function h(e){let t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=$a,t}return{getParameters:function(o,n,u,d,f,m,x){const g=d.fog,v=o.isMeshStandardMaterial?d.environment:null,F=o.envMap||v,K=p[o.type],y=x.isSkinnedMesh?function(e){const t=e.skeleton.bones;if(s)return 1024;{const e=l,r=Math.floor((e-20)/4),o=Math.min(r,t.length);return o<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+o+"."),0):o}}(x):0;null!==o.precision&&(c=r.getMaxPrecision(o.precision))!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",c,"instead.");const _=function(e,t){let r;if(t){const o=lc[t];r={name:e.name||e.type,uniforms:ov.clone(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader}}else r={name:e.name||e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return r}(o,K);o.onBeforeCompile(_,e);const b=e.getRenderTarget();return{isWebGL2:i,shaderID:K,shaderName:_.name,uniforms:_.uniforms,vertexShader:_.vertexShader,fragmentShader:_.fragmentShader,defines:o.defines,isRawShaderMaterial:o.isRawShaderMaterial,isShaderMaterial:o.isShaderMaterial,precision:c,instancing:!0===x.isInstancedMesh,supportsVertexTextures:$,outputEncoding:null!==b?h(b.texture):e.outputEncoding,map:!!o.map,mapEncoding:h(o.map),matcap:!!o.matcap,matcapEncoding:h(o.matcap),envMap:!!F,envMapMode:F&&F.mapping,envMapEncoding:h(F),envMapCubeUV:!!F&&(F.mapping===kg||F.mapping===Bj),lightMap:!!o.lightMap,lightMapEncoding:h(o.lightMap),aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,emissiveMapEncoding:h(o.emissiveMap),bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===jA,tangentSpaceNormalMap:o.normalMapType===Jd,clearcoatMap:!!o.clearcoatMap,clearcoatRoughnessMap:!!o.clearcoatRoughnessMap,clearcoatNormalMap:!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,alphaMap:!!o.alphaMap,gradientMap:!!o.gradientMap,sheen:!!o.sheen,combine:o.combine,vertexTangents:o.normalMap&&o.vertexTangents,vertexColors:o.vertexColors,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.displacementMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||!o.displacementMap),fog:!!g,useFog:o.fog,fogExp2:g&&g.isFogExp2,flatShading:o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:a,skinning:o.skinning&&y>0,maxBones:y,useVertexTexture:s,morphTargets:o.morphTargets,morphNormals:o.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numDirLightShadows:n.directionalShadowMap.length,numPointLightShadows:n.pointShadowMap.length,numSpotLightShadows:n.spotShadowMap.length,numClippingPlanes:f,numClipIntersection:m,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:o.toneMapped?e.toneMapping:Md,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,alphaTest:o.alphaTest,doubleSided:o.side===Bg,flipSided:o.side===Oa,depthPacking:void 0!==o.depthPacking&&o.depthPacking,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==t.get("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(t){const r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(const e in t.defines)r.push(e),r.push(t.defines[e]);if(void 0===t.isRawShaderMaterial){for(let e=0;e<u.length;e++)r.push(t[u[e]]);r.push(e.outputEncoding),r.push(e.gammaFactor)}return r.push(t.customProgramCacheKey),r.join()},acquireProgram:function(t,r){let i;for(let e=0,o=n.length;e<o;e++){const t=n[e];if(t.cacheKey===r){++(i=t).usedTimes;break}}return void 0===i&&(i=new xs(e,r,t,o),n.push(i)),i},releaseProgram:function(e){if(0==--e.usedTimes){const t=n.indexOf(e);n[t]=n[n.length-1],n.pop(),e.destroy()}},programs:n}}function zs(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,o){e.get(t)[r]=o},dispose:function(){e=new WeakMap}}}function As(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Bs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Uo(){const e=[];let t=0;const r=[],o=[],n={id:-1};function i(r,o,i,a,s,l){let $=e[t];return void 0===$?($={id:r.id,object:r,geometry:o,material:i,program:i.program||n,groupOrder:a,renderOrder:r.renderOrder,z:s,group:l},e[t]=$):($.id=r.id,$.object=r,$.geometry=o,$.material=i,$.program=i.program||n,$.groupOrder=a,$.renderOrder=r.renderOrder,$.z=s,$.group=l),t++,$}return{opaque:r,transparent:o,init:function(){t=0,r.length=0,o.length=0},push:function(e,t,n,a,s,l){const $=i(e,t,n,a,s,l);(!0===n.transparent?o:r).push($)},unshift:function(e,t,n,a,s,l){const $=i(e,t,n,a,s,l);(!0===n.transparent?o:r).unshift($)},finish:function(){for(let r=t,o=e.length;r<o;r++){const t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.program=null,t.group=null}},sort:function(e,t){r.length>1&&r.sort(e||As),o.length>1&&o.sort(t||Bs)}}}function Ds(){let e=new WeakMap;function t(r){const o=r.target;o.removeEventListener("dispose",t),e.delete(o)}return{get:function(r,o){const n=e.get(r);let i;return void 0===n?(i=new Uo,e.set(r,new WeakMap),e.get(r).set(o,i),r.addEventListener("dispose",t)):void 0===(i=n.get(o))&&(i=new Uo,n.set(o,i)),i},dispose:function(){e=new WeakMap}}}function Es(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new aa,color:new ha};break;case"SpotLight":r={position:new aa,direction:new aa,color:new ha,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new aa,color:new ha,distance:0,decay:0};break;case"HemisphereLight":r={direction:new aa,skyColor:new ha,groundColor:new ha};break;case"RectAreaLight":r={color:new ha,position:new aa,halfWidth:new aa,halfHeight:new aa};}return e[t.id]=r,r}}}function Fs(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ca};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ca,shadowCameraNear:1,shadowCameraFar:1e3};}return e[t.id]=r,r}}}let Gs=0;function Hs(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Is(){const e=new Es,t=Fs(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let a=0;a<9;a++)r.probe.push(new aa);const o=new aa,n=new na,i=new na;return{setup:function(a,s,l){let $=0,c=0,p=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let u=0,h=0,d=0,f=0,m=0,x=0,g=0,v=0;const F=l.matrixWorldInverse;a.sort(Hs);for(let y=0,_=a.length;y<_;y++){const s=a[y],l=s.color,K=s.intensity,_=s.distance,b=s.shadow&&s.shadow.map?s.shadow.map.texture:null;if(s.isAmbientLight)$+=l.r*K,c+=l.g*K,p+=l.b*K;else if(s.isLightProbe)for(let e=0;e<9;e++)r.probe[e].addScaledVector(s.sh.coefficients[e],K);else if(s.isDirectionalLight){const n=e.get(s);if(n.color.copy(s.color).multiplyScalar(s.intensity),n.direction.setFromMatrixPosition(s.matrixWorld),o.setFromMatrixPosition(s.target.matrixWorld),n.direction.sub(o),n.direction.transformDirection(F),s.castShadow){const e=s.shadow,o=t.get(s);o.shadowBias=e.bias,o.shadowNormalBias=e.normalBias,o.shadowRadius=e.radius,o.shadowMapSize=e.mapSize,r.directionalShadow[u]=o,r.directionalShadowMap[u]=b,r.directionalShadowMatrix[u]=s.shadow.matrix,x++}r.directional[u]=n,u++}else if(s.isSpotLight){const n=e.get(s);if(n.position.setFromMatrixPosition(s.matrixWorld),n.position.applyMatrix4(F),n.color.copy(l).multiplyScalar(K),n.distance=_,n.direction.setFromMatrixPosition(s.matrixWorld),o.setFromMatrixPosition(s.target.matrixWorld),n.direction.sub(o),n.direction.transformDirection(F),n.coneCos=Math.cos(s.angle),n.penumbraCos=Math.cos(s.angle*(1-s.penumbra)),n.decay=s.decay,s.castShadow){const e=s.shadow,o=t.get(s);o.shadowBias=e.bias,o.shadowNormalBias=e.normalBias,o.shadowRadius=e.radius,o.shadowMapSize=e.mapSize,r.spotShadow[d]=o,r.spotShadowMap[d]=b,r.spotShadowMatrix[d]=s.shadow.matrix,v++}r.spot[d]=n,d++}else if(s.isRectAreaLight){const t=e.get(s);t.color.copy(l).multiplyScalar(K),t.position.setFromMatrixPosition(s.matrixWorld),t.position.applyMatrix4(F),i.identity(),n.copy(s.matrixWorld),n.premultiply(F),i.extractRotation(n),t.halfWidth.set(.5*s.width,0,0),t.halfHeight.set(0,.5*s.height,0),t.halfWidth.applyMatrix4(i),t.halfHeight.applyMatrix4(i),r.rectArea[f]=t,f++}else if(s.isPointLight){const o=e.get(s);if(o.position.setFromMatrixPosition(s.matrixWorld),o.position.applyMatrix4(F),o.color.copy(s.color).multiplyScalar(s.intensity),o.distance=s.distance,o.decay=s.decay,s.castShadow){const e=s.shadow,o=t.get(s);o.shadowBias=e.bias,o.shadowNormalBias=e.normalBias,o.shadowRadius=e.radius,o.shadowMapSize=e.mapSize,o.shadowCameraNear=e.camera.near,o.shadowCameraFar=e.camera.far,r.pointShadow[h]=o,r.pointShadowMap[h]=b,r.pointShadowMatrix[h]=s.shadow.matrix,g++}r.point[h]=o,h++}else if(s.isHemisphereLight){const t=e.get(s);t.direction.setFromMatrixPosition(s.matrixWorld),t.direction.transformDirection(F),t.direction.normalize(),t.skyColor.copy(s.color).multiplyScalar(K),t.groundColor.copy(s.groundColor).multiplyScalar(K),r.hemi[m]=t,m++}}r.ambient[0]=$,r.ambient[1]=c,r.ambient[2]=p;const K=r.hash;K.directionalLength===u&&K.pointLength===h&&K.spotLength===d&&K.rectAreaLength===f&&K.hemiLength===m&&K.numDirectionalShadows===x&&K.numPointShadows===g&&K.numSpotShadows===v||(r.directional.length=u,r.spot.length=d,r.rectArea.length=f,r.point.length=h,r.hemi.length=m,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=g,r.spotShadowMatrix.length=v,K.directionalLength=u,K.pointLength=h,K.spotLength=d,K.rectAreaLength=f,K.hemiLength=m,K.numDirectionalShadows=x,K.numPointShadows=g,K.numSpotShadows=v,r.version=Gs++)},state:r}}function To(){const e=new Is,t=[],r=[];return{init:function(){t.length=0,r.length=0},state:{lightsArray:t,shadowsArray:r,lights:e},setupLights:function(o){e.setup(t,r,o)},pushLight:function(e){t.push(e)},pushShadow:function(e){r.push(e)}}}function Ks(){let e=new WeakMap;function t(r){const o=r.target;o.removeEventListener("dispose",t),e.delete(o)}return{get:function(r,o){let n;return!1===e.has(r)?(n=new To,e.set(r,new WeakMap),e.get(r).set(o,n),r.addEventListener("dispose",t)):!1===e.get(r).has(o)?(n=new To,e.get(r).set(o,n)):n=e.get(r).get(o),n},dispose:function(){e=new WeakMap}}}function nd(e){ja.call(this),this.type="MeshDepthMaterial",this.depthPacking=EA,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function md(e){ja.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new aa,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}nd.prototype=Object.create(ja.prototype),nd.prototype.constructor=nd,nd.prototype.isMeshDepthMaterial=!0,nd.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},md.prototype=Object.create(ja.prototype),md.prototype.constructor=md,md.prototype.isMeshDistanceMaterial=!0,md.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};var Ns="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",Os="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function So(e,t,r){let o=new Hf;const n=new ca,i=new ca,a=new sa,s=[],l=[],$={},c={0:Oa,1:Wf,2:Bg},p=new Sa({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new ca},radius:{value:4}},vertexShader:Os,fragmentShader:Ns}),u=p.clone();u.defines.HORIZONAL_PASS=1;const h=new ga;h.setAttribute("position",new ka(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const d=new ua(h,p),f=this;function m(r,o){const n=t.update(d);p.uniforms.shadow_pass.value=r.map.texture,p.uniforms.resolution.value=r.mapSize,p.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(o,null,n,p,d,null),u.uniforms.shadow_pass.value=r.mapPass.texture,u.uniforms.resolution.value=r.mapSize,u.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(o,null,n,u,d,null)}function x(e,t,r){const o=e<<0|t<<1|r<<2;let n=s[o];return void 0===n&&(n=new nd({depthPacking:uA,morphTargets:e,skinning:t}),s[o]=n),n}function g(e,t,r){const o=e<<0|t<<1|r<<2;let n=l[o];return void 0===n&&(n=new md({morphTargets:e,skinning:t}),l[o]=n),n}function v(t,r,o,n,i,a,s){let l=null,p=x,u=t.customDepthMaterial;if(!0===n.isPointLight&&(p=g,u=t.customDistanceMaterial),void 0===u){let e=!1;!0===o.morphTargets&&(e=r.morphAttributes&&r.morphAttributes.position&&r.morphAttributes.position.length>0);let n=!1;!0===t.isSkinnedMesh&&(!0===o.skinning?n=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),l=p(e,n,!0===t.isInstancedMesh)}else l=u;if(e.localClippingEnabled&&!0===o.clipShadows&&0!==o.clippingPlanes.length){const e=l.uuid,t=o.uuid;let r=$[e];void 0===r&&(r={},$[e]=r);let n=r[t];void 0===n&&(n=l.clone(),r[t]=n),l=n}return l.visible=o.visible,l.wireframe=o.wireframe,l.side=s===Yf?null!==o.shadowSide?o.shadowSide:o.side:null!==o.shadowSide?o.shadowSide:c[o.side],l.clipShadows=o.clipShadows,l.clippingPlanes=o.clippingPlanes,l.clipIntersection=o.clipIntersection,l.wireframeLinewidth=o.wireframeLinewidth,l.linewidth=o.linewidth,!0===n.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(n.matrixWorld),l.nearDistance=i,l.farDistance=a),l}function F(r,n,i,a,s){if(!1===r.visible)return;if(r.layers.test(n.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&s===Yf)&&(!r.frustumCulled||o.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,r.matrixWorld);const o=t.update(r),n=r.material;if(Array.isArray(n)){const t=o.groups;for(let l=0,$=t.length;l<$;l++){const $=t[l],c=n[$.materialIndex];if(c&&c.visible){const t=v(r,o,c,a,i.near,i.far,s);e.renderBufferDirect(i,null,o,t,r,$)}}}else if(n.visible){const t=v(r,o,n,a,i.near,i.far,s);e.renderBufferDirect(i,null,o,t,r,null)}}const l=r.children;for(let e=0,t=l.length;e<t;e++)F(l[e],n,i,a,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=cn,this.render=function(t,s,l){if(!1===f.enabled)return;if(!1===f.autoUpdate&&!1===f.needsUpdate)return;if(0===t.length)return;const $=e.getRenderTarget(),c=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),u=e.state;u.setBlending(Ic),u.buffers.color.setClear(1,1,1,1),u.buffers.depth.setTest(!0),u.setScissorTest(!1);for(let h=0,d=t.length;h<d;h++){const $=t[h],c=$.shadow;if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;if(void 0===c){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}n.copy(c.mapSize);const p=c.getFrameExtents();if(n.multiply(p),i.copy(c.mapSize),(n.x>r||n.y>r)&&(n.x>r&&(i.x=Math.floor(r/p.x),n.x=i.x*p.x,c.mapSize.x=i.x),n.y>r&&(i.y=Math.floor(r/p.y),n.y=i.y*p.y,c.mapSize.y=i.y)),null===c.map&&!c.isPointLightShadow&&this.type===Yf){const e={minFilter:Na,magFilter:Na,format:Cb};c.map=new vb(n.x,n.y,e),c.map.texture.name=$.name+".shadowMap",c.mapPass=new vb(n.x,n.y,e),c.camera.updateProjectionMatrix()}if(null===c.map){const e={minFilter:Pa,magFilter:Pa,format:Cb};c.map=new vb(n.x,n.y,e),c.map.texture.name=$.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const d=c.getViewportCount();for(let e=0;e<d;e++){const t=c.getViewport(e);a.set(i.x*t.x,i.y*t.y,i.x*t.z,i.y*t.w),u.viewport(a),c.updateMatrices($,e),o=c.getFrustum(),F(s,l,c.camera,$,this.type)}c.isPointLightShadow||this.type!==Yf||m(c,l),c.needsUpdate=!1}f.needsUpdate=!1,e.setRenderTarget($,c,p)}}function Qs(e,t,r){const o=r.isWebGL2;const n=new function(){let t=!1;const r=new sa;let o=null;const n=new sa(0,0,0,0);return{setMask:function(r){o===r||t||(e.colorMask(r,r,r,r),o=r)},setLocked:function(e){t=e},setClear:function(t,o,i,a,s){!0===s&&(t*=a,o*=a,i*=a),r.set(t,o,i,a),!1===n.equals(r)&&(e.clearColor(t,o,i,a),n.copy(r))},reset:function(){t=!1,o=null,n.set(-1,0,0,0)}}},i=new function(){let t=!1,r=null,o=null,n=null;return{setTest:function(e){e?R(2929):B(2929)},setMask:function(o){r===o||t||(e.depthMask(o),r=o)},setFunc:function(t){if(o!==t){if(t)switch(t){case rx:e.depthFunc(512);break;case sx:e.depthFunc(519);break;case tx:e.depthFunc(513);break;case ij:e.depthFunc(515);break;case ux:e.depthFunc(514);break;case yx:e.depthFunc(518);break;case Ax:e.depthFunc(516);break;case Bx:e.depthFunc(517);break;default:e.depthFunc(515);}else e.depthFunc(515);o=t}},setLocked:function(e){t=e},setClear:function(t){n!==t&&(e.clearDepth(t),n=t)},reset:function(){t=!1,r=null,o=null,n=null}}},a=new function(){let t=!1,r=null,o=null,n=null,i=null,a=null,s=null,l=null,$=null;return{setTest:function(e){t||(e?R(2960):B(2960))},setMask:function(o){r===o||t||(e.stencilMask(o),r=o)},setFunc:function(t,r,a){o===t&&n===r&&i===a||(e.stencilFunc(t,r,a),o=t,n=r,i=a)},setOp:function(t,r,o){a===t&&s===r&&l===o||(e.stencilOp(t,r,o),a=t,s=r,l=o)},setLocked:function(e){t=e},setClear:function(t){$!==t&&(e.clearStencil(t),$=t)},reset:function(){t=!1,r=null,o=null,n=null,i=null,a=null,s=null,l=null,$=null}}};let s={},l=null,$=null,c=null,p=null,u=null,h=null,d=null,f=null,m=null,x=!1,g=null,v=null,F=null,K=null,y=null;const _=e.getParameter(35661);let b=!1,M=0;const w=e.getParameter(7938);-1!==w.indexOf("WebGL")?(M=parseFloat(/^WebGL\ ([0-9])/.exec(w)[1]),b=M>=1):-1!==w.indexOf("OpenGL ES")&&(M=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(w)[1]),b=M>=2);let S=null,T={};const A=new sa,E=new sa;function L(t,r,o){const n=new Uint8Array(4),i=e.createTexture();e.bindTexture(t,i),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let a=0;a<o;a++)e.texImage2D(r+a,0,6408,1,1,0,6408,5121,n);return i}const C={};function R(t){!0!==s[t]&&(e.enable(t),s[t]=!0)}function B(t){!1!==s[t]&&(e.disable(t),s[t]=!1)}C[3553]=L(3553,3553,1),C[34067]=L(34067,34069,6),n.setClear(0,0,0,1),i.setClear(1),a.setClear(0),R(2929),i.setFunc(ij),I(!1),O(en),R(2884),D(Ic);const P={[Ee]:32774,[dx]:32778,[ex]:32779};if(o){}else{const e=t.get("EXT_blend_minmax");null!==e&&e.MAX_EXT}const G={[gx]:0,[hx]:1,[ix]:768,[Qm]:770,[qx]:776,[ox]:774,[kx]:772,[jx]:769,[Pm]:771,[px]:775,[nx]:773};function D(t,r,o,n,i,a,s,l){if(t!==Ic){if($||(R(3042),$=!0),t===bx)i=i||r,a=a||o,s=s||n,r===p&&i===d||(e.blendEquationSeparate(P[r],P[i]),p=r,d=i),o===u&&n===h&&a===f&&s===m||(e.blendFuncSeparate(G[o],G[n],G[a],G[s]),u=o,h=n,f=a,m=s),c=t,x=null;else if(t!==c||l!==x){if(p===Ee&&d===Ee||(e.blendEquation(32774),p=Ee,d=Ee),l)switch(t){case Sf:e.blendFuncSeparate(1,771,1,771);break;case an:e.blendFunc(1,1);break;case _m:e.blendFuncSeparate(0,0,769,771);break;case $m:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t);}else switch(t){case Sf:e.blendFuncSeparate(770,771,1,771);break;case an:e.blendFunc(770,1);break;case _m:e.blendFunc(0,769);break;case $m:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t);}u=null,h=null,f=null,m=null,c=t,x=l}}else $&&(B(3042),$=!1)}function I(t){g!==t&&(t?e.frontFace(2304):e.frontFace(2305),g=t)}function O(t){t!==Yw?(R(2884),t!==v&&(t===en?e.cullFace(1029):t===Zw?e.cullFace(1028):e.cullFace(1032))):B(2884),v=t}function N(t,r,o){t?(R(32823),K===r&&y===o||(e.polygonOffset(r,o),K=r,y=o)):B(32823)}function V(t){void 0===t&&(t=33984+_-1),S!==t&&(e.activeTexture(t),S=t)}return{buffers:{color:n,depth:i,stencil:a},enable:R,disable:B,useProgram:function(t){return l!==t&&(e.useProgram(t),l=t,!0)},setBlending:D,setMaterial:function(e,t){e.side===Bg?B(2884):R(2884);let r=e.side===Oa;t&&(r=!r),I(r),e.blending===Sf&&!1===e.transparent?D(Ic):D(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),n.setMask(e.colorWrite);const o=e.stencilWrite;a.setTest(o),o&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),N(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:I,setCullFace:O,setLineWidth:function(t){t!==F&&(b&&e.lineWidth(t),F=t)},setPolygonOffset:N,setScissorTest:function(e){e?R(3089):B(3089)},activeTexture:V,bindTexture:function(t,r){null===S&&V();let o=T[S];void 0===o&&(o={type:void 0,texture:void 0},T[S]=o),o.type===t&&o.texture===r||(e.bindTexture(t,r||C[t]),o.type=t,o.texture=r)},unbindTexture:function(){const t=T[S];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===A.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),A.copy(t))},viewport:function(t){!1===E.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),E.copy(t))},reset:function(){s={},S=null,T={},l=null,c=null,g=null,v=null,n.reset(),i.reset(),a.reset()}}}function Rs(e,t,r,o,n,i,a){const s=n.isWebGL2,l=n.maxTextures,$=n.maxCubemapSize,c=n.maxTextureSize,p=n.maxSamples,u=new WeakMap;let h,d=!1;try{d="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(O){}function f(e,t){return d?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function m(e,t,r,o){let n=1;if((e.width>o||e.height>o)&&(n=o/Math.max(e.width,e.height)),n<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const o=t?ma.floorPowerOfTwo:Math.floor,i=o(n*e.width),a=o(n*e.height);void 0===h&&(h=f(i,a));const s=r?f(i,a):h;return s.width=i,s.height=a,s.getContext("2d").drawImage(e,0,0,i,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+i+"x"+a+")."),s}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function x(e){return ma.isPowerOfTwo(e.width)&&ma.isPowerOfTwo(e.height)}function g(e,t){return e.generateMipmaps&&t&&e.minFilter!==Pa&&e.minFilter!==Na}function v(t,r,n,i){e.generateMipmap(t),o.get(r).__maxMipLevel=Math.log(Math.max(n,i))*Math.LOG2E}function F(r,o,n){if(!1===s)return o;if(null!==r){if(void 0!==e[r])return e[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let i=o;return 6403===o&&(5126===n&&(i=33326),5131===n&&(i=33325),5121===n&&(i=33321)),6407===o&&(5126===n&&(i=34837),5131===n&&(i=34843),5121===n&&(i=32849)),6408===o&&(5126===n&&(i=34836),5131===n&&(i=34842),5121===n&&(i=32856)),33325!==i&&33326!==i&&34842!==i&&34836!==i||t.get("EXT_color_buffer_float"),i}function K(e){return e===Pa||e===Gj||e===Hj?9728:9729}function y(t){const r=t.target;r.removeEventListener("dispose",y),function(t){const r=o.get(t);if(void 0===r.__webglInit)return;e.deleteTexture(r.__webglTexture),o.remove(t)}(r),r.isVideoTexture&&u.delete(r),a.memory.textures--}function _(t){const r=t.target;r.removeEventListener("dispose",_),function(t){const r=o.get(t),n=o.get(t.texture);if(!t)return;void 0!==n.__webglTexture&&e.deleteTexture(n.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let o=0;o<6;o++)e.deleteFramebuffer(r.__webglFramebuffer[o]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[o]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&e.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer);o.remove(t.texture),o.remove(t)}(r),a.memory.textures--}let b=0;function M(e,t){const n=o.get(e);if(e.isVideoTexture&&function(e){const t=a.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(e),e.version>0&&n.__version!==e.version){const r=e.image;if(void 0===r)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==r.complete)return void C(n,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.activeTexture(33984+t),r.bindTexture(3553,n.__webglTexture)}function w(t,n){if(6!==t.image.length)return;const a=o.get(t);if(t.version>0&&a.__version!==t.version){L(a,t),r.activeTexture(33984+n),r.bindTexture(34067,a.__webglTexture),e.pixelStorei(37440,t.flipY);const o=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),l=t.image[0]&&t.image[0].isDataTexture,c=[];for(let e=0;e<6;e++)c[e]=o||l?l?t.image[e].image:t.image[e]:m(t.image[e],!1,!0,$);const p=c[0],u=x(p)||s,h=i.convert(t.format),d=i.convert(t.type),f=F(t.internalFormat,h,d);let K;if(E(34067,t,u),o){for(let e=0;e<6;e++){K=c[e].mipmaps;for(let o=0;o<K.length;o++){const n=K[o];t.format!==Cb&&t.format!==ad?null!==h?r.compressedTexImage2D(34069+e,o,f,n.width,n.height,0,n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(34069+e,o,f,n.width,n.height,0,h,d,n.data)}}a.__maxMipLevel=K.length-1}else{K=t.mipmaps;for(let e=0;e<6;e++)if(l){r.texImage2D(34069+e,0,f,c[e].width,c[e].height,0,h,d,c[e].data);for(let t=0;t<K.length;t++){const o=K[t].image[e].image;r.texImage2D(34069+e,t+1,f,o.width,o.height,0,h,d,o.data)}}else{r.texImage2D(34069+e,0,f,h,d,c[e]);for(let t=0;t<K.length;t++){const o=K[t];r.texImage2D(34069+e,t+1,f,h,d,o.image[e])}}a.__maxMipLevel=K.length}g(t,u)&&v(34067,t,p.width,p.height),a.__version=t.version,t.onUpdate&&t.onUpdate(t)}else r.activeTexture(33984+n),r.bindTexture(34067,a.__webglTexture)}function S(e,t){r.activeTexture(33984+t),r.bindTexture(34067,o.get(e).__webglTexture)}const T={[ah]:10497,[cb]:33071,[ch]:33648},A={[Pa]:9728,[Gj]:9984,[Hj]:9986,[Na]:9729,[qm]:9985,[gh]:9987};function E(r,i,a){a?(e.texParameteri(r,10242,T[i.wrapS]),e.texParameteri(r,10243,T[i.wrapT]),32879!==r&&35866!==r||e.texParameteri(r,32882,T[i.wrapR]),e.texParameteri(r,10240,A[i.magFilter]),e.texParameteri(r,10241,A[i.minFilter])):(e.texParameteri(r,10242,33071),e.texParameteri(r,10243,33071),32879!==r&&35866!==r||e.texParameteri(r,32882,33071),i.wrapS===cb&&i.wrapT===cb||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(r,10240,K(i.magFilter)),e.texParameteri(r,10241,K(i.minFilter)),i.minFilter!==Pa&&i.minFilter!==Na&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const l=t.get("EXT_texture_filter_anisotropic");if(l){if(i.type===Dc&&null===t.get("OES_texture_float_linear"))return;if(i.type===oh&&null===(s||t.get("OES_texture_half_float_linear")))return;(i.anisotropy>1||o.get(i).__currentAnisotropy)&&(e.texParameterf(r,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,n.getMaxAnisotropy())),o.get(i).__currentAnisotropy=i.anisotropy)}}function L(t,r){void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",y),t.__webglTexture=e.createTexture(),a.memory.textures++)}function C(t,o,n){let a=3553;o.isDataTexture2DArray&&(a=35866),o.isDataTexture3D&&(a=32879),L(t,o),r.activeTexture(33984+n),r.bindTexture(a,t.__webglTexture),e.pixelStorei(37440,o.flipY),e.pixelStorei(37441,o.premultiplyAlpha),e.pixelStorei(3317,o.unpackAlignment);const l=function(e){return!s&&(e.wrapS!==cb||e.wrapT!==cb||e.minFilter!==Pa&&e.minFilter!==Na)}(o)&&!1===x(o.image),$=m(o.image,l,!1,c),p=x($)||s,u=i.convert(o.format);let h,d=i.convert(o.type),f=F(o.internalFormat,u,d);E(a,o,p);const K=o.mipmaps;if(o.isDepthTexture)f=6402,s?f=o.type===Dc?36012:o.type===mh?33190:o.type===Bf?35056:33189:o.type===Dc&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),o.format===yd&&6402===f&&o.type!==kh&&o.type!==mh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),o.type=kh,d=i.convert(o.type)),o.format===cf&&6402===f&&(f=34041,o.type!==Bf&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),o.type=Bf,d=i.convert(o.type))),r.texImage2D(3553,0,f,$.width,$.height,0,u,d,null);else if(o.isDataTexture){if(K.length>0&&p){for(let e=0,t=K.length;e<t;e++)h=K[e],r.texImage2D(3553,e,f,h.width,h.height,0,u,d,h.data);o.generateMipmaps=!1,t.__maxMipLevel=K.length-1}else r.texImage2D(3553,0,f,$.width,$.height,0,u,d,$.data),t.__maxMipLevel=0;}else if(o.isCompressedTexture){for(let e=0,t=K.length;e<t;e++)h=K[e],o.format!==Cb&&o.format!==ad?null!==u?r.compressedTexImage2D(3553,e,f,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(3553,e,f,h.width,h.height,0,u,d,h.data);t.__maxMipLevel=K.length-1}else if(o.isDataTexture2DArray)r.texImage3D(35866,0,f,$.width,$.height,$.depth,0,u,d,$.data),t.__maxMipLevel=0;else if(o.isDataTexture3D)r.texImage3D(32879,0,f,$.width,$.height,$.depth,0,u,d,$.data),t.__maxMipLevel=0;else if(K.length>0&&p){for(let e=0,t=K.length;e<t;e++)h=K[e],r.texImage2D(3553,e,f,u,d,h);o.generateMipmaps=!1,t.__maxMipLevel=K.length-1}else r.texImage2D(3553,0,f,u,d,$),t.__maxMipLevel=0;g(o,p)&&v(a,o,$.width,$.height),t.__version=o.version,o.onUpdate&&o.onUpdate(o)}function R(t,n,a,s){const l=i.convert(n.texture.format),$=i.convert(n.texture.type),c=F(n.texture.internalFormat,l,$);r.texImage2D(s,0,c,n.width,n.height,0,l,$,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,a,s,o.get(n.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function B(t,r,o){if(e.bindRenderbuffer(36161,t),r.depthBuffer&&!r.stencilBuffer){let n=33189;if(o){const t=r.depthTexture;t&&t.isDepthTexture&&(t.type===Dc?n=36012:t.type===mh&&(n=33190));const o=G(r);e.renderbufferStorageMultisample(36161,o,n,r.width,r.height)}else e.renderbufferStorage(36161,n,r.width,r.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(r.depthBuffer&&r.stencilBuffer){if(o){const t=G(r);e.renderbufferStorageMultisample(36161,t,35056,r.width,r.height)}else e.renderbufferStorage(36161,34041,r.width,r.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=i.convert(r.texture.format),n=i.convert(r.texture.type),a=F(r.texture.internalFormat,t,n);if(o){const t=G(r);e.renderbufferStorageMultisample(36161,t,a,r.width,r.height)}else e.renderbufferStorage(36161,a,r.width,r.height)}e.bindRenderbuffer(36161,null)}function P(t){const r=o.get(t),n=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");o.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),M(r.depthTexture,0);const n=o.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===yd)e.framebufferTexture2D(36160,36096,3553,n,0);else{if(r.depthTexture.format!==cf)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,n,0)}}(r.__webglFramebuffer,t)}else if(n){r.__webglDepthbuffer=[];for(let o=0;o<6;o++)e.bindFramebuffer(36160,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=e.createRenderbuffer(),B(r.__webglDepthbuffer[o],t,!1)}else e.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),B(r.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}function G(e){return s&&e.isWebGLMultisampleRenderTarget?Math.min(p,e.samples):0}let D=!1,I=!1;this.allocateTextureUnit=function(){const e=b;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),b+=1,e},this.resetTextureUnits=function(){b=0},this.setTexture2D=M,this.setTexture2DArray=function(e,t){const n=o.get(e);e.version>0&&n.__version!==e.version?C(n,e,t):(r.activeTexture(33984+t),r.bindTexture(35866,n.__webglTexture))},this.setTexture3D=function(e,t){const n=o.get(e);e.version>0&&n.__version!==e.version?C(n,e,t):(r.activeTexture(33984+t),r.bindTexture(32879,n.__webglTexture))},this.setTextureCube=w,this.setTextureCubeDynamic=S,this.setupRenderTarget=function(t){const n=o.get(t),l=o.get(t.texture);t.addEventListener("dispose",_),l.__webglTexture=e.createTexture(),a.memory.textures++;const $=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,p=x(t)||s;if(!s||t.texture.format!==ad||t.texture.type!==Dc&&t.texture.type!==oh||(t.texture.format=Cb,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),$){n.__webglFramebuffer=[];for(let t=0;t<6;t++)n.__webglFramebuffer[t]=e.createFramebuffer()}else if(n.__webglFramebuffer=e.createFramebuffer(),c)if(s){n.__webglMultisampledFramebuffer=e.createFramebuffer(),n.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,n.__webglColorRenderbuffer);const r=i.convert(t.texture.format),o=i.convert(t.texture.type),a=F(t.texture.internalFormat,r,o),s=G(t);e.renderbufferStorageMultisample(36161,s,a,t.width,t.height),e.bindFramebuffer(36160,n.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,n.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(n.__webglDepthRenderbuffer=e.createRenderbuffer(),B(n.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if($){r.bindTexture(34067,l.__webglTexture),E(34067,t.texture,p);for(let e=0;e<6;e++)R(n.__webglFramebuffer[e],t,36064,34069+e);g(t.texture,p)&&v(34067,t.texture,t.width,t.height),r.bindTexture(34067,null)}else r.bindTexture(3553,l.__webglTexture),E(3553,t.texture,p),R(n.__webglFramebuffer,t,36064,3553),g(t.texture,p)&&v(3553,t.texture,t.width,t.height),r.bindTexture(3553,null);t.depthBuffer&&P(t)},this.updateRenderTargetMipmap=function(e){const t=e.texture;if(g(t,x(e)||s)){const n=e.isWebGLCubeRenderTarget?34067:3553,i=o.get(t).__webglTexture;r.bindTexture(n,i),v(n,t,e.width,e.height),r.bindTexture(n,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(s){const r=o.get(t);e.bindFramebuffer(36008,r.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,r.__webglFramebuffer);const n=t.width,i=t.height;let a=16384;t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024),e.blitFramebuffer(0,0,n,i,0,0,n,i,a,9728),e.bindFramebuffer(36160,r.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===D&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),D=!0),e=e.texture),M(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===I&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),I=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?w(e,t):S(e,t)}}function Ss(e,t,r){const o=r.isWebGL2;return{convert:function(e){let r;if(e===ag)return 5121;if(e===Yx)return 32819;if(e===Zx)return 32820;if(e===$x)return 33635;if(e===Tx)return 5120;if(e===Vx)return 5122;if(e===kh)return 5123;if(e===Wx)return 5124;if(e===mh)return 5125;if(e===Dc)return 5126;if(e===oh)return o?5131:null!==(r=t.get("OES_texture_half_float"))?r.HALF_FLOAT_OES:null;if(e===cy)return 6406;if(e===ad)return 6407;if(e===Cb)return 6408;if(e===dy)return 6409;if(e===ey)return 6410;if(e===yd)return 6402;if(e===cf)return 34041;if(e===gy)return 6403;if(e===iy)return 36244;if(e===ky)return 33319;if(e===ny)return 33320;if(e===py)return 36248;if(e===wy)return 36249;if(e===Ul||e===Tl||e===Sl||e===Pl){if(null===(r=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===Ul)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Tl)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Sl)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Pl)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===Ol||e===Ll||e===Kl||e===Jl){if(null===(r=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===Ol)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Ll)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Kl)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Jl)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===By)return null!==(r=t.get("WEBGL_compressed_texture_etc1"))?r.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===Fl||e===El)&&null!==(r=t.get("WEBGL_compressed_texture_etc"))){if(e===Fl)return r.COMPRESSED_RGB8_ETC2;if(e===El)return r.COMPRESSED_RGBA8_ETC2_EAC}return e===My||e===Qy||e===Ry||e===Uy||e===Wy||e===$y||e===az||e===dz||e===gz||e===hz||e===kz||e===oz||e===Bz||e===Jz||e===bA||e===kA||e===WA||e===eB||e===mB||e===qB||e===yB||e===CB||e===MB||e===Bt||e===Kt||e===kv||e===pv||e===xv?null!==(r=t.get("WEBGL_compressed_texture_astc"))?e:null:e===Kz?null!==(r=t.get("EXT_texture_compression_bptc"))?e:null:e===Bf?o?34042:null!==(r=t.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Kj(e){Ga.call(this),this.cameras=e||[]}function qf(){da.call(this),this.type="Group"}function Mg(){this._targetRay=null,this._grip=null}function Qo(e,t){const r=this;let o=null,n=1,i=null,a="local-floor",s=null;const l=[],$=new Map,c=new Ga;c.layers.enable(1),c.viewport=new sa;const p=new Ga;p.layers.enable(2),p.viewport=new sa;const u=[c,p],h=new Kj;h.layers.enable(1),h.layers.enable(2);let d=null,f=null;function m(e){const t=$.get(e.inputSource);t&&t.dispatchEvent({type:e.type})}function x(){$.forEach(function(e,t){e.disconnect(t)}),$.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),b.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function g(e){i=e,b.setContext(o),b.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}function v(e){const t=o.inputSources;for(let r=0;r<l.length;r++)$.set(t[r],l[r]);for(let r=0;r<e.removed.length;r++){const t=e.removed[r],o=$.get(t);o&&(o.dispatchEvent({type:"disconnected",data:t}),$.delete(t))}for(let r=0;r<e.added.length;r++){const t=e.added[r],o=$.get(t);o&&o.dispatchEvent({type:"connected",data:t})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=l[e];return void 0===t&&(t=new Mg,l[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=l[e];return void 0===t&&(t=new Mg,l[e]=t),t.getGripSpace()},this.setFramebufferScaleFactor=function(e){n=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return i},this.getSession=function(){return o},this.setSession=function(e){if(null!==(o=e)){o.addEventListener("select",m),o.addEventListener("selectstart",m),o.addEventListener("selectend",m),o.addEventListener("squeeze",m),o.addEventListener("squeezestart",m),o.addEventListener("squeezeend",m),o.addEventListener("end",x);const e=t.getContextAttributes();!0!==e.xrCompatible&&t.makeXRCompatible();const r={antialias:e.antialias,alpha:e.alpha,depth:e.depth,stencil:e.stencil,framebufferScaleFactor:n},i=new XRWebGLLayer(o,t,r);o.updateRenderState({baseLayer:i}),o.requestReferenceSpace(a).then(g),o.addEventListener("inputsourceschange",v)}};const F=new aa,K=new aa;function y(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){h.near=p.near=c.near=e.near,h.far=p.far=c.far=e.far,d===h.near&&f===h.far||(o.updateRenderState({depthNear:h.near,depthFar:h.far}),d=h.near,f=h.far);const t=e.parent,r=h.cameras;y(h,t);for(let o=0;o<r.length;o++)y(r[o],t);e.matrixWorld.copy(h.matrixWorld);const n=e.children;for(let o=0,i=n.length;o<i;o++)n[o].updateMatrixWorld(!0);return 2===r.length?function(e,t,r){F.setFromMatrixPosition(t.matrixWorld),K.setFromMatrixPosition(r.matrixWorld);const o=F.distanceTo(K),n=t.projectionMatrix.elements,i=r.projectionMatrix.elements,a=n[14]/(n[10]-1),s=n[14]/(n[10]+1),l=(n[9]+1)/n[5],$=(n[9]-1)/n[5],c=(n[8]-1)/n[0],p=(i[8]+1)/i[0],u=a*c,h=a*p,d=o/(-c+p),f=d*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(d),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);const m=a+d,x=s+d,g=u-f,v=h+(o-f),y=l*s/x*m,_=$*s/x*m;e.projectionMatrix.makePerspective(g,v,y,_,m,x)}(h,c,p):h.projectionMatrix.copy(c.projectionMatrix),h};let _=null;const b=new mo;b.setAnimationLoop(function(t,r){if(null!==(s=r.getViewerPose(i))){const t=s.views,r=o.renderState.baseLayer;e.setFramebuffer(r.framebuffer);let n=!1;t.length!==h.cameras.length&&(h.cameras.length=0,n=!0);for(let e=0;e<t.length;e++){const o=t[e],i=r.getViewport(o),a=u[e];a.matrix.fromArray(o.transform.matrix),a.projectionMatrix.fromArray(o.projectionMatrix),a.viewport.set(i.x,i.y,i.width,i.height),0===e&&h.matrix.copy(a.matrix),!0===n&&h.cameras.push(a)}}const n=o.inputSources;for(let e=0;e<l.length;e++){const t=l[e],o=n[e];t.update(o,r,i)}_&&_(t,r)}),this.setAnimationLoop=function(e){_=e},this.dispose=function(){}}function Xs(e){function t(t,r,o){t.opacity.value=r.opacity,r.color&&t.diffuse.value.copy(r.color),r.emissive&&t.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(t.map.value=r.map),r.alphaMap&&(t.alphaMap.value=r.alphaMap),r.specularMap&&(t.specularMap.value=r.specularMap);const n=r.envMap||o;let i,a;n&&(t.envMap.value=n,t.flipEnvMap.value=n.isCubeTexture?-1:1,t.reflectivity.value=r.reflectivity,t.refractionRatio.value=r.refractionRatio,t.maxMipLevel.value=e.get(n).__maxMipLevel),r.lightMap&&(t.lightMap.value=r.lightMap,t.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(t.aoMap.value=r.aoMap,t.aoMapIntensity.value=r.aoMapIntensity),r.map?i=r.map:r.specularMap?i=r.specularMap:r.displacementMap?i=r.displacementMap:r.normalMap?i=r.normalMap:r.bumpMap?i=r.bumpMap:r.roughnessMap?i=r.roughnessMap:r.metalnessMap?i=r.metalnessMap:r.alphaMap?i=r.alphaMap:r.emissiveMap&&(i=r.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix)),r.aoMap?a=r.aoMap:r.lightMap&&(a=r.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),t.uv2Transform.value.copy(a.matrix))}function r(e,t,r){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Oa&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Oa&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||r)&&(e.envMapIntensity.value=t.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,o,n,i,a){o.isMeshBasicMaterial?t(e,o):o.isMeshLambertMaterial?(t(e,o),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,o)):o.isMeshToonMaterial?(t(e,o),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Oa&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Oa&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,o)):o.isMeshPhongMaterial?(t(e,o),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Oa&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Oa&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,o)):o.isMeshStandardMaterial?(t(e,o,n),o.isMeshPhysicalMaterial?function(e,t,o){r(e,t,o),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen),t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===Oa&&e.clearcoatNormalScale.value.negate()),e.transparency.value=t.transparency}(e,o,n):r(e,o,n)):o.isMeshMatcapMaterial?(t(e,o),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Oa&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Oa&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,o)):o.isMeshDepthMaterial?(t(e,o),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,o)):o.isMeshDistanceMaterial?(t(e,o),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,o)):o.isMeshNormalMaterial?(t(e,o),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Oa&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Oa&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,o)):o.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,o),o.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,o)):o.isPointsMaterial?function(e,t,r,o){let n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*o,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,o,i,a):o.isSpriteMaterial?function(e,t){let r;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,o):o.isShadowMaterial?(e.color.value.copy(o.color),e.opacity.value=o.opacity):o.isShaderMaterial&&(o.uniformsNeedUpdate=!1)}}}function of(e){const t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r=void 0!==e.context?e.context:null,o=void 0!==e.alpha&&e.alpha,n=void 0===e.depth||e.depth,i=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,$=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let p=null,u=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=$a,this.physicallyCorrectLights=!1,this.toneMapping=Md,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const h=this;let d=!1,f=null,m=0,x=0,g=null,v=null,F=-1,K=null,y=null;const _=new sa,b=new sa;let M=null,w=t.width,S=t.height,T=1,A=null,E=null;const L=new sa(0,0,w,S),C=new sa(0,0,w,S);let R=!1;const B=new Hf,P=new Pq;let G=!1,D=!1;const I=new na,O=new aa,N={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function V(){return null===g?T:1}let U,H,z,k,W,j,q,X,Y,Z,J,Q,ee,te,re,oe,ne,ie,ae,se=r;function le(e,r){for(let o=0;o<e.length;o++){const n=e[o],i=t.getContext(n,r);if(null!==i)return i}return null}try{const e={alpha:o,depth:n,stencil:i,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:$,failIfMajorPerformanceCaveat:c};if(t.addEventListener("webglcontextlost",ue,!1),t.addEventListener("webglcontextrestored",he,!1),null===se){const t=["webgl2","webgl","experimental-webgl"];if(!0===h.isWebGL1Renderer&&t.shift(),null===(se=le(t,e)))throw le(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===se.getShaderPrecisionFormat&&(se.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ye){throw console.error("THREE.WebGLRenderer: "+ye.message),ye}function $e(){U=new Qq(se),!1===(H=new Oq(se,U,e)).isWebGL2&&(U.get("WEBGL_depth_texture"),U.get("OES_texture_float"),U.get("OES_texture_half_float"),U.get("OES_texture_half_float_linear"),U.get("OES_standard_derivatives"),U.get("OES_element_index_uint"),U.get("OES_vertex_array_object"),U.get("ANGLE_instanced_arrays")),U.get("OES_texture_float_linear"),ie=new Ss(se,U,H),(z=new Qs(se,U,H)).scissor(b.copy(C).multiplyScalar(T).floor()),z.viewport(_.copy(L).multiplyScalar(T).floor()),k=new Tq(se),W=new zs,j=new Rs(se,U,z,W,H,ie,k),q=new mu(se,H),ae=new Mq(se,U,q,H),X=new Rq(se,q,k,ae),Y=new Xq(se,X,q,k),re=new Wq(se),Z=new ys(h,U,H,ae),J=new Xs(W),Q=new Ds,ee=new Ks,te=new Lq(h,z,Y,s),oe=new Nq(se,U,k,H),ne=new Sq(se,U,k,H),k.programs=Z.programs,h.capabilities=H,h.extensions=U,h.properties=W,h.renderLists=Q,h.state=z,h.info=k}$e();const ce=new Qo(h,se);this.xr=ce;const pe=new So(h,Y,H.maxTextureSize);function ue(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),d=!0}function he(){console.log("THREE.WebGLRenderer: Context Restored."),d=!1,$e()}function de(e){const t=e.target;t.removeEventListener("dispose",de),function(e){fe(e),W.remove(e)}(t)}function fe(e){const t=W.get(e).program;e.program=void 0,void 0!==t&&Z.releaseProgram(t)}this.shadowMap=pe,this.getContext=function(){return se},this.getContextAttributes=function(){return se.getContextAttributes()},this.forceContextLoss=function(){const e=U.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=U.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return T},this.setPixelRatio=function(e){void 0!==e&&(T=e,this.setSize(w,S,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new ca),e.set(w,S)},this.setSize=function(e,r,o){ce.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(w=e,S=r,t.width=Math.floor(e*T),t.height=Math.floor(r*T),!1!==o&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new ca),e.set(w*T,S*T).floor()},this.setDrawingBufferSize=function(e,r,o){w=e,S=r,T=o,t.width=Math.floor(e*o),t.height=Math.floor(r*o),this.setViewport(0,0,e,r)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new sa),e.copy(_)},this.getViewport=function(e){return e.copy(L)},this.setViewport=function(e,t,r,o){e.isVector4?L.set(e.x,e.y,e.z,e.w):L.set(e,t,r,o),z.viewport(_.copy(L).multiplyScalar(T).floor())},this.getScissor=function(e){return e.copy(C)},this.setScissor=function(e,t,r,o){e.isVector4?C.set(e.x,e.y,e.z,e.w):C.set(e,t,r,o),z.scissor(b.copy(C).multiplyScalar(T).floor())},this.getScissorTest=function(){return R},this.setScissorTest=function(e){z.setScissorTest(R=e)},this.setOpaqueSort=function(e){A=e},this.setTransparentSort=function(e){E=e},this.getClearColor=function(){return te.getClearColor()},this.setClearColor=function(){te.setClearColor.apply(te,arguments)},this.getClearAlpha=function(){return te.getClearAlpha()},this.setClearAlpha=function(){te.setClearAlpha.apply(te,arguments)},this.clear=function(e,t,r){let o=0;(void 0===e||e)&&(o|=16384),(void 0===t||t)&&(o|=256),(void 0===r||r)&&(o|=1024),se.clear(o)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ue,!1),t.removeEventListener("webglcontextrestored",he,!1),Q.dispose(),ee.dispose(),W.dispose(),Y.dispose(),ae.dispose(),ce.dispose(),xe.stop()},this.renderBufferImmediate=function(e,t){ae.initAttributes();const r=W.get(e);e.hasPositions&&!r.position&&(r.position=se.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=se.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=se.createBuffer()),e.hasColors&&!r.color&&(r.color=se.createBuffer());const o=t.getAttributes();e.hasPositions&&(se.bindBuffer(34962,r.position),se.bufferData(34962,e.positionArray,35048),ae.enableAttribute(o.position),se.vertexAttribPointer(o.position,3,5126,!1,0,0)),e.hasNormals&&(se.bindBuffer(34962,r.normal),se.bufferData(34962,e.normalArray,35048),ae.enableAttribute(o.normal),se.vertexAttribPointer(o.normal,3,5126,!1,0,0)),e.hasUvs&&(se.bindBuffer(34962,r.uv),se.bufferData(34962,e.uvArray,35048),ae.enableAttribute(o.uv),se.vertexAttribPointer(o.uv,2,5126,!1,0,0)),e.hasColors&&(se.bindBuffer(34962,r.color),se.bufferData(34962,e.colorArray,35048),ae.enableAttribute(o.color),se.vertexAttribPointer(o.color,3,5126,!1,0,0)),ae.disableUnusedAttributes(),se.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,r,o,n,i){null===t&&(t=N);const a=n.isMesh&&n.matrixWorld.determinant()<0,s=Ke(e,t,o,n);z.setMaterial(o,a);let l=r.index;const $=r.attributes.position;if(null===l){if(void 0===$||0===$.count)return}else if(0===l.count)return;let c,p=1;!0===o.wireframe&&(l=X.getWireframeAttribute(r),p=2),(o.morphTargets||o.morphNormals)&&re.update(n,r,o,s),ae.setup(n,o,s,r,l);let u=oe;null!==l&&(c=q.get(l),(u=ne).setIndex(c));const h=null!==l?l.count:$.count,d=r.drawRange.start*p,f=r.drawRange.count*p,m=null!==i?i.start*p:0,x=null!==i?i.count*p:1/0,g=Math.max(d,m),v=Math.min(h,d+f,m+x)-1,F=Math.max(0,v-g+1);if(0!==F){if(n.isMesh)!0===o.wireframe?(z.setLineWidth(o.wireframeLinewidth*V()),u.setMode(1)):u.setMode(4);else if(n.isLine){let e=o.linewidth;void 0===e&&(e=1),z.setLineWidth(e*V()),n.isLineSegments?u.setMode(1):n.isLineLoop?u.setMode(2):u.setMode(3)}else n.isPoints?u.setMode(0):n.isSprite&&u.setMode(4);if(n.isInstancedMesh)u.renderInstances(r,g,F,n.count);else if(r.isInstancedBufferGeometry){const e=Math.min(r.instanceCount,r._maxInstanceCount);u.renderInstances(r,g,F,e)}else u.render(g,F)}},this.compile=function(e,t){(u=ee.get(e,t)).init(),e.traverse(function(e){e.isLight&&(u.pushLight(e),e.castShadow&&u.pushShadow(e))}),u.setupLights(t);const r=new WeakMap;e.traverse(function(t){let o=t.material;if(o)if(Array.isArray(o))for(let n=0;n<o.length;n++){let i=o[n];!1===r.has(i)&&(Fe(i,e,t),r.set(i))}else!1===r.has(o)&&(Fe(o,e,t),r.set(o))})};let me=null;const xe=new mo;function ge(e,t,r){const o=!0===t.isScene?t.overrideMaterial:null;for(let n=0,i=e.length;n<i;n++){const i=e[n],a=i.object,s=i.geometry,l=null===o?i.material:o,$=i.group;if(r.isArrayCamera){y=r;const e=r.cameras;for(let r=0,o=e.length;r<o;r++){const o=e[r];a.layers.test(o.layers)&&(z.viewport(_.copy(o.viewport)),u.setupLights(o),ve(a,t,o,s,l,$))}}else y=null,ve(a,t,r,s,l,$)}}function ve(e,t,r,o,n,i){if(e.onBeforeRender(h,t,r,o,n,i),u=ee.get(t,y||r),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){const o=Ke(r,t,n,e);z.setMaterial(n),ae.reset(),function(e,t){e.render(function(e){h.renderBufferImmediate(e,t)})}(e,o)}else h.renderBufferDirect(r,t,o,n,e,i);e.onAfterRender(h,t,r,o,n,i),u=ee.get(t,y||r)}function Fe(e,t,r){!0!==t.isScene&&(t=N);const o=W.get(e),n=u.state.lights,i=u.state.shadowsArray,a=n.state.version,s=Z.getParameters(e,n.state,i,t,P.numPlanes,P.numIntersection,r),l=Z.getProgramCacheKey(s);let $=o.program,c=!0;if(void 0===$)e.addEventListener("dispose",de);else if($.cacheKey!==l)fe(e);else if(o.lightsStateVersion!==a)o.lightsStateVersion=a,c=!1;else{if(void 0!==s.shaderID)return;c=!1}c&&($=Z.acquireProgram(s,l),o.program=$,o.uniforms=s.uniforms,o.outputEncoding=s.outputEncoding,e.program=$);const p=$.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(let t=0;t<h.maxMorphTargets;t++)p["morphTarget"+t]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(let t=0;t<h.maxMorphNormals;t++)p["morphNormal"+t]>=0&&e.numSupportedMorphNormals++}const d=o.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(o.numClippingPlanes=P.numPlanes,o.numIntersection=P.numIntersection,d.clippingPlanes=P.uniform),o.environment=e.isMeshStandardMaterial?t.environment:null,o.fog=t.fog,o.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),o.lightsStateVersion=a,o.needsLights&&(d.ambientLightColor.value=n.state.ambient,d.lightProbe.value=n.state.probe,d.directionalLights.value=n.state.directional,d.directionalLightShadows.value=n.state.directionalShadow,d.spotLights.value=n.state.spot,d.spotLightShadows.value=n.state.spotShadow,d.rectAreaLights.value=n.state.rectArea,d.pointLights.value=n.state.point,d.pointLightShadows.value=n.state.pointShadow,d.hemisphereLights.value=n.state.hemi,d.directionalShadowMap.value=n.state.directionalShadowMap,d.directionalShadowMatrix.value=n.state.directionalShadowMatrix,d.spotShadowMap.value=n.state.spotShadowMap,d.spotShadowMatrix.value=n.state.spotShadowMatrix,d.pointShadowMap.value=n.state.pointShadowMap,d.pointShadowMatrix.value=n.state.pointShadowMatrix);const f=o.program.getUniforms(),m=tc.seqWithValue(f.seq,d);o.uniformsList=m}function Ke(e,t,r,o){!0!==t.isScene&&(t=N),j.resetTextureUnits();const n=t.fog,i=r.isMeshStandardMaterial?t.environment:null,a=null===g?h.outputEncoding:g.texture.encoding,s=W.get(r),l=u.state.lights;if(!0===G&&(!0===D||e!==K)){const t=e===K&&r.id===F;P.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,s,t)}r.version===s.__version?void 0===s.program?Fe(r,t,o):r.fog&&s.fog!==n?Fe(r,t,o):s.environment!==i?Fe(r,t,o):s.needsLights&&s.lightsStateVersion!==l.state.version?Fe(r,t,o):void 0===s.numClippingPlanes||s.numClippingPlanes===P.numPlanes&&s.numIntersection===P.numIntersection?s.outputEncoding!==a&&Fe(r,t,o):Fe(r,t,o):(Fe(r,t,o),s.__version=r.version);let $=!1,c=!1,p=!1;const d=s.program,f=d.getUniforms(),m=s.uniforms;if(z.useProgram(d.program)&&($=!0,c=!0,p=!0),r.id!==F&&(F=r.id,c=!0),$||K!==e){if(f.setValue(se,"projectionMatrix",e.projectionMatrix),H.logarithmicDepthBuffer&&f.setValue(se,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),K!==e&&(K=e,c=!0,p=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const t=f.map.cameraPosition;void 0!==t&&t.setValue(se,O.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&f.setValue(se,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||r.skinning)&&f.setValue(se,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){f.setOptional(se,o,"bindMatrix"),f.setOptional(se,o,"bindMatrixInverse");const e=o.skeleton;if(e){const t=e.bones;if(H.floatVertexTextures){if(void 0===e.boneTexture){let r=Math.sqrt(4*t.length);r=ma.ceilPowerOfTwo(r),r=Math.max(r,4);const o=new Float32Array(r*r*4);o.set(e.boneMatrices);const n=new De(o,r,r,Cb,Dc);e.boneMatrices=o,e.boneTexture=n,e.boneTextureSize=r}f.setValue(se,"boneTexture",e.boneTexture,j),f.setValue(se,"boneTextureSize",e.boneTextureSize)}else f.setOptional(se,e,"boneMatrices")}}var x,v;return(c||s.receiveShadow!==o.receiveShadow)&&(s.receiveShadow=o.receiveShadow,f.setValue(se,"receiveShadow",o.receiveShadow)),c&&(f.setValue(se,"toneMappingExposure",h.toneMappingExposure),s.needsLights&&(v=p,(x=m).ambientLightColor.needsUpdate=v,x.lightProbe.needsUpdate=v,x.directionalLights.needsUpdate=v,x.directionalLightShadows.needsUpdate=v,x.pointLights.needsUpdate=v,x.pointLightShadows.needsUpdate=v,x.spotLights.needsUpdate=v,x.spotLightShadows.needsUpdate=v,x.rectAreaLights.needsUpdate=v,x.hemisphereLights.needsUpdate=v),n&&r.fog&&J.refreshFogUniforms(m,n),J.refreshMaterialUniforms(m,r,i,T,S),void 0!==m.ltc_1&&(m.ltc_1.value=fa.LTC_1),void 0!==m.ltc_2&&(m.ltc_2.value=fa.LTC_2),tc.upload(se,s.uniformsList,m,j)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(tc.upload(se,s.uniformsList,m,j),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&f.setValue(se,"center",o.center),f.setValue(se,"modelViewMatrix",o.modelViewMatrix),f.setValue(se,"normalMatrix",o.normalMatrix),f.setValue(se,"modelMatrix",o.matrixWorld),d}xe.setAnimationLoop(function(e){ce.isPresenting||me&&me(e)}),"undefined"!=typeof window&&xe.setContext(window),this.setAnimationLoop=function(e){me=e,ce.setAnimationLoop(e),null===e?xe.stop():xe.start()},this.render=function(e,t){let r,o;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),r=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),o=arguments[3]),void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===d)return;ae.resetDefaultState(),F=-1,K=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===ce.enabled&&!0===ce.isPresenting&&(t=ce.getCamera(t)),!0===e.isScene&&e.onBeforeRender(h,e,t,r||g),(u=ee.get(e,t)).init(),I.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),B.setFromProjectionMatrix(I),D=this.localClippingEnabled,G=P.init(this.clippingPlanes,D,t),(p=Q.get(e,t)).init(),function e(t,r,o,n){if(!1===t.visible)return;const i=t.layers.test(r.layers);if(i)if(t.isGroup)o=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(r);else if(t.isLight)u.pushLight(t),t.castShadow&&u.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||B.intersectsSprite(t)){n&&O.setFromMatrixPosition(t.matrixWorld).applyMatrix4(I);const e=Y.update(t),r=t.material;r.visible&&p.push(t,e,r,o,O.z,null)}}else if(t.isImmediateRenderObject)n&&O.setFromMatrixPosition(t.matrixWorld).applyMatrix4(I),p.push(t,null,t.material,o,O.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==k.render.frame&&(t.skeleton.update(),t.skeleton.frame=k.render.frame),!t.frustumCulled||B.intersectsObject(t))){n&&O.setFromMatrixPosition(t.matrixWorld).applyMatrix4(I);const e=Y.update(t),r=t.material;if(Array.isArray(r)){const n=e.groups;for(let i=0,a=n.length;i<a;i++){const a=n[i],s=r[a.materialIndex];s&&s.visible&&p.push(t,e,s,o,O.z,a)}}else r.visible&&p.push(t,e,r,o,O.z,null)}const a=t.children;for(let s=0,l=a.length;s<l;s++)e(a[s],r,o,n)}(e,t,0,h.sortObjects),p.finish(),!0===h.sortObjects&&p.sort(A,E),!0===G&&P.beginShadows();const n=u.state.shadowsArray;pe.render(n,e,t),u.setupLights(t),!0===G&&P.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==r&&this.setRenderTarget(r),te.render(p,e,t,o);const i=p.opaque,a=p.transparent;i.length>0&&ge(i,e,t),a.length>0&&ge(a,e,t),!0===e.isScene&&e.onAfterRender(h,e,t),null!==g&&(j.updateRenderTargetMipmap(g),j.updateMultisampleRenderTarget(g)),z.buffers.depth.setTest(!0),z.buffers.depth.setMask(!0),z.buffers.color.setMask(!0),z.setPolygonOffset(!1),p=null,u=null},this.setFramebuffer=function(e){f!==e&&null===g&&se.bindFramebuffer(36160,e),f=e},this.getActiveCubeFace=function(){return m},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return g},this.setRenderTarget=function(e,t,r){g=e,m=t,x=r,e&&void 0===W.get(e).__webglFramebuffer&&j.setupRenderTarget(e);let o=f,n=!1;if(e){const r=W.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(o=r[t||0],n=!0):o=e.isWebGLMultisampleRenderTarget?W.get(e).__webglMultisampledFramebuffer:r,_.copy(e.viewport),b.copy(e.scissor),M=e.scissorTest}else _.copy(L).multiplyScalar(T).floor(),b.copy(C).multiplyScalar(T).floor(),M=R;if(v!==o&&(se.bindFramebuffer(36160,o),v=o),z.viewport(_),z.scissor(b),z.setScissorTest(M),n){const o=W.get(e.texture);se.framebufferTexture2D(36160,36064,34069+(t||0),o.__webglTexture,r||0)}},this.readRenderTargetPixels=function(e,t,r,o,n,i,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=W.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){let a=!1;s!==v&&(se.bindFramebuffer(36160,s),a=!0);try{const s=e.texture,l=s.format,$=s.type;if(l!==Cb&&ie.convert(l)!==se.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!($===ag||ie.convert($)===se.getParameter(35738)||$===Dc&&(H.isWebGL2||U.get("OES_texture_float")||U.get("WEBGL_color_buffer_float"))||$===oh&&(H.isWebGL2?U.get("EXT_color_buffer_float"):U.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===se.checkFramebufferStatus(36160)?t>=0&&t<=e.width-o&&r>=0&&r<=e.height-n&&se.readPixels(t,r,o,n,ie.convert(l),ie.convert($),i):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&se.bindFramebuffer(36160,v)}}},this.copyFramebufferToTexture=function(e,t,r){void 0===r&&(r=0);const o=Math.pow(2,-r),n=Math.floor(t.image.width*o),i=Math.floor(t.image.height*o),a=ie.convert(t.format);j.setTexture2D(t,0),se.copyTexImage2D(3553,r,a,e.x,e.y,n,i,0),z.unbindTexture()},this.copyTextureToTexture=function(e,t,r,o){void 0===o&&(o=0);const n=t.image.width,i=t.image.height,a=ie.convert(r.format),s=ie.convert(r.type);j.setTexture2D(r,0),se.pixelStorei(37440,r.flipY),se.pixelStorei(37441,r.premultiplyAlpha),se.pixelStorei(3317,r.unpackAlignment),t.isDataTexture?se.texSubImage2D(3553,o,e.x,e.y,n,i,a,s,t.image.data):t.isCompressedTexture?se.compressedTexSubImage2D(3553,o,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):se.texSubImage2D(3553,o,e.x,e.y,a,s,t.image),0===o&&r.generateMipmaps&&se.generateMipmap(3553),z.unbindTexture()},this.initTexture=function(e){j.setTexture2D(e,0),z.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Po(e){of.call(this,e)}function Dj(e,t){this.name="",this.color=new ha(e),this.density=void 0!==t?t:25e-5}function Cj(e,t,r){this.name="",this.color=new ha(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}function nb(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ma.generateUUID()}Kj.prototype=Object.assign(Object.create(Ga.prototype),{constructor:Kj,isArrayCamera:!0}),qf.prototype=Object.assign(Object.create(da.prototype),{constructor:qf,isGroup:!0}),Object.assign(Mg.prototype,{constructor:Mg,getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new qf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new qf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),this},update:function(e,t,r){let o=null,n=null;const i=this._targetRay,a=this._grip;return e&&(null!==i&&null!==(o=t.getPose(e.targetRaySpace,r))&&(i.matrix.fromArray(o.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale)),null!==a&&e.gripSpace&&null!==(n=t.getPose(e.gripSpace,r))&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale))),null!==i&&(i.visible=null!==o),null!==a&&(a.visible=null!==n),this}}),Object.assign(Qo.prototype,oc.prototype),Po.prototype=Object.assign(Object.create(of.prototype),{constructor:Po,isWebGL1Renderer:!0}),Object.assign(Dj.prototype,{isFogExp2:!0,clone:function(){return new Dj(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Cj.prototype,{isFog:!0,clone:function(){return new Cj(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(nb.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(nb.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(let o=0,n=this.stride;o<n;o++)this.array[e+o]=t.array[r+o];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ma.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new nb(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ma.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const jd=new aa;function id(e,t,r,o){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===o}function hd(e){ja.call(this),this.type="SpriteMaterial",this.color=new ha(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}let jf;Object.defineProperties(id.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(id.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(let t=0,r=this.data.count;t<r;t++)jd.x=this.getX(t),jd.y=this.getY(t),jd.z=this.getZ(t),jd.applyMatrix4(e),this.setXYZ(t,jd.x,jd.y,jd.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this},setXYZW:function(e,t,r,o,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this.data.array[e+3]=n,this},clone:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new ka(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new id(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),hd.prototype=Object.create(ja.prototype),hd.prototype.constructor=hd,hd.prototype.isSpriteMaterial=!0,hd.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};const hf=new aa,Vd=new aa,Ud=new aa,Td=new ca,df=new ca,Mo=new na,Ng=new aa,bf=new aa,Og=new aa,Lo=new ca,$i=new ca,Ko=new ca;function Zi(e){if(da.call(this),this.type="Sprite",void 0===jf){jf=new ga;const e=new nb(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);jf.setIndex([0,1,2,0,2,3]),jf.setAttribute("position",new id(e,3,0,!1)),jf.setAttribute("uv",new id(e,2,3,!1))}this.geometry=jf,this.material=void 0!==e?e:new hd,this.center=new ca(.5,.5)}function Pg(e,t,r,o,n,i){Td.subVectors(e,r).addScalar(.5).multiply(o),void 0!==n?(df.x=i*Td.x-n*Td.y,df.y=n*Td.x+i*Td.y):df.copy(Td),e.copy(t),e.x+=df.x,e.y+=df.y,e.applyMatrix4(Mo)}Zi.prototype=Object.assign(Object.create(da.prototype),{constructor:Zi,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error("THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites."),Vd.setFromMatrixScale(this.matrixWorld),Mo.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ud.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Vd.multiplyScalar(-Ud.z);const r=this.material.rotation;let o,n;0!==r&&(n=Math.cos(r),o=Math.sin(r));const i=this.center;Pg(Ng.set(-.5,-.5,0),Ud,i,Vd,o,n),Pg(bf.set(.5,-.5,0),Ud,i,Vd,o,n),Pg(Og.set(.5,.5,0),Ud,i,Vd,o,n),Lo.set(0,0),$i.set(1,0),Ko.set(1,1);let a=e.ray.intersectTriangle(Ng,bf,Og,!1,hf);if(null===a&&(Pg(bf.set(-.5,.5,0),Ud,i,Vd,o,n),$i.set(0,1),null===(a=e.ray.intersectTriangle(Ng,Og,bf,!1,hf))))return;const s=e.ray.origin.distanceTo(hf);s<e.near||s>e.far||t.push({distance:s,point:hf.clone(),uv:Qa.getUV(hf,Ng,bf,Og,Lo,$i,Ko,new ca),face:null,object:this})},copy:function(e){return da.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}});const Qg=new aa,Io=new aa;function Rg(){da.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Si(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ua.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new na,this.bindMatrixInverse=new na}Rg.prototype=Object.assign(Object.create(da.prototype),{constructor:Rg,isLOD:!0,copy:function(e){da.prototype.copy.call(this,e,!1);const t=e.levels;for(let r=0,o=t.length;r<o;r++){const e=t[r];this.addLevel(e.object.clone(),e.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);const r=this.levels;let o;for(o=0;o<r.length&&!(t<r[o].distance);o++);return r.splice(o,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){const t=this.levels;if(t.length>0){let r,o;for(r=1,o=t.length;r<o&&!(e<t[r].distance);r++);return t[r-1].object}return null},raycast:function(e,t){if(this.levels.length>0){Qg.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Qg);this.getObjectForDistance(r).raycast(e,t)}},update:function(e){const t=this.levels;if(t.length>1){Qg.setFromMatrixPosition(e.matrixWorld),Io.setFromMatrixPosition(this.matrixWorld);const r=Qg.distanceTo(Io)/e.zoom;let o,n;for(t[0].object.visible=!0,o=1,n=t.length;o<n&&r>=t[o].distance;o++)t[o-1].object.visible=!1,t[o].object.visible=!0;for(this._currentLevel=o-1;o<n;o++)t[o].object.visible=!1}},toJSON:function(e){const t=da.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let o=0,n=r.length;o<n;o++){const e=r[o];t.object.levels.push({object:e.object.uuid,distance:e.distance})}return t}}),Si.prototype=Object.assign(Object.create(ua.prototype),{constructor:Si,isSkinnedMesh:!0,copy:function(e){return ua.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const e=new sa,t=this.geometry.attributes.skinWeight;for(let r=0,o=t.count;r<o;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){ua.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const e=new aa,t=new sa,r=new sa,o=new aa,n=new na;return function(i,a){const s=this.skeleton,l=this.geometry;t.fromBufferAttribute(l.attributes.skinIndex,i),r.fromBufferAttribute(l.attributes.skinWeight,i),e.fromBufferAttribute(l.attributes.position,i).applyMatrix4(this.bindMatrix),a.set(0,0,0);for(let $=0;$<4;$++){const i=r.getComponent($);if(0!==i){const r=t.getComponent($);n.multiplyMatrices(s.bones[r].matrixWorld,s.boneInverses[r]),a.addScaledVector(o.copy(e).applyMatrix4(n),i)}}return a.applyMatrix4(this.bindMatrixInverse)}}()});const Ho=new na,yt=new na;function Qi(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new na)}}function Go(){da.call(this),this.type="Bone"}Object.assign(Qi.prototype,{calculateInverses:function(){this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++){const t=new na;this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)}},pose:function(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.getInverse(this.boneInverses[e])}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}},update:function(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,o=this.boneTexture;for(let n=0,i=e.length;n<i;n++){const o=e[n]?e[n].matrixWorld:yt;Ho.multiplyMatrices(o,t[n]),Ho.toArray(r,16*n)}void 0!==o&&(o.needsUpdate=!0)},clone:function(){return new Qi(this.bones,this.boneInverses)},getBoneByName:function(e){for(let t=0,r=this.bones.length;t<r;t++){const r=this.bones[t];if(r.name===e)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Go.prototype=Object.assign(Object.create(da.prototype),{constructor:Go,isBone:!0});const Rk=new na,Fo=new na,Tg=[],Ve=new ua;function Ni(e,t,r){ua.call(this,e,t),this.instanceMatrix=new ka(new Float32Array(16*r),16),this.count=r,this.frustumCulled=!1}function Ca(e){ja.call(this),this.type="LineBasicMaterial",this.color=new ha(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}Ni.prototype=Object.assign(Object.create(ua.prototype),{constructor:Ni,isInstancedMesh:!0,copy:function(e){return ua.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){const r=this.matrixWorld,o=this.count;if(Ve.geometry=this.geometry,Ve.material=this.material,void 0!==Ve.material)for(let n=0;n<o;n++){this.getMatrixAt(n,Rk),Fo.multiplyMatrices(r,Rk),Ve.matrixWorld=Fo,Ve.raycast(e,Tg);for(let e=0,r=Tg.length;e<r;e++){const r=Tg[e];r.instanceId=n,r.object=this,t.push(r)}Tg.length=0}},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),Ca.prototype=Object.create(ja.prototype),Ca.prototype.constructor=Ca,Ca.prototype.isLineBasicMaterial=!0,Ca.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};const Do=new aa,Co=new aa,Bo=new na,$g=new Nd,_g=new _b;function xb(e,t,r){1===r&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),da.call(this),this.type="Line",this.geometry=void 0!==e?e:new ga,this.material=void 0!==t?t:new Ca,this.updateMorphTargets()}xb.prototype=Object.assign(Object.create(da.prototype),{constructor:xb,isLine:!0,copy:function(e){return da.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){const e=this.geometry;if(e.isBufferGeometry){if(null===e.index){const t=e.attributes.position,r=[0];for(let e=1,o=t.count;e<o;e++)Do.fromBufferAttribute(t,e-1),Co.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=Do.distanceTo(Co);e.setAttribute("lineDistance",new ea(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");}else if(e.isGeometry){const t=e.vertices,r=e.lineDistances;r[0]=0;for(let e=1,o=t.length;e<o;e++)r[e]=r[e-1],r[e]+=t[e-1].distanceTo(t[e])}return this},raycast:function(e,t){const r=this.geometry,o=this.matrixWorld,n=e.params.Line.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),_g.copy(r.boundingSphere),_g.applyMatrix4(o),_g.radius+=n,!1===e.ray.intersectsSphere(_g))return;Bo.getInverse(o),$g.copy(e.ray).applyMatrix4(Bo);const i=n/((this.scale.x+this.scale.y+this.scale.z)/3),a=i*i,s=new aa,l=new aa,$=new aa,c=new aa,p=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){const o=r.index,n=r.attributes.position.array;if(null!==o){const r=o.array;for(let o=0,i=r.length-1;o<i;o+=p){const i=r[o],p=r[o+1];if(s.fromArray(n,3*i),l.fromArray(n,3*p),$g.distanceSqToSegment(s,l,c,$)>a)continue;c.applyMatrix4(this.matrixWorld);const u=e.ray.origin.distanceTo(c);u<e.near||u>e.far||t.push({distance:u,point:$.clone().applyMatrix4(this.matrixWorld),index:o,face:null,faceIndex:null,object:this})}}else for(let r=0,i=n.length/3-1;r<i;r+=p){if(s.fromArray(n,3*r),l.fromArray(n,3*r+3),$g.distanceSqToSegment(s,l,c,$)>a)continue;c.applyMatrix4(this.matrixWorld);const o=e.ray.origin.distanceTo(c);o<e.near||o>e.far||t.push({distance:o,point:$.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else if(r.isGeometry){const o=r.vertices,n=o.length;for(let r=0;r<n-1;r+=p){if($g.distanceSqToSegment(o[r],o[r+1],c,$)>a)continue;c.applyMatrix4(this.matrixWorld);const n=e.ray.origin.distanceTo(c);n<e.near||n>e.far||t.push({distance:n,point:$.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const bh=new aa,dh=new aa;function Ea(e,t){xb.call(this,e,t),this.type="LineSegments"}function xi(e,t){xb.call(this,e,t),this.type="LineLoop"}function Vc(e){ja.call(this),this.type="PointsMaterial",this.color=new ha(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}Ea.prototype=Object.assign(Object.create(xb.prototype),{constructor:Ea,isLineSegments:!0,computeLineDistances:function(){const e=this.geometry;if(e.isBufferGeometry){if(null===e.index){const t=e.attributes.position,r=[];for(let e=0,o=t.count;e<o;e+=2)bh.fromBufferAttribute(t,e),dh.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+bh.distanceTo(dh);e.setAttribute("lineDistance",new ea(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");}else if(e.isGeometry){const t=e.vertices,r=e.lineDistances;for(let e=0,o=t.length;e<o;e+=2)bh.copy(t[e]),dh.copy(t[e+1]),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+bh.distanceTo(dh)}return this}}),xi.prototype=Object.assign(Object.create(xb.prototype),{constructor:xi,isLineLoop:!0}),Vc.prototype=Object.create(ja.prototype),Vc.prototype.constructor=Vc,Vc.prototype.isPointsMaterial=!0,Vc.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};const zo=new na,ti=new Nd,hh=new _b,ih=new aa;function ki(e,t){da.call(this),this.type="Points",this.geometry=void 0!==e?e:new ga,this.material=void 0!==t?t:new Vc,this.updateMorphTargets()}function ji(e,t,r,o,n,i,a){const s=ti.distanceSqToPoint(e);if(s<r){const r=new aa;ti.closestPointToPoint(e,r),r.applyMatrix4(o);const l=n.ray.origin.distanceTo(r);if(l<n.near||l>n.far)return;i.push({distance:l,distanceToRay:Math.sqrt(s),point:r,index:t,face:null,object:a})}}function xo(e,t,r,o,n,i,a,s,l){va.call(this,e,t,r,o,n,i,a,s,l),this.format=void 0!==a?a:ad,this.minFilter=void 0!==i?i:Na,this.magFilter=void 0!==n?n:Na,this.generateMipmaps=!1}function Of(e,t,r,o,n,i,a,s,l,$,c,p){va.call(this,null,i,a,s,l,$,o,n,c,p),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function nh(e,t,r,o,n,i,a,s,l){va.call(this,e,t,r,o,n,i,a,s,l),this.needsUpdate=!0}function ph(e,t,r,o,n,i,a,s,l,$){if(($=void 0!==$?$:yd)!==yd&&$!==cf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&$===yd&&(r=kh),void 0===r&&$===cf&&(r=Bf),va.call(this,null,o,n,i,a,s,$,r,l),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Pa,this.minFilter=void 0!==s?s:Pa,this.flipY=!1,this.generateMipmaps=!1}function qh(e){ga.call(this),this.type="WireframeGeometry";const t=[],r=[0,0],o={},n=["a","b","c"];if(e&&e.isGeometry){const i=e.faces;for(let e=0,t=i.length;e<t;e++){const t=i[e];for(let e=0;e<3;e++){const i=t[n[e]],a=t[n[(e+1)%3]];r[0]=Math.min(i,a),r[1]=Math.max(i,a);const s=r[0]+","+r[1];void 0===o[s]&&(o[s]={index1:r[0],index2:r[1]})}}for(const r in o){const n=o[r];let i=e.vertices[n.index1];t.push(i.x,i.y,i.z),i=e.vertices[n.index2],t.push(i.x,i.y,i.z)}}else if(e&&e.isBufferGeometry){let n=new aa;if(null!==e.index){const i=e.attributes.position,a=e.index;let s=e.groups;0===s.length&&(s=[{start:0,count:a.count,materialIndex:0}]);for(let e=0,t=s.length;e<t;++e){const t=s[e],n=t.start;for(let e=n,i=n+t.count;e<i;e+=3)for(let t=0;t<3;t++){const n=a.getX(e+t),i=a.getX(e+(t+1)%3);r[0]=Math.min(n,i),r[1]=Math.max(n,i);const s=r[0]+","+r[1];void 0===o[s]&&(o[s]={index1:r[0],index2:r[1]})}}for(const e in o){const r=o[e];n.fromBufferAttribute(i,r.index1),t.push(n.x,n.y,n.z),n.fromBufferAttribute(i,r.index2),t.push(n.x,n.y,n.z)}}else{const r=e.attributes.position;for(let e=0,o=r.count/3;e<o;e++)for(let i=0;i<3;i++){const o=3*e+i;n.fromBufferAttribute(r,o),t.push(n.x,n.y,n.z);const a=3*e+(i+1)%3;n.fromBufferAttribute(r,a),t.push(n.x,n.y,n.z)}}}this.setAttribute("position",new ea(t,3))}function uh(e,t,r){la.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new xf(e,t,r)),this.mergeVertices()}function xf(e,t,r){ga.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:r};const o=[],n=[],i=[],a=[],s=new aa,l=new aa,$=new aa,c=new aa,p=new aa;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const u=t+1;for(let h=0;h<=r;h++){const o=h/r;for(let r=0;r<=t;r++){const u=r/t;e(u,o,l),n.push(l.x,l.y,l.z),u-1e-5>=0?(e(u-1e-5,o,$),c.subVectors(l,$)):(e(u+1e-5,o,$),c.subVectors($,l)),o-1e-5>=0?(e(u,o-1e-5,$),p.subVectors(l,$)):(e(u,o+1e-5,$),p.subVectors($,l)),s.crossVectors(c,p).normalize(),i.push(s.x,s.y,s.z),a.push(u,o)}}for(let h=0;h<r;h++)for(let e=0;e<t;e++){const t=h*u+e,r=h*u+e+1,n=(h+1)*u+e+1,i=(h+1)*u+e;o.push(t,r,i),o.push(r,n,i)}this.setIndex(o),this.setAttribute("position",new ea(n,3)),this.setAttribute("normal",new ea(i,3)),this.setAttribute("uv",new ea(a,2))}function vh(e,t,r,o){la.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:o},this.fromBufferGeometry(new kb(e,t,r,o)),this.mergeVertices()}function kb(e,t,r,o){ga.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:o},r=r||1;const n=[],i=[];function a(e,t,r,o){const n=Math.pow(2,o),i=[];for(let a=0;a<=n;a++){i[a]=[];const o=e.clone().lerp(r,a/n),s=t.clone().lerp(r,a/n),l=n-a;for(let e=0;e<=l;e++)i[a][e]=0===e&&a===n?o:o.clone().lerp(s,e/l)}for(let a=0;a<n;a++)for(let e=0;e<2*(n-a)-1;e++){const t=Math.floor(e/2);e%2==0?(s(i[a][t+1]),s(i[a+1][t]),s(i[a][t])):(s(i[a][t+1]),s(i[a+1][t+1]),s(i[a+1][t]))}}function s(e){n.push(e.x,e.y,e.z)}function l(t,r){const o=3*t;r.x=e[o+0],r.y=e[o+1],r.z=e[o+2]}function $(e,t,r,o){o<0&&1===e.x&&(i[t]=e.x-1),0===r.x&&0===r.z&&(i[t]=o/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}!function(e){const r=new aa,o=new aa,n=new aa;for(let i=0;i<t.length;i+=3)l(t[i+0],r),l(t[i+1],o),l(t[i+2],n),a(r,o,n,e)}(o=o||0),function(e){const t=new aa;for(let r=0;r<n.length;r+=3)t.x=n[r+0],t.y=n[r+1],t.z=n[r+2],t.normalize().multiplyScalar(e),n[r+0]=t.x,n[r+1]=t.y,n[r+2]=t.z}(r),function(){const e=new aa;for(let r=0;r<n.length;r+=3){e.x=n[r+0],e.y=n[r+1],e.z=n[r+2];const o=c(e)/2/Math.PI+.5,a=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);i.push(o,1-a)}var t;(function(){const e=new aa,t=new aa,r=new aa,o=new aa,a=new ca,s=new ca,l=new ca;for(let p=0,u=0;p<n.length;p+=9,u+=6){e.set(n[p+0],n[p+1],n[p+2]),t.set(n[p+3],n[p+4],n[p+5]),r.set(n[p+6],n[p+7],n[p+8]),a.set(i[u+0],i[u+1]),s.set(i[u+2],i[u+3]),l.set(i[u+4],i[u+5]),o.copy(e).add(t).add(r).divideScalar(3);const h=c(o);$(a,u+0,e,h),$(s,u+2,t,h),$(l,u+4,r,h)}})(),function(){for(let e=0;e<i.length;e+=6){const t=i[e+0],r=i[e+2],o=i[e+4],n=Math.max(t,r,o),a=Math.min(t,r,o);n>.9&&a<.1&&(t<.2&&(i[e+0]+=1),r<.2&&(i[e+2]+=1),o<.2&&(i[e+4]+=1))}}()}(),this.setAttribute("position",new ea(n,3)),this.setAttribute("normal",new ea(n.slice(),3)),this.setAttribute("uv",new ea(i,2)),0===o?this.computeVertexNormals():this.normalizeNormals()}function xh(e,t){la.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new mf(e,t)),this.mergeVertices()}function mf(e,t){kb.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function yh(e,t){la.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new zd(e,t)),this.mergeVertices()}function zd(e,t){kb.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Bh(e,t){la.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new _e(e,t)),this.mergeVertices()}function _e(e,t){const r=(1+Math.sqrt(5))/2,o=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];kb.call(this,o,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Dh(e,t){la.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new We(e,t)),this.mergeVertices()}function We(e,t){const r=(1+Math.sqrt(5))/2,o=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-r,0,-o,r,0,o,-r,0,o,r,-o,-r,0,-o,r,0,o,-r,0,o,r,0,-r,0,-o,r,0,-o,-r,0,o,r,0,o];kb.call(this,n,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ih(e,t,r,o,n,i){la.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:o,closed:n},void 0!==i&&console.warn("THREE.TubeGeometry: taper has been removed.");const a=new td(e,t,r,o,n);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function td(e,t,r,o,n){ga.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:o,closed:n},t=t||64,r=r||1,o=o||8,n=n||!1;const i=e.computeFrenetFrames(t,n);this.tangents=i.tangents,this.normals=i.normals,this.binormals=i.binormals;const a=new aa,s=new aa,l=new ca;let $=new aa;const c=[],p=[],u=[],h=[];function d(n){$=e.getPointAt(n/t,$);const l=i.normals[n],u=i.binormals[n];for(let e=0;e<=o;e++){const t=e/o*Math.PI*2,n=Math.sin(t),i=-Math.cos(t);s.x=i*l.x+n*u.x,s.y=i*l.y+n*u.y,s.z=i*l.z+n*u.z,s.normalize(),p.push(s.x,s.y,s.z),a.x=$.x+r*s.x,a.y=$.y+r*s.y,a.z=$.z+r*s.z,c.push(a.x,a.y,a.z)}}!function(){for(let e=0;e<t;e++)d(e);d(!1===n?t:0),function(){for(let e=0;e<=t;e++)for(let r=0;r<=o;r++)l.x=e/t,l.y=r/o,u.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=o;t++){const r=(o+1)*(e-1)+(t-1),n=(o+1)*e+(t-1),i=(o+1)*e+t,a=(o+1)*(e-1)+t;h.push(r,n,a),h.push(n,i,a)}}()}(),this.setIndex(h),this.setAttribute("position",new ea(c,3)),this.setAttribute("normal",new ea(p,3)),this.setAttribute("uv",new ea(u,2))}function Jh(e,t,r,o,n,i,a){la.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:o,p:n,q:i},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ff(e,t,r,o,n,i)),this.mergeVertices()}function Ff(e,t,r,o,n,i){ga.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:o,p:n,q:i},e=e||1,t=t||.4,r=Math.floor(r)||64,o=Math.floor(o)||8,n=n||2,i=i||3;const a=[],s=[],l=[],$=[],c=new aa,p=new aa,u=new aa,h=new aa,d=new aa,f=new aa,m=new aa;for(let g=0;g<=r;++g){const a=g/r*n*Math.PI*2;x(a,n,i,e,u),x(a+.01,n,i,e,h),f.subVectors(h,u),m.addVectors(h,u),d.crossVectors(f,m),m.crossVectors(d,f),d.normalize(),m.normalize();for(let e=0;e<=o;++e){const n=e/o*Math.PI*2,i=-t*Math.cos(n),a=t*Math.sin(n);c.x=u.x+(i*m.x+a*d.x),c.y=u.y+(i*m.y+a*d.y),c.z=u.z+(i*m.z+a*d.z),s.push(c.x,c.y,c.z),p.subVectors(c,u).normalize(),l.push(p.x,p.y,p.z),$.push(g/r),$.push(e/o)}}for(let g=1;g<=r;g++)for(let e=1;e<=o;e++){const t=(o+1)*(g-1)+(e-1),r=(o+1)*g+(e-1),n=(o+1)*g+e,i=(o+1)*(g-1)+e;a.push(t,r,i),a.push(r,n,i)}function x(e,t,r,o,n){const i=Math.cos(e),a=Math.sin(e),s=r/t*e,l=Math.cos(s);n.x=o*(2+l)*.5*i,n.y=o*(2+l)*a*.5,n.z=o*Math.sin(s)*.5}this.setIndex(a),this.setAttribute("position",new ea(s,3)),this.setAttribute("normal",new ea(l,3)),this.setAttribute("uv",new ea($,2))}function Lh(e,t,r,o,n){la.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:o,arc:n},this.fromBufferGeometry(new yf(e,t,r,o,n)),this.mergeVertices()}function yf(e,t,r,o,n){ga.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:o,arc:n},e=e||1,t=t||.4,r=Math.floor(r)||8,o=Math.floor(o)||6,n=n||2*Math.PI;const i=[],a=[],s=[],l=[],$=new aa,c=new aa,p=new aa;for(let u=0;u<=r;u++)for(let i=0;i<=o;i++){const h=i/o*n,d=u/r*Math.PI*2;c.x=(e+t*Math.cos(d))*Math.cos(h),c.y=(e+t*Math.cos(d))*Math.sin(h),c.z=t*Math.sin(d),a.push(c.x,c.y,c.z),$.x=e*Math.cos(h),$.y=e*Math.sin(h),p.subVectors(c,$).normalize(),s.push(p.x,p.y,p.z),l.push(i/o),l.push(u/r)}for(let u=1;u<=r;u++)for(let e=1;e<=o;e++){const t=(o+1)*u+e-1,r=(o+1)*(u-1)+e-1,n=(o+1)*(u-1)+e,a=(o+1)*u+e;i.push(t,r,a),i.push(r,n,a)}this.setIndex(i),this.setAttribute("position",new ea(a,3)),this.setAttribute("normal",new ea(s,3)),this.setAttribute("uv",new ea(l,2))}ki.prototype=Object.assign(Object.create(da.prototype),{constructor:ki,isPoints:!0,copy:function(e){return da.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){const r=this.geometry,o=this.matrixWorld,n=e.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),hh.copy(r.boundingSphere),hh.applyMatrix4(o),hh.radius+=n,!1===e.ray.intersectsSphere(hh))return;zo.getInverse(o),ti.copy(e.ray).applyMatrix4(zo);const i=n/((this.scale.x+this.scale.y+this.scale.z)/3),a=i*i;if(r.isBufferGeometry){const n=r.index,i=r.attributes.position.array;if(null!==n){const r=n.array;for(let n=0,s=r.length;n<s;n++){const s=r[n];ih.fromArray(i,3*s),ji(ih,s,a,o,e,t,this)}}else for(let r=0,s=i.length/3;r<s;r++)ih.fromArray(i,3*r),ji(ih,r,a,o,e,t,this)}else{const n=r.vertices;for(let r=0,i=n.length;r<i;r++)ji(n[r],r,a,o,e,t,this)}},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),xo.prototype=Object.assign(Object.create(va.prototype),{constructor:xo,isVideoTexture:!0,update:function(){const e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Of.prototype=Object.create(va.prototype),Of.prototype.constructor=Of,Of.prototype.isCompressedTexture=!0,nh.prototype=Object.create(va.prototype),nh.prototype.constructor=nh,nh.prototype.isCanvasTexture=!0,ph.prototype=Object.create(va.prototype),ph.prototype.constructor=ph,ph.prototype.isDepthTexture=!0,qh.prototype=Object.create(ga.prototype),qh.prototype.constructor=qh,uh.prototype=Object.create(la.prototype),uh.prototype.constructor=uh,xf.prototype=Object.create(ga.prototype),xf.prototype.constructor=xf,vh.prototype=Object.create(la.prototype),vh.prototype.constructor=vh,kb.prototype=Object.create(ga.prototype),kb.prototype.constructor=kb,xh.prototype=Object.create(la.prototype),xh.prototype.constructor=xh,mf.prototype=Object.create(kb.prototype),mf.prototype.constructor=mf,yh.prototype=Object.create(la.prototype),yh.prototype.constructor=yh,zd.prototype=Object.create(kb.prototype),zd.prototype.constructor=zd,Bh.prototype=Object.create(la.prototype),Bh.prototype.constructor=Bh,_e.prototype=Object.create(kb.prototype),_e.prototype.constructor=_e,Dh.prototype=Object.create(la.prototype),Dh.prototype.constructor=Dh,We.prototype=Object.create(kb.prototype),We.prototype.constructor=We,Ih.prototype=Object.create(la.prototype),Ih.prototype.constructor=Ih,td.prototype=Object.create(ga.prototype),td.prototype.constructor=td,td.prototype.toJSON=function(){const e=ga.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},Jh.prototype=Object.create(la.prototype),Jh.prototype.constructor=Jh,Ff.prototype=Object.create(ga.prototype),Ff.prototype.constructor=Ff,Lh.prototype=Object.create(la.prototype),Lh.prototype.constructor=Lh,yf.prototype=Object.create(ga.prototype),yf.prototype.constructor=yf;const tu={triangulate:function(e,t,r){r=r||2;let o,n,i,a,s,l,$,c=t&&t.length,p=c?t[0]*r:e.length,u=lo(e,0,p,r,!0),h=[];if(!u||u.next===u.prev)return h;if(c&&(u=Bu(e,t,u,r)),e.length>80*r){o=i=e[0],n=a=e[1];for(let t=r;t<p;t+=r)(s=e[t])<o&&(o=s),(l=e[t+1])<n&&(n=l),s>i&&(i=s),l>a&&(a=l);$=0!==($=Math.max(i-o,a-n))?1/$:0}return nf(u,h,r,o,n,$),h}};function lo(e,t,r,o,n){let i,a;if(n===Yu(e,t,r,o)>0)for(i=t;i<r;i+=o)a=co(i,e[i],e[i+1],a);else for(i=r-o;i>=t;i-=o)a=co(i,e[i],e[i+1],a);return a&&Ph(a,a.next)&&(bg(a),a=a.next),a}function Hc(e,t){if(!e)return e;t||(t=e);let r,o=e;do{if(r=!1,o.steiner||!Ph(o,o.next)&&0!==Aa(o.prev,o,o.next))o=o.next;else{if(bg(o),(o=t=o.prev)===o.next)break;r=!0}}while(r||o!==t);return t}function nf(e,t,r,o,n,i,a){if(!e)return;!a&&i&&Gu(e,o,n,i);let s,l,$=e;for(;e.prev!==e.next;)if(s=e.prev,l=e.next,i?yu(e,o,n,i):xu(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),bg(e),e=l.next,$=l.next;else if((e=l)===$){a?1===a?nf(e=zu(Hc(e),t,r),t,r,o,n,i,2):2===a&&Au(e,t,r,o,n,i):nf(Hc(e),t,r,o,n,i,1);break}}function xu(e){let t=e.prev,r=e,o=e.next;if(Aa(t,r,o)>=0)return!1;let n=e.next.next;for(;n!==e.prev;){if(Ie(t.x,t.y,r.x,r.y,o.x,o.y,n.x,n.y)&&Aa(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function yu(e,t,r,o){let n=e.prev,i=e,a=e.next;if(Aa(n,i,a)>=0)return!1;let s=n.x<i.x?n.x<a.x?n.x:a.x:i.x<a.x?i.x:a.x,l=n.y<i.y?n.y<a.y?n.y:a.y:i.y<a.y?i.y:a.y,$=n.x>i.x?n.x>a.x?n.x:a.x:i.x>a.x?i.x:a.x,c=n.y>i.y?n.y>a.y?n.y:a.y:i.y>a.y?i.y:a.y,p=Jj(s,l,t,r,o),u=Jj($,c,t,r,o),h=e.prevZ,d=e.nextZ;for(;h&&h.z>=p&&d&&d.z<=u;){if(h!==e.prev&&h!==e.next&&Ie(n.x,n.y,i.x,i.y,a.x,a.y,h.x,h.y)&&Aa(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==e.prev&&d!==e.next&&Ie(n.x,n.y,i.x,i.y,a.x,a.y,d.x,d.y)&&Aa(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=p;){if(h!==e.prev&&h!==e.next&&Ie(n.x,n.y,i.x,i.y,a.x,a.y,h.x,h.y)&&Aa(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=u;){if(d!==e.prev&&d!==e.next&&Ie(n.x,n.y,i.x,i.y,a.x,a.y,d.x,d.y)&&Aa(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function zu(e,t,r){let o=e;do{let n=o.prev,i=o.next.next;!Ph(n,i)&&go(n,o,o.next,i)&&cg(n,i)&&cg(i,n)&&(t.push(n.i/r),t.push(o.i/r),t.push(i.i/r),bg(o),bg(o.next),o=e=i),o=o.next}while(o!==e);return Hc(o)}function Au(e,t,r,o,n,i){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&Lu(a,e)){let s=eo(a,e);return a=Hc(a,a.next),s=Hc(s,s.next),nf(a,t,r,o,n,i),void nf(s,t,r,o,n,i)}e=e.next}a=a.next}while(a!==e)}function Bu(e,t,r,o){let n,i,a,s,l,$=[];for(n=0,i=t.length;n<i;n++)(l=lo(e,a=t[n]*o,s=n<i-1?t[n+1]*o:e.length,o,!1))===l.next&&(l.steiner=!0),$.push(Ju(l));for($.sort(Cu),n=0;n<$.length;n++)Du($[n],r),r=Hc(r,r.next);return r}function Cu(e,t){return e.x-t.x}function Du(e,t){if(t=Eu(e,t)){const r=eo(t,e);Hc(t,t.next),Hc(r,r.next)}}function Eu(e,t){let r,o=t,n=e.x,i=e.y,a=-1/0;do{if(i<=o.y&&i>=o.next.y&&o.next.y!==o.y){let e=o.x+(i-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(e<=n&&e>a){if(a=e,e===n){if(i===o.y)return o;if(i===o.next.y)return o.next}r=o.x<o.next.x?o:o.next}}o=o.next}while(o!==t);if(!r)return null;if(n===a)return r;let s,l=r,$=r.x,c=r.y,p=1/0;o=r;do{n>=o.x&&o.x>=$&&n!==o.x&&Ie(i<c?n:a,i,$,c,i<c?a:n,i,o.x,o.y)&&(s=Math.abs(i-o.y)/(n-o.x),cg(o,e)&&(s<p||s===p&&(o.x>r.x||o.x===r.x&&Fu(r,o)))&&(r=o,p=s)),o=o.next}while(o!==l);return r}function Fu(e,t){return Aa(e.prev,e,t.prev)<0&&Aa(t.next,e,e.next)<0}function Gu(e,t,r,o){let n=e;do{null===n.z&&(n.z=Jj(n.x,n.y,t,r,o)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,Hu(n)}function Hu(e){let t,r,o,n,i,a,s,l,$=1;do{for(r=e,e=null,i=null,a=0;r;){for(a++,o=r,s=0,t=0;t<$&&(s++,o=o.nextZ);t++);for(l=$;s>0||l>0&&o;)0!==s&&(0===l||!o||r.z<=o.z)?(n=r,r=r.nextZ,s--):(n=o,o=o.nextZ,l--),i?i.nextZ=n:e=n,n.prevZ=i,i=n;r=o}i.nextZ=null,$*=2}while(a>1);return e}function Jj(e,t,r,o,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-o)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ju(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Ie(e,t,r,o,n,i,a,s){return(n-a)*(t-s)-(e-a)*(i-s)>=0&&(e-a)*(o-s)-(r-a)*(t-s)>=0&&(r-a)*(i-s)-(n-a)*(o-s)>=0}function Lu(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Ru(e,t)&&(cg(e,t)&&cg(t,e)&&Tu(e,t)&&(Aa(e.prev,e,t.prev)||Aa(e,t.prev,t))||Ph(e,t)&&Aa(e.prev,e,e.next)>0&&Aa(t.prev,t,t.next)>0)}function Aa(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ph(e,t){return e.x===t.x&&e.y===t.y}function go(e,t,r,o){const n=Rh(Aa(e,t,r)),i=Rh(Aa(e,t,o)),a=Rh(Aa(r,o,e)),s=Rh(Aa(r,o,t));return n!==i&&a!==s||!(0!==n||!Qh(e,r,t))||!(0!==i||!Qh(e,o,t))||!(0!==a||!Qh(r,e,o))||!(0!==s||!Qh(r,t,o))}function Qh(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Rh(e){return e>0?1:e<0?-1:0}function Ru(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&go(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function cg(e,t){return Aa(e.prev,e,e.next)<0?Aa(e,t,e.next)>=0&&Aa(e,e.prev,t)>=0:Aa(e,t,e.prev)<0||Aa(e,e.next,t)<0}function Tu(e,t){let r=e,o=!1,n=(e.x+t.x)/2,i=(e.y+t.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&n<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(o=!o),r=r.next}while(r!==e);return o}function eo(e,t){let r=new gj(e.i,e.x,e.y),o=new gj(t.i,t.x,t.y),n=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,o.next=r,r.prev=o,i.next=o,o.prev=i,o}function co(e,t,r,o){const n=new gj(e,t,r);return o?(n.next=o.next,n.prev=o,o.next.prev=n,o.next=n):(n.prev=n,n.next=n),n}function bg(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function gj(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yu(e,t,r,o){let n=0;for(let i=t,a=r-o;i<r;i+=o)n+=(e[a]-e[i])*(e[i+1]+e[a+1]),a=i;return n}const Lc={area:function(e){const t=e.length;let r=0;for(let o=t-1,n=0;n<t;o=n++)r+=e[o].x*e[n].y-e[n].x*e[o].y;return .5*r},isClockWise:function(e){return Lc.area(e)<0},triangulateShape:function(e,t){const r=[],o=[],n=[];ao(e),_n(r,e);let i=e.length;t.forEach(ao);for(let s=0;s<t.length;s++)o.push(i),i+=t[s].length,_n(r,t[s]);const a=tu.triangulate(r,o);for(let s=0;s<a.length;s+=3)n.push(a.slice(s,s+3));return n}};function ao(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function _n(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}function Id(e,t){la.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new nc(e,t)),this.mergeVertices()}function nc(e,t){ga.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,o=[],n=[];for(let a=0,s=e.length;a<s;a++){i(e[a])}function i(e){const i=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1;let l=void 0!==t.depth?t.depth:100,$=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,p=void 0!==t.bevelSize?t.bevelSize:c-2,u=void 0!==t.bevelOffset?t.bevelOffset:0,h=void 0!==t.bevelSegments?t.bevelSegments:3;const d=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:cv;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);let m,x,g,v,F,K=!1;d&&(m=d.getSpacedPoints(s),K=!0,$=!1,x=d.computeFrenetFrames(s,!1),g=new aa,v=new aa,F=new aa),$||(h=0,c=0,p=0,u=0);const y=e.extractPoints(a);let _=y.shape;const b=y.holes;if(!Lc.isClockWise(_)){_=_.reverse();for(let e=0,t=b.length;e<t;e++){const t=b[e];Lc.isClockWise(t)&&(b[e]=t.reverse())}}const M=Lc.triangulateShape(_,b),w=_;for(let t=0,r=b.length;t<r;t++){const e=b[t];_=_.concat(e)}function S(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}const T=_.length,A=M.length;function E(e,t,r){let o,n,i;const a=e.x-t.x,s=e.y-t.y,l=r.x-e.x,$=r.y-e.y,c=a*a+s*s,p=a*$-s*l;if(Math.abs(p)>Number.EPSILON){const p=Math.sqrt(c),u=Math.sqrt(l*l+$*$),h=t.x-s/p,d=t.y+a/p,f=((r.x-$/u-h)*$-(r.y+l/u-d)*l)/(a*$-s*l),m=(o=h+a*f-e.x)*o+(n=d+s*f-e.y)*n;if(m<=2)return new ca(o,n);i=Math.sqrt(m/2)}else{let e=!1;a>Number.EPSILON?l>Number.EPSILON&&(e=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(s)===Math.sign($)&&(e=!0),e?(o=-s,n=a,i=Math.sqrt(c)):(o=a,n=s,i=Math.sqrt(c/2))}return new ca(o/i,n/i)}const L=[];for(let t=0,r=w.length,o=r-1,n=t+1;t<r;t++,o++,n++)o===r&&(o=0),n===r&&(n=0),L[t]=E(w[t],w[o],w[n]);const C=[];let R,B=L.concat();for(let t=0,r=b.length;t<r;t++){const e=b[t];R=[];for(let t=0,r=e.length,o=r-1,n=t+1;t<r;t++,o++,n++)o===r&&(o=0),n===r&&(n=0),R[t]=E(e[t],e[o],e[n]);C.push(R),B=B.concat(R)}for(let t=0;t<h;t++){const e=t/h,r=c*Math.cos(e*Math.PI/2),o=p*Math.sin(e*Math.PI/2)+u;for(let t=0,n=w.length;t<n;t++){const e=S(w[t],L[t],o);D(e.x,e.y,-r)}for(let t=0,n=b.length;t<n;t++){const e=b[t];R=C[t];for(let t=0,n=e.length;t<n;t++){const n=S(e[t],R[t],o);D(n.x,n.y,-r)}}}const P=p+u;for(let t=0;t<T;t++){const e=$?S(_[t],B[t],P):_[t];K?(v.copy(x.normals[0]).multiplyScalar(e.x),g.copy(x.binormals[0]).multiplyScalar(e.y),F.copy(m[0]).add(v).add(g),D(F.x,F.y,F.z)):D(e.x,e.y,0)}for(let t=1;t<=s;t++)for(let e=0;e<T;e++){const r=$?S(_[e],B[e],P):_[e];K?(v.copy(x.normals[t]).multiplyScalar(r.x),g.copy(x.binormals[t]).multiplyScalar(r.y),F.copy(m[t]).add(v).add(g),D(F.x,F.y,F.z)):D(r.x,r.y,l/s*t)}for(let t=h-1;t>=0;t--){const e=t/h,r=c*Math.cos(e*Math.PI/2),o=p*Math.sin(e*Math.PI/2)+u;for(let t=0,n=w.length;t<n;t++){const e=S(w[t],L[t],o);D(e.x,e.y,l+r)}for(let t=0,n=b.length;t<n;t++){const e=b[t];R=C[t];for(let t=0,n=e.length;t<n;t++){const n=S(e[t],R[t],o);K?D(n.x,n.y+m[s-1].y,m[s-1].x+r):D(n.x,n.y,l+r)}}}function G(e,t){let r=e.length;for(;--r>=0;){const o=r;let n=r-1;n<0&&(n=e.length-1);for(let e=0,r=s+2*h;e<r;e++){const r=T*e,i=T*(e+1);O(t+o+r,t+n+r,t+n+i,t+o+i)}}}function D(e,t,r){i.push(e),i.push(t),i.push(r)}function I(e,t,n){N(e),N(t),N(n);const i=o.length/3,a=f.generateTopUV(r,o,i-3,i-2,i-1);V(a[0]),V(a[1]),V(a[2])}function O(e,t,n,i){N(e),N(t),N(i),N(t),N(n),N(i);const a=o.length/3,s=f.generateSideWallUV(r,o,a-6,a-3,a-2,a-1);V(s[0]),V(s[1]),V(s[3]),V(s[1]),V(s[2]),V(s[3])}function N(e){o.push(i[3*e+0]),o.push(i[3*e+1]),o.push(i[3*e+2])}function V(e){n.push(e.x),n.push(e.y)}!function(){const e=o.length/3;if($){let e=0,t=T*e;for(let r=0;r<A;r++){const e=M[r];I(e[2]+t,e[1]+t,e[0]+t)}t=T*(e=s+2*h);for(let r=0;r<A;r++){const e=M[r];I(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<A;e++){const t=M[e];I(t[2],t[1],t[0])}for(let e=0;e<A;e++){const t=M[e];I(t[0]+T*s,t[1]+T*s,t[2]+T*s)}}r.addGroup(e,o.length/3-e,0)}(),function(){const e=o.length/3;let t=0;G(w,t),t+=w.length;for(let r=0,o=b.length;r<o;r++){const e=b[r];G(e,t),t+=e.length}r.addGroup(e,o.length/3-e,1)}()}this.setAttribute("position",new ea(o,3)),this.setAttribute("uv",new ea(n,2)),this.computeVertexNormals()}Id.prototype=Object.create(la.prototype),Id.prototype.constructor=Id,Id.prototype.toJSON=function(){const e=la.prototype.toJSON.call(this);return Zn(this.parameters.shapes,this.parameters.options,e)},nc.prototype=Object.create(ga.prototype),nc.prototype.constructor=nc,nc.prototype.toJSON=function(){const e=ga.prototype.toJSON.call(this);return Zn(this.parameters.shapes,this.parameters.options,e)};const cv={generateTopUV:function(e,t,r,o,n){const i=t[3*r],a=t[3*r+1],s=t[3*o],l=t[3*o+1],$=t[3*n],c=t[3*n+1];return[new ca(i,a),new ca(s,l),new ca($,c)]},generateSideWallUV:function(e,t,r,o,n,i){const a=t[3*r],s=t[3*r+1],l=t[3*r+2],$=t[3*o],c=t[3*o+1],p=t[3*o+2],u=t[3*n],h=t[3*n+1],d=t[3*n+2],f=t[3*i],m=t[3*i+1],x=t[3*i+2];return Math.abs(s-c)<.01?[new ca(a,1-l),new ca($,1-p),new ca(u,1-d),new ca(f,1-x)]:[new ca(s,1-l),new ca(c,1-p),new ca(h,1-d),new ca(m,1-x)]}};function Zn(e,t,r){if(r.shapes=[],Array.isArray(e))for(let o=0,n=e.length;o<n;o++){const t=e[o];r.shapes.push(t.uuid)}else r.shapes.push(e.uuid);return void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}function Vh(e,t){la.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Ef(e,t)),this.mergeVertices()}function Ef(e,t){const r=(t=t||{}).font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new la;const o=r.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),nc.call(this,o,t),this.type="TextBufferGeometry"}function Wh(e,t,r,o,n,i,a){la.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:o,phiLength:n,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new Ad(e,t,r,o,n,i,a)),this.mergeVertices()}function Ad(e,t,r,o,n,i,a){ga.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:o,phiLength:n,thetaStart:i,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6),o=void 0!==o?o:0,n=void 0!==n?n:2*Math.PI,i=void 0!==i?i:0,a=void 0!==a?a:Math.PI;const s=Math.min(i+a,Math.PI);let l=0;const $=[],c=new aa,p=new aa,u=[],h=[],d=[],f=[];for(let m=0;m<=r;m++){const u=[],x=m/r;let g=0;0==m&&0==i?g=.5/t:m==r&&s==Math.PI&&(g=-.5/t);for(let r=0;r<=t;r++){const s=r/t;c.x=-e*Math.cos(o+s*n)*Math.sin(i+x*a),c.y=e*Math.cos(i+x*a),c.z=e*Math.sin(o+s*n)*Math.sin(i+x*a),h.push(c.x,c.y,c.z),p.copy(c).normalize(),d.push(p.x,p.y,p.z),f.push(s+g,1-x),u.push(l++)}$.push(u)}for(let m=0;m<r;m++)for(let e=0;e<t;e++){const t=$[m][e+1],o=$[m][e],n=$[m+1][e],a=$[m+1][e+1];(0!==m||i>0)&&u.push(t,o,a),(m!==r-1||s<Math.PI)&&u.push(o,n,a)}this.setIndex(u),this.setAttribute("position",new ea(h,3)),this.setAttribute("normal",new ea(d,3)),this.setAttribute("uv",new ea(f,2))}function Xh(e,t,r,o,n,i){la.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:o,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new ef(e,t,r,o,n,i)),this.mergeVertices()}function ef(e,t,r,o,n,i){ga.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:o,thetaStart:n,thetaLength:i},e=e||.5,t=t||1,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI,r=void 0!==r?Math.max(3,r):8;const a=[],s=[],l=[],$=[];let c=e;const p=(t-e)/(o=void 0!==o?Math.max(1,o):1),u=new aa,h=new ca;for(let d=0;d<=o;d++){for(let e=0;e<=r;e++){const o=n+e/r*i;u.x=c*Math.cos(o),u.y=c*Math.sin(o),s.push(u.x,u.y,u.z),l.push(0,0,1),h.x=(u.x/t+1)/2,h.y=(u.y/t+1)/2,$.push(h.x,h.y)}c+=p}for(let d=0;d<o;d++){const e=d*(r+1);for(let t=0;t<r;t++){const o=t+e,n=o,i=o+r+1,s=o+r+2,l=o+1;a.push(n,i,l),a.push(i,s,l)}}this.setIndex(a),this.setAttribute("position",new ea(s,3)),this.setAttribute("normal",new ea(l,3)),this.setAttribute("uv",new ea($,2))}function _h(e,t,r,o){la.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:o},this.fromBufferGeometry(new Tf(e,t,r,o)),this.mergeVertices()}function Tf(e,t,r,o){ga.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:o},t=Math.floor(t)||12,r=r||0,o=o||2*Math.PI,o=ma.clamp(o,0,2*Math.PI);const n=[],i=[],a=[],s=1/t,l=new aa,$=new ca;for(let c=0;c<=t;c++){const n=r+c*s*o,p=Math.sin(n),u=Math.cos(n);for(let r=0;r<=e.length-1;r++)l.x=e[r].x*p,l.y=e[r].y,l.z=e[r].x*u,i.push(l.x,l.y,l.z),$.x=c/t,$.y=r/(e.length-1),a.push($.x,$.y)}for(let c=0;c<t;c++)for(let t=0;t<e.length-1;t++){const r=t+c*e.length,o=r,i=r+e.length,a=r+e.length+1,s=r+1;n.push(o,i,s),n.push(i,a,s)}if(this.setIndex(n),this.setAttribute("position",new ea(i,3)),this.setAttribute("uv",new ea(a,2)),this.computeVertexNormals(),o===2*Math.PI){const r=this.attributes.normal.array,o=new aa,n=new aa,i=new aa,a=t*e.length*3;for(let t=0,s=0;t<e.length;t++,s+=3)o.x=r[s+0],o.y=r[s+1],o.z=r[s+2],n.x=r[a+s+0],n.y=r[a+s+1],n.z=r[a+s+2],i.addVectors(o,n).normalize(),r[s+0]=r[a+s+0]=i.x,r[s+1]=r[a+s+1]=i.y,r[s+2]=r[a+s+2]=i.z}}function Se(e,t){la.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Wd(e,t)),this.mergeVertices()}function Wd(e,t){ga.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;const r=[],o=[],n=[],i=[];let a=0,s=0;if(!1===Array.isArray(e))l(e);else for(let $=0;$<e.length;$++)l(e[$]),this.addGroup(a,s,$),a+=s,s=0;function l(e){const a=o.length/3,l=e.extractPoints(t);let $=l.shape;const c=l.holes;!1===Lc.isClockWise($)&&($=$.reverse());for(let t=0,r=c.length;t<r;t++){const e=c[t];!0===Lc.isClockWise(e)&&(c[t]=e.reverse())}const p=Lc.triangulateShape($,c);for(let t=0,r=c.length;t<r;t++){const e=c[t];$=$.concat(e)}for(let t=0,r=$.length;t<r;t++){const e=$[t];o.push(e.x,e.y,0),n.push(0,0,1),i.push(e.x,e.y)}for(let t=0,o=p.length;t<o;t++){const e=p[t],o=e[0]+a,n=e[1]+a,i=e[2]+a;r.push(o,n,i),s+=3}}this.setIndex(r),this.setAttribute("position",new ea(o,3)),this.setAttribute("normal",new ea(n,3)),this.setAttribute("uv",new ea(i,2))}function Yn(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,o=e.length;r<o;r++){const o=e[r];t.shapes.push(o.uuid)}else t.shapes.push(e.uuid);return t}function ai(e,t){ga.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;const r=[],o=Math.cos(ma.DEG2RAD*t),n=[0,0],i={};let a,s,l;const $=["a","b","c"];let c;e.isBufferGeometry?(c=new la).fromBufferGeometry(e):c=e.clone(),c.mergeVertices(),c.computeFaceNormals();const p=c.vertices,u=c.faces;for(let h=0,d=u.length;h<d;h++){const e=u[h];for(let t=0;t<3;t++)a=e[$[t]],s=e[$[(t+1)%3]],n[0]=Math.min(a,s),n[1]=Math.max(a,s),void 0===i[l=n[0]+","+n[1]]?i[l]={index1:n[0],index2:n[1],face1:h,face2:void 0}:i[l].face2=h}for(l in i){const e=i[l];if(void 0===e.face2||u[e.face1].normal.dot(u[e.face2].normal)<=o){let t=p[e.index1];r.push(t.x,t.y,t.z),t=p[e.index2],r.push(t.x,t.y,t.z)}}this.setAttribute("position",new ea(r,3))}function Od(e,t,r,o,n,i,a,s){la.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:o,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Sc(e,t,r,o,n,i,a,s)),this.mergeVertices()}function Sc(e,t,r,o,n,i,a,s){ga.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:o,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:s};const l=this;e=void 0!==e?e:1,t=void 0!==t?t:1,r=r||1,o=Math.floor(o)||8,n=Math.floor(n)||1,i=void 0!==i&&i,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;const $=[],c=[],p=[],u=[];let h=0;const d=[],f=r/2;let m=0;function x(r){let n,i;const d=new ca,x=new aa;let g=0;const v=!0===r?e:t,F=!0===r?1:-1;n=h;for(let e=1;e<=o;e++)c.push(0,f*F,0),p.push(0,F,0),u.push(.5,.5),h++;i=h;for(let e=0;e<=o;e++){const t=e/o*s+a,r=Math.cos(t),n=Math.sin(t);x.x=v*n,x.y=f*F,x.z=v*r,c.push(x.x,x.y,x.z),p.push(0,F,0),d.x=.5*r+.5,d.y=.5*n*F+.5,u.push(d.x,d.y),h++}for(let e=0;e<o;e++){const t=n+e,o=i+e;!0===r?$.push(o,o+1,t):$.push(o+1,o,t),g+=3}l.addGroup(m,g,!0===r?1:2),m+=g}!function(){const i=new aa,x=new aa;let g=0;const v=(t-e)/r;for(let l=0;l<=n;l++){const $=[],m=l/n,g=m*(t-e)+e;for(let e=0;e<=o;e++){const t=e/o,n=t*s+a,l=Math.sin(n),d=Math.cos(n);x.x=g*l,x.y=-m*r+f,x.z=g*d,c.push(x.x,x.y,x.z),i.set(l,v,d).normalize(),p.push(i.x,i.y,i.z),u.push(t,1-m),$.push(h++)}d.push($)}for(let e=0;e<o;e++)for(let t=0;t<n;t++){const r=d[t][e],o=d[t+1][e],n=d[t+1][e+1],i=d[t][e+1];$.push(r,o,i),$.push(o,n,i),g+=6}l.addGroup(m,g,0),m+=g}(),!1===i&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex($),this.setAttribute("position",new ea(c,3)),this.setAttribute("normal",new ea(p,3)),this.setAttribute("uv",new ea(u,2))}function ci(e,t,r,o,n,i,a){Od.call(this,0,e,t,r,o,n,i,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:o,openEnded:n,thetaStart:i,thetaLength:a}}function ei(e,t,r,o,n,i,a){Sc.call(this,0,e,t,r,o,n,i,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:o,openEnded:n,thetaStart:i,thetaLength:a}}function Ig(e,t,r,o){la.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Kf(e,t,r,o)),this.mergeVertices()}function Kf(e,t,r,o){ga.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:o},e=e||1,t=void 0!==t?Math.max(3,t):8,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI;const n=[],i=[],a=[],s=[],l=new aa,$=new ca;i.push(0,0,0),a.push(0,0,1),s.push(.5,.5);for(let c=0,p=3;c<=t;c++,p+=3){const n=r+c/t*o;l.x=e*Math.cos(n),l.y=e*Math.sin(n),i.push(l.x,l.y,l.z),a.push(0,0,1),$.x=(i[p]/e+1)/2,$.y=(i[p+1]/e+1)/2,s.push($.x,$.y)}for(let c=1;c<=t;c++)n.push(c,c+1,0);this.setIndex(n),this.setAttribute("position",new ea(i,3)),this.setAttribute("normal",new ea(a,3)),this.setAttribute("uv",new ea(s,2))}Vh.prototype=Object.create(la.prototype),Vh.prototype.constructor=Vh,Ef.prototype=Object.create(nc.prototype),Ef.prototype.constructor=Ef,Wh.prototype=Object.create(la.prototype),Wh.prototype.constructor=Wh,Ad.prototype=Object.create(ga.prototype),Ad.prototype.constructor=Ad,Xh.prototype=Object.create(la.prototype),Xh.prototype.constructor=Xh,ef.prototype=Object.create(ga.prototype),ef.prototype.constructor=ef,_h.prototype=Object.create(la.prototype),_h.prototype.constructor=_h,Tf.prototype=Object.create(ga.prototype),Tf.prototype.constructor=Tf,Se.prototype=Object.create(la.prototype),Se.prototype.constructor=Se,Se.prototype.toJSON=function(){const e=la.prototype.toJSON.call(this);return Yn(this.parameters.shapes,e)},Wd.prototype=Object.create(ga.prototype),Wd.prototype.constructor=Wd,Wd.prototype.toJSON=function(){const e=ga.prototype.toJSON.call(this);return Yn(this.parameters.shapes,e)},ai.prototype=Object.create(ga.prototype),ai.prototype.constructor=ai,Od.prototype=Object.create(la.prototype),Od.prototype.constructor=Od,Sc.prototype=Object.create(ga.prototype),Sc.prototype.constructor=Sc,ci.prototype=Object.create(Od.prototype),ci.prototype.constructor=ci,ei.prototype=Object.create(Sc.prototype),ei.prototype.constructor=ei,Ig.prototype=Object.create(la.prototype),Ig.prototype.constructor=Ig,Kf.prototype=Object.create(ga.prototype),Kf.prototype.constructor=Kf;var Za=Object.freeze({__proto__:null,WireframeGeometry:qh,ParametricGeometry:uh,ParametricBufferGeometry:xf,TetrahedronGeometry:xh,TetrahedronBufferGeometry:mf,OctahedronGeometry:yh,OctahedronBufferGeometry:zd,IcosahedronGeometry:Bh,IcosahedronBufferGeometry:_e,DodecahedronGeometry:Dh,DodecahedronBufferGeometry:We,PolyhedronGeometry:vh,PolyhedronBufferGeometry:kb,TubeGeometry:Ih,TubeBufferGeometry:td,TorusKnotGeometry:Jh,TorusKnotBufferGeometry:Ff,TorusGeometry:Lh,TorusBufferGeometry:yf,TextGeometry:Vh,TextBufferGeometry:Ef,SphereGeometry:Wh,SphereBufferGeometry:Ad,RingGeometry:Xh,RingBufferGeometry:ef,PlaneGeometry:Lg,PlaneBufferGeometry:Cc,LatheGeometry:_h,LatheBufferGeometry:Tf,ShapeGeometry:Se,ShapeBufferGeometry:Wd,ExtrudeGeometry:Id,ExtrudeBufferGeometry:nc,EdgesGeometry:ai,ConeGeometry:ci,ConeBufferGeometry:ei,CylinderGeometry:Od,CylinderBufferGeometry:Sc,CircleGeometry:Ig,CircleBufferGeometry:Kf,BoxGeometry:Kv,BoxBufferGeometry:Ag});function Fd(e){ja.call(this),this.type="ShadowMaterial",this.color=new ha(0),this.transparent=!0,this.setValues(e)}function Qc(e){Sa.call(this,e),this.type="RawShaderMaterial"}function qc(e){ja.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ha(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ha(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jd,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function Gd(e){qc.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ca(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(e)}function Xc(e){ja.call(this),this.type="MeshPhongMaterial",this.color=new ha(16777215),this.specular=new ha(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ha(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jd,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ug,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Pd(e){ja.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ha(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ha(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jd,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function _d(e){ja.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jd,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Be(e){ja.call(this),this.type="MeshLambertMaterial",this.color=new ha(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ha(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ug,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Re(e){ja.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ha(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jd,this.normalScale=new ca(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function vd(e){Ca.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Fd.prototype=Object.create(ja.prototype),Fd.prototype.constructor=Fd,Fd.prototype.isShadowMaterial=!0,Fd.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this},Qc.prototype=Object.create(Sa.prototype),Qc.prototype.constructor=Qc,Qc.prototype.isRawShaderMaterial=!0,qc.prototype=Object.create(ja.prototype),qc.prototype.constructor=qc,qc.prototype.isMeshStandardMaterial=!0,qc.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Gd.prototype=Object.create(qc.prototype),Gd.prototype.constructor=Gd,Gd.prototype.isMeshPhysicalMaterial=!0,Gd.prototype.copy=function(e){return qc.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new ha).copy(e.sheen):this.sheen=null,this.transparency=e.transparency,this},Xc.prototype=Object.create(ja.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isMeshPhongMaterial=!0,Xc.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Pd.prototype=Object.create(ja.prototype),Pd.prototype.constructor=Pd,Pd.prototype.isMeshToonMaterial=!0,Pd.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},_d.prototype=Object.create(ja.prototype),_d.prototype.constructor=_d,_d.prototype.isMeshNormalMaterial=!0,_d.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Be.prototype=Object.create(ja.prototype),Be.prototype.constructor=Be,Be.prototype.isMeshLambertMaterial=!0,Be.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Re.prototype=Object.create(ja.prototype),Re.prototype.constructor=Re,Re.prototype.isMeshMatcapMaterial=!0,Re.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},vd.prototype=Object.create(Ca.prototype),vd.prototype.constructor=vd,vd.prototype.isLineDashedMaterial=!0,vd.prototype.copy=function(e){return Ca.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Hv=Object.freeze({__proto__:null,ShadowMaterial:Fd,SpriteMaterial:hd,RawShaderMaterial:Qc,ShaderMaterial:Sa,PointsMaterial:Vc,MeshPhysicalMaterial:Gd,MeshStandardMaterial:qc,MeshPhongMaterial:Xc,MeshToonMaterial:Pd,MeshNormalMaterial:_d,MeshLambertMaterial:Be,MeshDepthMaterial:nd,MeshDistanceMaterial:md,MeshBasicMaterial:Ib,MeshMatcapMaterial:Re,LineDashedMaterial:vd,LineBasicMaterial:Ca,Material:ja});const za={arraySlice:function(e,t,r){return za.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,r=new Array(t);for(let o=0;o!==t;++o)r[o]=o;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(e,t,r){const o=e.length,n=new e.constructor(o);for(let i=0,a=0;a!==o;++i){const o=r[i]*t;for(let r=0;r!==t;++r)n[a++]=e[o+r]}return n},flattenJSON:function(e,t,r,o){let n=1,i=e[0];for(;void 0!==i&&void 0===i[o];)i=e[n++];if(void 0===i)return;let a=i[o];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=i[o])&&(t.push(i.time),r.push.apply(r,a)),i=e[n++]}while(void 0!==i);else if(void 0!==a.toArray)do{void 0!==(a=i[o])&&(t.push(i.time),a.toArray(r,r.length)),i=e[n++]}while(void 0!==i);else do{void 0!==(a=i[o])&&(t.push(i.time),r.push(a)),i=e[n++]}while(void 0!==i)},subclip:function(e,t,r,o,n){n=n||30;const i=e.clone();i.name=t;const a=[];for(let l=0;l<i.tracks.length;++l){const e=i.tracks[l],t=e.getValueSize(),s=[],$=[];for(let i=0;i<e.times.length;++i){const a=e.times[i]*n;if(!(a<r||a>=o)){s.push(e.times[i]);for(let r=0;r<t;++r)$.push(e.values[i*t+r])}}0!==s.length&&(e.times=za.convertArray(s,e.times.constructor),e.values=za.convertArray($,e.values.constructor),a.push(e))}i.tracks=a;let s=1/0;for(let l=0;l<i.tracks.length;++l)s>i.tracks[l].times[0]&&(s=i.tracks[l].times[0]);for(let l=0;l<i.tracks.length;++l)i.tracks[l].shift(-1*s);return i.resetDuration(),i},makeClipAdditive:function(e,t,r,o){void 0===t&&(t=0),void 0===r&&(r=e),(void 0===o||o<=0)&&(o=30);const n=e.tracks.length,i=t/o;for(let a=0;a<n;++a){const t=r.tracks[a],o=t.ValueTypeName;if("bool"===o||"string"===o)continue;const n=e.tracks.find(function(e){return e.name===t.name&&e.ValueTypeName===o});if(void 0===n)continue;const s=t.getValueSize(),l=t.times.length-1;let $;if(i<=t.times[0])$=za.arraySlice(t.values,0,t.valueSize);else if(i>=t.times[l]){const e=l*s;$=za.arraySlice(t.values,e)}else{const e=t.createInterpolant();e.evaluate(i),$=e.resultBuffer}if("quaternion"===o){new Ka($[0],$[1],$[2],$[3]).normalize().conjugate().toArray($)}const c=n.times.length;for(let e=0;e<c;++e){const t=e*s;if("quaternion"===o)Ka.multiplyQuaternionsFlat(n.values,t,$,0,n.values,t);else for(let e=0;e<s;++e)n.values[t+e]-=$[e]}}return e.blendMode=2501,e}};function rb(e,t,r,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==o?o:new t.constructor(r),this.sampleValues=t,this.valueSize=r}function hk(e,t,r,o){rb.call(this,e,t,r,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Fh(e,t,r,o){rb.call(this,e,t,r,o)}function _j(e,t,r,o){rb.call(this,e,t,r,o)}function Va(e,t,r,o){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=za.convertArray(t,this.TimeBufferType),this.values=za.convertArray(r,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}function Xj(e,t,r){Va.call(this,e,t,r)}function Vj(e,t,r,o){Va.call(this,e,t,r,o)}function Rf(e,t,r,o){Va.call(this,e,t,r,o)}function Rj(e,t,r,o){rb.call(this,e,t,r,o)}function Wg(e,t,r,o){Va.call(this,e,t,r,o)}function Aj(e,t,r,o){Va.call(this,e,t,r,o)}function wf(e,t,r,o){Va.call(this,e,t,r,o)}function Db(e,t,r,o){this.name=e,this.tracks=r,this.duration=void 0!==t?t:-1,this.blendMode=void 0!==o?o:Pk,this.uuid=ma.generateUUID(),this.duration<0&&this.resetDuration()}function Wv(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Rf;case"vector":case"vector2":case"vector3":case"vector4":return wf;case"color":return Vj;case"quaternion":return Wg;case"bool":case"boolean":return Xj;case"string":return Aj;}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function Xv(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=Wv(e.type);if(void 0===e.times){const t=[],r=[];za.flattenJSON(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(rb.prototype,{evaluate:function(e){let t=this.parameterPositions,r=this._cachedIndex,o=t[r],n=t[r-1];e:{t:{let i;r:{o:if(!(e<o)){for(let i=r+2;;){if(void 0===o){if(e<n)break o;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,n)}if(r===i)break;if(n=o,e<(o=t[++r]))break t}i=t.length;break r}if(e>=n)break e;{const a=t[1];e<a&&(r=2,n=a);for(let i=r-2;;){if(void 0===n)return this._cachedIndex=0,this.beforeStart_(0,e,o);if(r===i)break;if(o=n,e>=(n=t[--r-1]))break t}i=r,r=0}}for(;r<i;){const o=r+i>>>1;e<t[o]?i=o:r=o+1}if(o=t[r],void 0===(n=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,o);if(void 0===o)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,n,e)}this._cachedIndex=r,this.intervalChanged_(r,n,o)}return this.interpolate_(r,n,e,o)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){const t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,n=e*o;for(let i=0;i!==o;++i)t[i]=r[n+i];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(rb.prototype,{beforeStart_:rb.prototype.copySampleValue_,afterEnd_:rb.prototype.copySampleValue_}),hk.prototype=Object.assign(Object.create(rb.prototype),{constructor:hk,DefaultSettings_:{endingStart:Ed,endingEnd:Ed},intervalChanged_:function(e,t,r){let o=this.parameterPositions,n=e-2,i=e+1,a=o[n],s=o[i];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:n=e,a=2*t-r;break;case 2402:a=t+o[n=o.length-2]-o[n+1];break;default:n=e,a=r;}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:i=e,s=2*r-t;break;case 2402:i=1,s=r+o[1]-o[0];break;default:i=e-1,s=t;}const l=.5*(r-t),$=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-r),this._offsetPrev=n*$,this._offsetNext=i*$},interpolate_:function(e,t,r,o){const n=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,$=this._offsetPrev,c=this._offsetNext,p=this._weightPrev,u=this._weightNext,h=(r-t)/(o-t),d=h*h,f=d*h,m=-p*f+2*p*d-p*h,x=(1+p)*f+(-1.5-2*p)*d+(-.5+p)*h+1,g=(-1-u)*f+(1.5+u)*d+.5*h,v=u*f-u*d;for(let F=0;F!==a;++F)n[F]=m*i[$+F]+x*i[l+F]+g*i[s+F]+v*i[c+F];return n}}),Fh.prototype=Object.assign(Object.create(rb.prototype),{constructor:Fh,interpolate_:function(e,t,r,o){const n=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,$=(r-t)/(o-t),c=1-$;for(let p=0;p!==a;++p)n[p]=i[l+p]*c+i[s+p]*$;return n}}),_j.prototype=Object.assign(Object.create(rb.prototype),{constructor:_j,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Va,{toJSON:function(e){const t=e.constructor;let r;if(void 0!==t.toJSON)r=t.toJSON(e);else{r={name:e.name,times:za.convertArray(e.times,Array),values:za.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(r.interpolation=t)}return r.type=e.ValueTypeName,r}}),Object.assign(Va.prototype,{constructor:Va,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new _j(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Fh(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new hk(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth;}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e){const t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]+=e}return this},scale:function(e){if(1!==e){const t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]*=e}return this},trim:function(e,t){const r=this.times,o=r.length;let n=0,i=o-1;for(;n!==o&&r[n]<e;)++n;for(;-1!==i&&r[i]>t;)--i;if(++i,0!==n||i!==o){n>=i&&(n=(i=Math.max(i,1))-1);const e=this.getValueSize();this.times=za.arraySlice(r,n,i),this.values=za.arraySlice(this.values,n*e,i*e)}return this},validate:function(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,o=this.values,n=r.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let i=null;for(let a=0;a!==n;a++){const t=r[a];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==i&&i>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,t,i),e=!1;break}i=t}if(void 0!==o&&za.isTypedArray(o))for(let a=0,s=o.length;a!==s;++a){const t=o[a];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e},optimize:function(){const e=za.arraySlice(this.times),t=za.arraySlice(this.values),r=this.getValueSize(),o=2302===this.getInterpolation(),n=e.length-1;let i=1;for(let a=1;a<n;++a){let n=!1;const s=e[a];if(s!==e[a+1]&&(1!==a||s!==s[0]))if(o)n=!0;else{const e=a*r,o=e-r,i=e+r;for(let a=0;a!==r;++a){const r=t[e+a];if(r!==t[o+a]||r!==t[i+a]){n=!0;break}}}if(n){if(a!==i){e[i]=e[a];const o=a*r,n=i*r;for(let e=0;e!==r;++e)t[n+e]=t[o+e]}++i}}if(n>0){e[i]=e[n];for(let e=n*r,o=i*r,a=0;a!==r;++a)t[o+a]=t[e+a];++i}return i!==e.length?(this.times=za.arraySlice(e,0,i),this.values=za.arraySlice(t,0,i*r)):(this.times=e,this.values=t),this},clone:function(){const e=za.arraySlice(this.times,0),t=za.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}),Xj.prototype=Object.assign(Object.create(Va.prototype),{constructor:Xj,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Vj.prototype=Object.assign(Object.create(Va.prototype),{constructor:Vj,ValueTypeName:"color"}),Rf.prototype=Object.assign(Object.create(Va.prototype),{constructor:Rf,ValueTypeName:"number"}),Rj.prototype=Object.assign(Object.create(rb.prototype),{constructor:Rj,interpolate_:function(e,t,r,o){const n=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=(r-t)/(o-t);let l=e*a;for(let $=l+a;l!==$;l+=4)Ka.slerpFlat(n,0,i,l-a,i,l,s);return n}}),Wg.prototype=Object.assign(Object.create(Va.prototype),{constructor:Wg,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Rj(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Aj.prototype=Object.assign(Object.create(Va.prototype),{constructor:Aj,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),wf.prototype=Object.assign(Object.create(Va.prototype),{constructor:wf,ValueTypeName:"vector"}),Object.assign(Db,{parse:function(e){const t=[],r=e.tracks,o=1/(e.fps||1);for(let n=0,i=r.length;n!==i;++n)t.push(Xv(r[n]).scale(o));return new Db(e.name,e.duration,t,e.blendMode)},toJSON:function(e){const t=[],r=e.tracks,o={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,i=r.length;n!==i;++n)t.push(Va.toJSON(r[n]));return o},CreateFromMorphTargetSequence:function(e,t,r,o){const n=t.length,i=[];for(let a=0;a<n;a++){let e=[],s=[];e.push((a+n-1)%n,a,(a+1)%n),s.push(0,1,0);const l=za.getKeyframeOrder(e);e=za.sortedArray(e,1,l),s=za.sortedArray(s,1,l),o||0!==e[0]||(e.push(n),s.push(s[0])),i.push(new Rf(".morphTargetInfluences["+t[a].name+"]",e,s).scale(1/r))}return new Db(e,-1,i)},findByName:function(e,t){let r=e;if(!Array.isArray(e)){const t=e;r=t.geometry&&t.geometry.animations||t.animations}for(let o=0;o<r.length;o++)if(r[o].name===t)return r[o];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){const o={},n=/^([\w-]*?)([\d]+)$/;for(let a=0,s=e.length;a<s;a++){const t=e[a],r=t.name.match(n);if(r&&r.length>1){const e=r[1];let n=o[e];n||(o[e]=n=[]),n.push(t)}}const i=[];for(const a in o)i.push(Db.CreateFromMorphTargetSequence(a,o[a],t,r));return i},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(e,t,r,o,n){if(0!==r.length){const i=[],a=[];za.flattenJSON(r,i,a,o),0!==i.length&&n.push(new e(t,i,a))}},o=[],n=e.name||"default",i=e.fps||30,a=e.blendMode;let s=e.length||-1;const l=e.hierarchy||[];for(let $=0;$<l.length;$++){const e=l[$].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let r;for(r=0;r<e.length;r++)if(e[r].morphTargets)for(let o=0;o<e[r].morphTargets.length;o++)t[e[r].morphTargets[o]]=-1;for(const n in t){const t=[],i=[];for(let o=0;o!==e[r].morphTargets.length;++o){const o=e[r];t.push(o.time),i.push(o.morphTarget===n?1:0)}o.push(new Rf(".morphTargetInfluence["+n+"]",t,i))}s=t.length*(i||1)}else{const n=".bones["+t[$].name+"]";r(wf,n+".position",e,"pos",o),r(Wg,n+".quaternion",e,"rot",o),r(wf,n+".scale",e,"scl",o)}}return 0===o.length?null:new Db(n,s,o,a)}}),Object.assign(Db.prototype,{resetDuration:function(){let e=0;for(let t=0,r=this.tracks.length;t!==r;++t){const r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Db(this.name,this.duration,e,this.blendMode)}});const ke={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function nj(e,t,r){const o=this;let n=!1,i=0,a=0,s=void 0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===n&&void 0!==o.onStart&&o.onStart(e,i,a),n=!0},this.itemEnd=function(e){i++,void 0!==o.onProgress&&o.onProgress(e,i,a),i===a&&(n=!1,void 0!==o.onLoad&&o.onLoad())},this.itemError=function(e){void 0!==o.onError&&o.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){const r=l[t],o=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return o}return null}}const $v=new nj;function ta(e){this.manager=void 0!==e?e:$v,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(ta.prototype,{load:function(){},loadAsync:function(e,t){const r=this;return new Promise(function(o,n){r.load(e,o,t,n)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});const yb={};function Qb(e){ta.call(this,e)}function Ln(e){ta.call(this,e)}function Kn(e){ta.call(this,e)}function In(e){ta.call(this,e)}function Cf(e){ta.call(this,e)}function Ti(e){ta.call(this,e)}function Ae(e){ta.call(this,e)}function ia(){this.type="Curve",this.arcLengthDivisions=200}function tb(e,t,r,o,n,i,a,s){ia.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=r||1,this.yRadius=o||1,this.aStartAngle=n||0,this.aEndAngle=i||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Pf(e,t,r,o,n,i){tb.call(this,e,t,r,r,o,n,i),this.type="ArcCurve"}function yi(){let e=0,t=0,r=0,o=0;function n(n,i,a,s){e=n,t=a,r=-3*n+3*i-2*a-s,o=2*n-2*i+a+s}return{initCatmullRom:function(e,t,r,o,i){n(t,r,i*(r-e),i*(o-t))},initNonuniformCatmullRom:function(e,t,r,o,i,a,s){let l=(t-e)/i-(r-e)/(i+a)+(r-t)/a,$=(r-t)/a-(o-t)/(a+s)+(o-r)/s;n(t,r,l*=a,$*=a)},calc:function(n){const i=n*n;return e+t*n+r*i+o*(i*n)}}}Qb.prototype=Object.assign(Object.create(ta.prototype),{constructor:Qb,load:function(e,t,r,o){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const n=this,i=ke.get(e);if(void 0!==i)return n.manager.itemStart(e),setTimeout(function(){t&&t(i),n.manager.itemEnd(e)},0),i;if(void 0!==yb[e])return void yb[e].push({onLoad:t,onProgress:r,onError:o});const a=e.match(/^data:(.*?)(;base64)?,(.*)$/);let s;if(a){const r=a[1],i=!!a[2];let s=a[3];s=decodeURIComponent(s),i&&(s=atob(s));try{let i;const a=(this.responseType||"").toLowerCase();switch(a){case"arraybuffer":case"blob":const e=new Uint8Array(s.length);for(let r=0;r<s.length;r++)e[r]=s.charCodeAt(r);i="blob"===a?new Blob([e.buffer],{type:r}):e.buffer;break;case"document":const t=new DOMParser;i=t.parseFromString(s,r);break;case"json":i=JSON.parse(s);break;default:i=s;}setTimeout(function(){t&&t(i),n.manager.itemEnd(e)},0)}catch(l){setTimeout(function(){o&&o(l),n.manager.itemError(e),n.manager.itemEnd(e)},0)}}else{yb[e]=[],yb[e].push({onLoad:t,onProgress:r,onError:o}),(s=new XMLHttpRequest).open("GET",e,!0),s.addEventListener("load",function(t){const r=this.response,o=yb[e];if(delete yb[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ke.add(e,r);for(let e=0,t=o.length;e<t;e++){const t=o[e];t.onLoad&&t.onLoad(r)}n.manager.itemEnd(e)}else{for(let e=0,r=o.length;e<r;e++){const r=o[e];r.onError&&r.onError(t)}n.manager.itemError(e),n.manager.itemEnd(e)}},!1),s.addEventListener("progress",function(t){const r=yb[e];for(let e=0,o=r.length;e<o;e++){const o=r[e];o.onProgress&&o.onProgress(t)}},!1),s.addEventListener("error",function(t){const r=yb[e];delete yb[e];for(let e=0,o=r.length;e<o;e++){const o=r[e];o.onError&&o.onError(t)}n.manager.itemError(e),n.manager.itemEnd(e)},!1),s.addEventListener("abort",function(t){const r=yb[e];delete yb[e];for(let e=0,o=r.length;e<o;e++){const o=r[e];o.onError&&o.onError(t)}n.manager.itemError(e),n.manager.itemEnd(e)},!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const e in this.requestHeader)s.setRequestHeader(e,this.requestHeader[e]);s.send(null)}return n.manager.itemStart(e),s},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this}}),Ln.prototype=Object.assign(Object.create(ta.prototype),{constructor:Ln,load:function(e,t,r,o){const n=this,i=new Qb(n.manager);i.setPath(n.path),i.load(e,function(r){try{t(n.parse(JSON.parse(r)))}catch(i){o?o(i):console.error(i),n.manager.itemError(e)}},r,o)},parse:function(e){const t=[];for(let r=0;r<e.length;r++){const o=Db.parse(e[r]);t.push(o)}return t}}),Kn.prototype=Object.assign(Object.create(ta.prototype),{constructor:Kn,load:function(e,t,r,o){const n=this,i=[],a=new Of;a.image=i;const s=new Qb(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer");let l=0;function $($){s.load(e[$],function(e){const r=n.parse(e,!0);i[$]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(l+=1)&&(1===r.mipmapCount&&(a.minFilter=Na),a.format=r.format,a.needsUpdate=!0,t&&t(a))},r,o)}if(Array.isArray(e))for(let c=0,p=e.length;c<p;++c)$(c);else s.load(e,function(e){const r=n.parse(e,!0);if(r.isCubemap){const e=r.mipmaps.length/r.mipmapCount;for(let t=0;t<e;t++){i[t]={mipmaps:[]};for(let e=0;e<r.mipmapCount;e++)i[t].mipmaps.push(r.mipmaps[t*r.mipmapCount+e]),i[t].format=r.format,i[t].width=r.width,i[t].height=r.height}}else a.image.width=r.width,a.image.height=r.height,a.mipmaps=r.mipmaps;1===r.mipmapCount&&(a.minFilter=Na),a.format=r.format,a.needsUpdate=!0,t&&t(a)},r,o);return a}}),In.prototype=Object.assign(Object.create(ta.prototype),{constructor:In,load:function(e,t,r,o){const n=this,i=new De,a=new Qb(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,function(e){const r=n.parse(e);r&&(void 0!==r.image?i.image=r.image:void 0!==r.data&&(i.image.width=r.width,i.image.height=r.height,i.image.data=r.data),i.wrapS=void 0!==r.wrapS?r.wrapS:cb,i.wrapT=void 0!==r.wrapT?r.wrapT:cb,i.magFilter=void 0!==r.magFilter?r.magFilter:Na,i.minFilter=void 0!==r.minFilter?r.minFilter:Na,i.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(i.format=r.format),void 0!==r.type&&(i.type=r.type),void 0!==r.mipmaps&&(i.mipmaps=r.mipmaps,i.minFilter=gh),1===r.mipmapCount&&(i.minFilter=Na),i.needsUpdate=!0,t&&t(i,r))},r,o),i}}),Cf.prototype=Object.assign(Object.create(ta.prototype),{constructor:Cf,load:function(e,t,r,o){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const n=this,i=ke.get(e);if(void 0!==i)return n.manager.itemStart(e),setTimeout(function(){t&&t(i),n.manager.itemEnd(e)},0),i;const a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),ke.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),o&&o(t),n.manager.itemError(e),n.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(e),a.src=e,a}}),Ti.prototype=Object.assign(Object.create(ta.prototype),{constructor:Ti,load:function(e,t,r,o){const n=new Gc,i=new Cf(this.manager);i.setCrossOrigin(this.crossOrigin),i.setPath(this.path);let a=0;function s(r){i.load(e[r],function(e){n.images[r]=e,6===++a&&(n.needsUpdate=!0,t&&t(n))},void 0,o)}for(let l=0;l<e.length;++l)s(l);return n}}),Ae.prototype=Object.assign(Object.create(ta.prototype),{constructor:Ae,load:function(e,t,r,o){const n=new va,i=new Cf(this.manager);return i.setCrossOrigin(this.crossOrigin),i.setPath(this.path),i.load(e,function(r){n.image=r;const o=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);n.format=o?ad:Cb,n.needsUpdate=!0,void 0!==t&&t(n)},r,o),n}}),Object.assign(ia.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){void 0===e&&(e=5);const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){const e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,o=this.getPoint(0),n=0;t.push(0);for(let i=1;i<=e;i++)n+=(r=this.getPoint(i/e)).distanceTo(o),t.push(n),o=r;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){const r=this.getLengths();let o,n=0,i=r.length;o=t||e*r[i-1];let a,s=0,l=i-1;for(;s<=l;)if((a=r[n=Math.floor(s+(l-s)/2)]-o)<0)s=n+1;else{if(!(a>0)){l=n;break}l=n-1}if(r[n=l]===o)return n/(i-1);const $=r[n];return(n+(o-$)/(r[n+1]-$))/(i-1)},getTangent:function(e,t){let r=e-1e-4,o=e+1e-4;r<0&&(r=0),o>1&&(o=1);const n=this.getPoint(r),i=this.getPoint(o),a=t||(n.isVector2?new ca:new aa);return a.copy(i).sub(n).normalize(),a},getTangentAt:function(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)},computeFrenetFrames:function(e,t){const r=new aa,o=[],n=[],i=[],a=new aa,s=new na;for(let u=0;u<=e;u++){const t=u/e;o[u]=this.getTangentAt(t,new aa),o[u].normalize()}n[0]=new aa,i[0]=new aa;let l=Number.MAX_VALUE;const $=Math.abs(o[0].x),c=Math.abs(o[0].y),p=Math.abs(o[0].z);$<=l&&(l=$,r.set(1,0,0)),c<=l&&(l=c,r.set(0,1,0)),p<=l&&r.set(0,0,1),a.crossVectors(o[0],r).normalize(),n[0].crossVectors(o[0],a),i[0].crossVectors(o[0],n[0]);for(let u=1;u<=e;u++){if(n[u]=n[u-1].clone(),i[u]=i[u-1].clone(),a.crossVectors(o[u-1],o[u]),a.length()>Number.EPSILON){a.normalize();const e=Math.acos(ma.clamp(o[u-1].dot(o[u]),-1,1));n[u].applyMatrix4(s.makeRotationAxis(a,e))}i[u].crossVectors(o[u],n[u])}if(!0===t){let t=Math.acos(ma.clamp(n[0].dot(n[e]),-1,1));t/=e,o[0].dot(a.crossVectors(n[0],n[e]))>0&&(t=-t);for(let r=1;r<=e;r++)n[r].applyMatrix4(s.makeRotationAxis(o[r],t*r)),i[r].crossVectors(o[r],n[r])}return{tangents:o,normals:n,binormals:i}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),tb.prototype=Object.create(ia.prototype),tb.prototype.constructor=tb,tb.prototype.isEllipseCurve=!0,tb.prototype.getPoint=function(e,t){const r=t||new ca,o=2*Math.PI;let n=this.aEndAngle-this.aStartAngle;const i=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=o;for(;n>o;)n-=o;n<Number.EPSILON&&(n=i?0:o),!0!==this.aClockwise||i||(n===o?n=-o:n-=o);const a=this.aStartAngle+e*n;let s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=s-this.aX,o=l-this.aY;s=r*e-o*t+this.aX,l=r*t+o*e+this.aY}return r.set(s,l)},tb.prototype.copy=function(e){return ia.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},tb.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},tb.prototype.fromJSON=function(e){return ia.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Pf.prototype=Object.create(tb.prototype),Pf.prototype.constructor=Pf,Pf.prototype.isArcCurve=!0;const Eg=new aa,si=new yi,li=new yi,Ok=new yi;function Hb(e,t,r,o){ia.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=r||"centripetal",this.tension=o||.5}function zn(e,t,r,o,n){const i=.5*(o-t),a=.5*(n-r),s=e*e;return(2*r-2*o+i+a)*(e*s)+(-3*r+3*o-2*i-a)*s+i*e+r}function sw(e,t){const r=1-e;return r*r*t}function tw(e,t){return 2*(1-e)*e*t}function uw(e,t){return e*e*t}function Vf(e,t,r,o){return sw(e,t)+tw(e,r)+uw(e,o)}function ww(e,t){const r=1-e;return r*r*r*t}function xw(e,t){const r=1-e;return 3*r*r*e*t}function yw(e,t){return 3*(1-e)*e*e*t}function zw(e,t){return e*e*e*t}function Xf(e,t,r,o,n){return ww(e,t)+xw(e,r)+yw(e,o)+zw(e,n)}function Kb(e,t,r,o){ia.call(this),this.type="CubicBezierCurve",this.v0=e||new ca,this.v1=t||new ca,this.v2=r||new ca,this.v3=o||new ca}function mc(e,t,r,o){ia.call(this),this.type="CubicBezierCurve3",this.v0=e||new aa,this.v1=t||new aa,this.v2=r||new aa,this.v3=o||new aa}function gb(e,t){ia.call(this),this.type="LineCurve",this.v1=e||new ca,this.v2=t||new ca}function Vb(e,t){ia.call(this),this.type="LineCurve3",this.v1=e||new aa,this.v2=t||new aa}function Yb(e,t,r){ia.call(this),this.type="QuadraticBezierCurve",this.v0=e||new ca,this.v1=t||new ca,this.v2=r||new ca}function sc(e,t,r){ia.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new aa,this.v1=t||new aa,this.v2=r||new aa}function Ub(e){ia.call(this),this.type="SplineCurve",this.points=e||[]}Hb.prototype=Object.create(ia.prototype),Hb.prototype.constructor=Hb,Hb.prototype.isCatmullRomCurve3=!0,Hb.prototype.getPoint=function(e,t){const r=t||new aa,o=this.points,n=o.length,i=(n-(this.closed?0:1))*e;let a,s,l,$,c=Math.floor(i),p=i-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/n)+1)*n:0===p&&c===n-1&&(c=n-2,p=1),this.closed||c>0?a=o[(c-1)%n]:(Eg.subVectors(o[0],o[1]).add(o[0]),a=Eg),s=o[c%n],l=o[(c+1)%n],this.closed||c+2<n?$=o[(c+2)%n]:(Eg.subVectors(o[n-1],o[n-2]).add(o[n-1]),$=Eg),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(a.distanceToSquared(s),e),r=Math.pow(s.distanceToSquared(l),e),o=Math.pow(l.distanceToSquared($),e);r<1e-4&&(r=1),t<1e-4&&(t=r),o<1e-4&&(o=r),si.initNonuniformCatmullRom(a.x,s.x,l.x,$.x,t,r,o),li.initNonuniformCatmullRom(a.y,s.y,l.y,$.y,t,r,o),Ok.initNonuniformCatmullRom(a.z,s.z,l.z,$.z,t,r,o)}else"catmullrom"===this.curveType&&(si.initCatmullRom(a.x,s.x,l.x,$.x,this.tension),li.initCatmullRom(a.y,s.y,l.y,$.y,this.tension),Ok.initCatmullRom(a.z,s.z,l.z,$.z,this.tension));return r.set(si.calc(p),li.calc(p),Ok.calc(p)),r},Hb.prototype.copy=function(e){ia.prototype.copy.call(this,e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Hb.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);e.points=[];for(let t=0,r=this.points.length;t<r;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Hb.prototype.fromJSON=function(e){ia.prototype.fromJSON.call(this,e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(new aa().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Kb.prototype=Object.create(ia.prototype),Kb.prototype.constructor=Kb,Kb.prototype.isCubicBezierCurve=!0,Kb.prototype.getPoint=function(e,t){const r=t||new ca,o=this.v0,n=this.v1,i=this.v2,a=this.v3;return r.set(Xf(e,o.x,n.x,i.x,a.x),Xf(e,o.y,n.y,i.y,a.y)),r},Kb.prototype.copy=function(e){return ia.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Kb.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Kb.prototype.fromJSON=function(e){return ia.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},mc.prototype=Object.create(ia.prototype),mc.prototype.constructor=mc,mc.prototype.isCubicBezierCurve3=!0,mc.prototype.getPoint=function(e,t){const r=t||new aa,o=this.v0,n=this.v1,i=this.v2,a=this.v3;return r.set(Xf(e,o.x,n.x,i.x,a.x),Xf(e,o.y,n.y,i.y,a.y),Xf(e,o.z,n.z,i.z,a.z)),r},mc.prototype.copy=function(e){return ia.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},mc.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},mc.prototype.fromJSON=function(e){return ia.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},gb.prototype=Object.create(ia.prototype),gb.prototype.constructor=gb,gb.prototype.isLineCurve=!0,gb.prototype.getPoint=function(e,t){const r=t||new ca;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},gb.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},gb.prototype.getTangent=function(e,t){const r=t||new ca;return r.copy(this.v2).sub(this.v1).normalize(),r},gb.prototype.copy=function(e){return ia.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},gb.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},gb.prototype.fromJSON=function(e){return ia.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Vb.prototype=Object.create(ia.prototype),Vb.prototype.constructor=Vb,Vb.prototype.isLineCurve3=!0,Vb.prototype.getPoint=function(e,t){const r=t||new aa;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Vb.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Vb.prototype.copy=function(e){return ia.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Vb.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Vb.prototype.fromJSON=function(e){return ia.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Yb.prototype=Object.create(ia.prototype),Yb.prototype.constructor=Yb,Yb.prototype.isQuadraticBezierCurve=!0,Yb.prototype.getPoint=function(e,t){const r=t||new ca,o=this.v0,n=this.v1,i=this.v2;return r.set(Vf(e,o.x,n.x,i.x),Vf(e,o.y,n.y,i.y)),r},Yb.prototype.copy=function(e){return ia.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Yb.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Yb.prototype.fromJSON=function(e){return ia.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},sc.prototype=Object.create(ia.prototype),sc.prototype.constructor=sc,sc.prototype.isQuadraticBezierCurve3=!0,sc.prototype.getPoint=function(e,t){const r=t||new aa,o=this.v0,n=this.v1,i=this.v2;return r.set(Vf(e,o.x,n.x,i.x),Vf(e,o.y,n.y,i.y),Vf(e,o.z,n.z,i.z)),r},sc.prototype.copy=function(e){return ia.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},sc.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},sc.prototype.fromJSON=function(e){return ia.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ub.prototype=Object.create(ia.prototype),Ub.prototype.constructor=Ub,Ub.prototype.isSplineCurve=!0,Ub.prototype.getPoint=function(e,t){const r=t||new ca,o=this.points,n=(o.length-1)*e,i=Math.floor(n),a=n-i,s=o[0===i?i:i-1],l=o[i],$=o[i>o.length-2?o.length-1:i+1],c=o[i>o.length-3?o.length-1:i+2];return r.set(zn(a,s.x,l.x,$.x,c.x),zn(a,s.y,l.y,$.y,c.y)),r},Ub.prototype.copy=function(e){ia.prototype.copy.call(this,e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(r.clone())}return this},Ub.prototype.toJSON=function(){const e=ia.prototype.toJSON.call(this);e.points=[];for(let t=0,r=this.points.length;t<r;t++){const r=this.points[t];e.points.push(r.toArray())}return e},Ub.prototype.fromJSON=function(e){ia.prototype.fromJSON.call(this,e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(new ca().fromArray(r))}return this};var rk=Object.freeze({__proto__:null,ArcCurve:Pf,CatmullRomCurve3:Hb,CubicBezierCurve:Kb,CubicBezierCurve3:mc,EllipseCurve:tb,LineCurve:gb,LineCurve3:Vb,QuadraticBezierCurve:Yb,QuadraticBezierCurve3:sc,SplineCurve:Ub});function vc(){ia.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Mb(e){vc.call(this),this.type="Path",this.currentPoint=new ca,e&&this.setFromPoints(e)}function qd(e){Mb.call(this,e),this.uuid=ma.generateUUID(),this.type="Shape",this.holes=[]}function xa(e,t){da.call(this),this.type="Light",this.color=new ha(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Uj(e,t,r){xa.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(da.DefaultUp),this.updateMatrix(),this.groundColor=new ha(t)}function ec(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new ca(512,512),this.map=null,this.mapPass=null,this.matrix=new na,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Hf,this._frameExtents=new ca(1,1),this._viewportCount=1,this._viewports=[new sa(0,0,1,1)]}function Lj(){ec.call(this,new Ga(50,1,.5,500))}function rj(e,t,r,o,n,i){xa.call(this,e,t),this.type="SpotLight",this.position.copy(da.DefaultUp),this.updateMatrix(),this.target=new da,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==o?o:Math.PI/3,this.penumbra=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new Lj}function oj(){ec.call(this,new Ga(90,1,.5,500)),this._frameExtents=new ca(4,2),this._viewportCount=6,this._viewports=[new sa(2,1,1,1),new sa(0,1,1,1),new sa(3,1,1,1),new sa(1,1,1,1),new sa(3,0,1,1),new sa(1,0,1,1)],this._cubeDirections=[new aa(1,0,0),new aa(-1,0,0),new aa(0,0,1),new aa(0,0,-1),new aa(0,1,0),new aa(0,-1,0)],this._cubeUps=[new aa(0,1,0),new aa(0,1,0),new aa(0,1,0),new aa(0,1,0),new aa(0,0,1),new aa(0,0,-1)]}function lj(e,t,r,o){xa.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new oj}function fg(e,t,r,o,n,i){ac.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==r?r:1,this.bottom=void 0!==o?o:-1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()}function Yi(){ec.call(this,new fg(-5,5,5,-5,.5,500))}function Pi(e,t){xa.call(this,e,t),this.type="DirectionalLight",this.position.copy(da.DefaultUp),this.updateMatrix(),this.target=new da,this.shadow=new Yi}function Mi(e,t){xa.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Ji(e,t,r,o){xa.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==o?o:10}function Ii(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new aa)}function Jb(e,t){xa.call(this,void 0,t),this.type="LightProbe",this.sh=void 0!==e?e:new Ii}function ni(e){ta.call(this,e),this.textures={}}vc.prototype=Object.assign(Object.create(ia.prototype),{constructor:vc,add:function(e){this.curves.push(e)},closePath:function(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new gb(t,e))},getPoint:function(e){const t=e*this.getLength(),r=this.getCurveLengths();let o=0;for(;o<r.length;){if(r[o]>=t){const e=r[o]-t,n=this.curves[o],i=n.getLength(),a=0===i?0:1-e/i;return n.getPointAt(a)}o++}return null},getLength:function(){const e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,o=this.curves.length;r<o;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;const t=[];let r;for(let o=0,n=this.curves;o<n.length;o++){const i=n[o],a=i&&i.isEllipseCurve?2*e:i&&(i.isLineCurve||i.isLineCurve3)?1:i&&i.isSplineCurve?e*i.points.length:e,s=i.getPoints(a);for(let e=0;e<s.length;e++){const o=s[e];r&&r.equals(o)||(t.push(o),r=o)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(e){ia.prototype.copy.call(this,e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){const e=ia.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){ia.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const r=e.curves[t];this.curves.push(new rk[r.type]().fromJSON(r))}return this}}),Mb.prototype=Object.assign(Object.create(vc.prototype),{constructor:Mb,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){const r=new gb(this.currentPoint.clone(),new ca(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,r,o){const n=new Yb(this.currentPoint.clone(),new ca(e,t),new ca(r,o));return this.curves.push(n),this.currentPoint.set(r,o),this},bezierCurveTo:function(e,t,r,o,n,i){const a=new Kb(this.currentPoint.clone(),new ca(e,t),new ca(r,o),new ca(n,i));return this.curves.push(a),this.currentPoint.set(n,i),this},splineThru:function(e){const t=new Ub([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,r,o,n,i){const a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+a,t+s,r,o,n,i),this},absarc:function(e,t,r,o,n,i){return this.absellipse(e,t,r,r,o,n,i),this},ellipse:function(e,t,r,o,n,i,a,s){const l=this.currentPoint.x,$=this.currentPoint.y;return this.absellipse(e+l,t+$,r,o,n,i,a,s),this},absellipse:function(e,t,r,o,n,i,a,s){const l=new tb(e,t,r,o,n,i,a,s);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const $=l.getPoint(1);return this.currentPoint.copy($),this},copy:function(e){return vc.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){const e=vc.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return vc.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),qd.prototype=Object.assign(Object.create(Mb.prototype),{constructor:qd,getPointsHoles:function(e){const t=[];for(let r=0,o=this.holes.length;r<o;r++)t[r]=this.holes[r].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Mb.prototype.copy.call(this,e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){const e=Mb.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){Mb.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const r=e.holes[t];this.holes.push(new Mb().fromJSON(r))}return this}}),xa.prototype=Object.assign(Object.create(da.prototype),{constructor:xa,isLight:!0,copy:function(e){return da.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){const t=da.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Uj.prototype=Object.assign(Object.create(xa.prototype),{constructor:Uj,isHemisphereLight:!0,copy:function(e){return xa.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(ec.prototype,{_projScreenMatrix:new na,_lightPositionWorld:new aa,_lookTarget:new aa,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){const t=this.camera,r=this.matrix,o=this._projScreenMatrix,n=this._lookTarget,i=this._lightPositionWorld;i.setFromMatrixPosition(e.matrixWorld),t.position.copy(i),n.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(n),t.updateMatrixWorld(),o.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Lj.prototype=Object.assign(Object.create(ec.prototype),{constructor:Lj,isSpotLightShadow:!0,updateMatrices:function(e){const t=this.camera,r=2*ma.RAD2DEG*e.angle,o=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;r===t.fov&&o===t.aspect&&n===t.far||(t.fov=r,t.aspect=o,t.far=n,t.updateProjectionMatrix()),ec.prototype.updateMatrices.call(this,e)}}),rj.prototype=Object.assign(Object.create(xa.prototype),{constructor:rj,isSpotLight:!0,copy:function(e){return xa.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),oj.prototype=Object.assign(Object.create(ec.prototype),{constructor:oj,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);const r=this.camera,o=this.matrix,n=this._lightPositionWorld,i=this._lookTarget,a=this._projScreenMatrix;n.setFromMatrixPosition(e.matrixWorld),r.position.copy(n),i.copy(r.position),i.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(i),r.updateMatrixWorld(),o.makeTranslation(-n.x,-n.y,-n.z),a.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),lj.prototype=Object.assign(Object.create(xa.prototype),{constructor:lj,isPointLight:!0,copy:function(e){return xa.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),fg.prototype=Object.assign(Object.create(ac.prototype),{constructor:fg,isOrthographicCamera:!0,copy:function(e,t){return ac.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,r,o,n,i){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=n,this.view.height=i,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let n=r-e,i=r+e,a=o+t,s=o-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i=(n+=e*this.view.offsetX)+e*this.view.width,s=(a-=t*this.view.offsetY)-t*this.view.height}this.projectionMatrix.makeOrthographic(n,i,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){const t=da.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Yi.prototype=Object.assign(Object.create(ec.prototype),{constructor:Yi,isDirectionalLightShadow:!0,updateMatrices:function(e){ec.prototype.updateMatrices.call(this,e)}}),Pi.prototype=Object.assign(Object.create(xa.prototype),{constructor:Pi,isDirectionalLight:!0,copy:function(e){return xa.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Mi.prototype=Object.assign(Object.create(xa.prototype),{constructor:Mi,isAmbientLight:!0}),Ji.prototype=Object.assign(Object.create(xa.prototype),{constructor:Ji,isRectAreaLight:!0,copy:function(e){return xa.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){const t=xa.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(Ii.prototype,{isSphericalHarmonics3:!0,set:function(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){const r=e.x,o=e.y,n=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.282095),t.addScaledVector(i[1],.488603*o),t.addScaledVector(i[2],.488603*n),t.addScaledVector(i[3],.488603*r),t.addScaledVector(i[4],r*o*1.092548),t.addScaledVector(i[5],o*n*1.092548),t.addScaledVector(i[6],.315392*(3*n*n-1)),t.addScaledVector(i[7],r*n*1.092548),t.addScaledVector(i[8],.546274*(r*r-o*o)),t},getIrradianceAt:function(e,t){const r=e.x,o=e.y,n=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.886227),t.addScaledVector(i[1],1.023328*o),t.addScaledVector(i[2],1.023328*n),t.addScaledVector(i[3],1.023328*r),t.addScaledVector(i[4],.858086*r*o),t.addScaledVector(i[5],.858086*o*n),t.addScaledVector(i[6],.743125*n*n-.247708),t.addScaledVector(i[7],.858086*r*n),t.addScaledVector(i[8],.429043*(r*r-o*o)),t},add:function(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},addScaledSH:function(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this},scale:function(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this},equals:function(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,t){void 0===t&&(t=0);const r=this.coefficients;for(let o=0;o<9;o++)r[o].fromArray(e,t+3*o);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const r=this.coefficients;for(let o=0;o<9;o++)r[o].toArray(e,t+3*o);return e}}),Object.assign(Ii,{getBasisAt:function(e,t){const r=e.x,o=e.y,n=e.z;t[0]=.282095,t[1]=.488603*o,t[2]=.488603*n,t[3]=.488603*r,t[4]=1.092548*r*o,t[5]=1.092548*o*n,t[6]=.315392*(3*n*n-1),t[7]=1.092548*r*n,t[8]=.546274*(r*r-o*o)}}),Jb.prototype=Object.assign(Object.create(xa.prototype),{constructor:Jb,isLightProbe:!0,copy:function(e){return xa.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){const t=xa.prototype.toJSON.call(this,e);return t.object.sh=this.sh.toArray(),t}}),ni.prototype=Object.assign(Object.create(ta.prototype),{constructor:ni,load:function(e,t,r,o){const n=this,i=new Qb(n.manager);i.setPath(n.path),i.load(e,function(r){try{t(n.parse(JSON.parse(r)))}catch(i){o?o(i):console.error(i),n.manager.itemError(e)}},r,o)},parse:function(e){const t=this.textures;function r(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const o=new Hv[e.type];if(void 0!==e.uuid&&(o.uuid=e.uuid),void 0!==e.name&&(o.name=e.name),void 0!==e.color&&o.color.setHex(e.color),void 0!==e.roughness&&(o.roughness=e.roughness),void 0!==e.metalness&&(o.metalness=e.metalness),void 0!==e.sheen&&(o.sheen=new ha().setHex(e.sheen)),void 0!==e.emissive&&o.emissive.setHex(e.emissive),void 0!==e.specular&&o.specular.setHex(e.specular),void 0!==e.shininess&&(o.shininess=e.shininess),void 0!==e.clearcoat&&(o.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(o.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(o.fog=e.fog),void 0!==e.flatShading&&(o.flatShading=e.flatShading),void 0!==e.blending&&(o.blending=e.blending),void 0!==e.combine&&(o.combine=e.combine),void 0!==e.side&&(o.side=e.side),void 0!==e.opacity&&(o.opacity=e.opacity),void 0!==e.transparent&&(o.transparent=e.transparent),void 0!==e.alphaTest&&(o.alphaTest=e.alphaTest),void 0!==e.depthTest&&(o.depthTest=e.depthTest),void 0!==e.depthWrite&&(o.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(o.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(o.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(o.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(o.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(o.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(o.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(o.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(o.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(o.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(o.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(o.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(o.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(o.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(o.rotation=e.rotation),1!==e.linewidth&&(o.linewidth=e.linewidth),void 0!==e.dashSize&&(o.dashSize=e.dashSize),void 0!==e.gapSize&&(o.gapSize=e.gapSize),void 0!==e.scale&&(o.scale=e.scale),void 0!==e.polygonOffset&&(o.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(o.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(o.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(o.skinning=e.skinning),void 0!==e.morphTargets&&(o.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(o.morphNormals=e.morphNormals),void 0!==e.dithering&&(o.dithering=e.dithering),void 0!==e.vertexTangents&&(o.vertexTangents=e.vertexTangents),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.toneMapped&&(o.toneMapped=e.toneMapped),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?o.vertexColors=e.vertexColors>0:o.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const n in e.uniforms){const t=e.uniforms[n];switch(o.uniforms[n]={},t.type){case"t":o.uniforms[n].value=r(t.value);break;case"c":o.uniforms[n].value=new ha().setHex(t.value);break;case"v2":o.uniforms[n].value=new ca().fromArray(t.value);break;case"v3":o.uniforms[n].value=new aa().fromArray(t.value);break;case"v4":o.uniforms[n].value=new sa().fromArray(t.value);break;case"m3":o.uniforms[n].value=new Xa().fromArray(t.value);case"m4":o.uniforms[n].value=new na().fromArray(t.value);break;default:o.uniforms[n].value=t.value;}}if(void 0!==e.defines&&(o.defines=e.defines),void 0!==e.vertexShader&&(o.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(o.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const n in e.extensions)o.extensions[n]=e.extensions[n];if(void 0!==e.shading&&(o.flatShading=1===e.shading),void 0!==e.size&&(o.size=e.size),void 0!==e.sizeAttenuation&&(o.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(o.map=r(e.map)),void 0!==e.matcap&&(o.matcap=r(e.matcap)),void 0!==e.alphaMap&&(o.alphaMap=r(e.alphaMap)),void 0!==e.bumpMap&&(o.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(o.bumpScale=e.bumpScale),void 0!==e.normalMap&&(o.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(o.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),o.normalScale=new ca().fromArray(t)}return void 0!==e.displacementMap&&(o.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(o.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(o.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(o.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(o.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(o.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(o.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(o.specularMap=r(e.specularMap)),void 0!==e.envMap&&(o.envMap=r(e.envMap)),void 0!==e.envMapIntensity&&(o.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(o.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(o.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(o.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(o.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(o.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(o.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(o.gradientMap=r(e.gradientMap)),void 0!==e.clearcoatMap&&(o.clearcoatMap=r(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(o.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(o.clearcoatNormalMap=r(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(o.clearcoatNormalScale=new ca().fromArray(e.clearcoatNormalScale)),o},setTextures:function(e){return this.textures=e,this}});const bn={decodeText:function(e){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let o=0,n=e.length;o<n;o++)t+=String.fromCharCode(e[o]);try{return decodeURIComponent(escape(t))}catch(r){return t}},extractUrlBase:function(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function Cg(){ga.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Fk(e,t,r,o){"number"==typeof r&&(o=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),ka.call(this,e,t,r),this.meshPerAttribute=o||1}function xk(e){ta.call(this,e)}Cg.prototype=Object.assign(Object.create(ga.prototype),{constructor:Cg,isInstancedBufferGeometry:!0,copy:function(e){return ga.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const e=ga.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Fk.prototype=Object.assign(Object.create(ka.prototype),{constructor:Fk,isInstancedBufferAttribute:!0,copy:function(e){return ka.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){const e=ka.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),xk.prototype=Object.assign(Object.create(ta.prototype),{constructor:xk,load:function(e,t,r,o){const n=this,i=new Qb(n.manager);i.setPath(n.path),i.load(e,function(r){try{t(n.parse(JSON.parse(r)))}catch(i){o?o(i):console.error(i),n.manager.itemError(e)}},r,o)},parse:function(e){const t={},r={};function o(e,o){if(void 0!==t[o])return t[o];const n=e.interleavedBuffers[o],i=function(e,t){if(void 0!==r[t])return r[t];const o=e.arrayBuffers[t],n=new Uint32Array(o).buffer;return r[t]=n,n}(e,n.buffer),a=new nb(new Gg[n.type](i),n.stride);return a.uuid=n.uuid,t[o]=a,a}const n=e.isInstancedBufferGeometry?new Cg:new ga,i=e.data.index;if(void 0!==i){const e=new Gg[i.type](i.array);n.setIndex(new ka(e,1))}const a=e.data.attributes;for(const c in a){const t=a[c];let r;if(t.isInterleavedBufferAttribute){r=new id(o(e.data,t.data),t.itemSize,t.offset,t.normalized)}else{const e=new Gg[t.type](t.array);r=new(t.isInstancedBufferAttribute?Fk:ka)(e,t.itemSize,t.normalized)}void 0!==t.name&&(r.name=t.name),n.setAttribute(c,r)}const s=e.data.morphAttributes;if(s)for(const c in s){const t=s[c],r=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];let a;if(i.isInterleavedBufferAttribute){a=new id(o(e.data,i.data),i.itemSize,i.offset,i.normalized)}else{a=new ka(new Gg[i.type](i.array),i.itemSize,i.normalized)}void 0!==i.name&&(a.name=i.name),r.push(a)}n.morphAttributes[c]=r}e.data.morphTargetsRelative&&(n.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let c=0,p=l.length;c!==p;++c){const e=l[c];n.addGroup(e.start,e.count,e.materialIndex)}const $=e.data.boundingSphere;if(void 0!==$){const e=new aa;void 0!==$.center&&e.fromArray($.center),n.boundingSphere=new _b(e,$.radius)}return e.name&&(n.name=e.name),e.userData&&(n.userData=e.userData),n}});const Gg={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function jk(e){ta.call(this,e)}jk.prototype=Object.assign(Object.create(ta.prototype),{constructor:jk,load:function(e,t,r,o){const n=this,i=""===this.path?bn.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const a=new Qb(n.manager);a.setPath(this.path),a.load(e,function(r){let i=null;try{i=JSON.parse(r)}catch(s){return void 0!==o&&o(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}const a=i.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?n.parse(i,t):console.error("THREE.ObjectLoader: Can't load "+e)},r,o)},parse:function(e,t){const r=this.parseShape(e.shapes),o=this.parseGeometries(e.geometries,r),n=this.parseImages(e.images,function(){void 0!==t&&t(s)}),i=this.parseTextures(e.textures,n),a=this.parseMaterials(e.materials,i),s=this.parseObject(e.object,o,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){const t={};if(void 0!==e)for(let r=0,o=e.length;r<o;r++){const o=new qd().fromJSON(e[r]);t[o.uuid]=o}return t},parseGeometries:function(e,t){const r={};let o;if(void 0!==e){const n=new xk;for(let i=0,a=e.length;i<a;i++){let a;const s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Za[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Za[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Za[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Za[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Za[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Za[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new Za[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Za[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Za[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Za[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new Za[s.type](new rk[s.path.type]().fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Za[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new Za[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":o=[];for(let r=0,n=s.shapes.length;r<n;r++){const e=t[s.shapes[r]];o.push(e)}a=new Za[s.type](o,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":o=[];for(let r=0,n=s.shapes.length;r<n;r++){const e=t[s.shapes[r]];o.push(e)}const e=s.options.extrudePath;void 0!==e&&(s.options.extrudePath=new rk[e.type]().fromJSON(e)),a=new Za[s.type](o,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=n.parse(s);break;case"Geometry":console.error("THREE.ObjectLoader: Loading \"Geometry\" is not supported anymore.");break;default:console.warn("THREE.ObjectLoader: Unsupported geometry type \""+s.type+"\"");continue;}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),r[s.uuid]=a}}return r},parseMaterials:function(e,t){const r={},o={};if(void 0!==e){const n=new ni;n.setTextures(t);for(let t=0,i=e.length;t<i;t++){const i=e[t];if("MultiMaterial"===i.type){const e=[];for(let t=0;t<i.materials.length;t++){const o=i.materials[t];void 0===r[o.uuid]&&(r[o.uuid]=n.parse(o)),e.push(r[o.uuid])}o[i.uuid]=e}else void 0===r[i.uuid]&&(r[i.uuid]=n.parse(i)),o[i.uuid]=r[i.uuid]}}return o},parseAnimations:function(e){const t=[];for(let r=0;r<e.length;r++){const o=e[r],n=Db.parse(o);void 0!==o.uuid&&(n.uuid=o.uuid),t.push(n)}return t},parseImages:function(e,t){const r=this,o={};let n;function i(e){return r.manager.itemStart(e),n.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemError(e),r.manager.itemEnd(e)})}if(void 0!==e&&e.length>0){const a=new nj(t);(n=new Cf(a)).setCrossOrigin(this.crossOrigin);for(let t=0,n=e.length;t<n;t++){const n=e[t],a=n.url;if(Array.isArray(a)){o[n.uuid]=[];for(let e=0,t=a.length;e<t;e++){const t=a[e],s=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t;o[n.uuid].push(i(s))}}else{const e=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n.url)?n.url:r.resourcePath+n.url;o[n.uuid]=i(e)}}}return o},parseTextures:function(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const o={};if(void 0!==e)for(let n=0,i=e.length;n<i;n++){const i=e[n];let a;void 0===i.image&&console.warn("THREE.ObjectLoader: No \"image\" specified for",i.uuid),void 0===t[i.image]&&console.warn("THREE.ObjectLoader: Undefined image",i.image),(a=Array.isArray(t[i.image])?new Gc(t[i.image]):new va(t[i.image])).needsUpdate=!0,a.uuid=i.uuid,void 0!==i.name&&(a.name=i.name),void 0!==i.mapping&&(a.mapping=r(i.mapping,fx)),void 0!==i.offset&&a.offset.fromArray(i.offset),void 0!==i.repeat&&a.repeat.fromArray(i.repeat),void 0!==i.center&&a.center.fromArray(i.center),void 0!==i.rotation&&(a.rotation=i.rotation),void 0!==i.wrap&&(a.wrapS=r(i.wrap[0],Vm),a.wrapT=r(i.wrap[1],Vm)),void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.encoding&&(a.encoding=i.encoding),void 0!==i.minFilter&&(a.minFilter=r(i.minFilter,Um)),void 0!==i.magFilter&&(a.magFilter=r(i.magFilter,Um)),void 0!==i.anisotropy&&(a.anisotropy=i.anisotropy),void 0!==i.flipY&&(a.flipY=i.flipY),void 0!==i.premultiplyAlpha&&(a.premultiplyAlpha=i.premultiplyAlpha),void 0!==i.unpackAlignment&&(a.unpackAlignment=i.unpackAlignment),o[i.uuid]=a}return o},parseObject:function(e,t,r){let o,n,i;function a(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function s(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let o=0,n=e.length;o<n;o++){const n=e[o];void 0===r[n]&&console.warn("THREE.ObjectLoader: Undefined material",n),t.push(r[n])}return t}return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),r[e]}}switch(e.type){case"Scene":o=new Ye,void 0!==e.background&&Number.isInteger(e.background)&&(o.background=new ha(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new Cj(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new Dj(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new Ga(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new fg(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Mi(e.color,e.intensity);break;case"DirectionalLight":o=new Pi(e.color,e.intensity);break;case"PointLight":o=new lj(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Ji(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new rj(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Uj(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new Jb().fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":o=new ua(n=a(e.geometry),i=s(e.material));break;case"InstancedMesh":n=a(e.geometry),i=s(e.material);const t=e.count,r=e.instanceMatrix;(o=new Ni(n,i,t)).instanceMatrix=new ka(new Float32Array(r.array),16);break;case"LOD":o=new Rg;break;case"Line":o=new xb(a(e.geometry),s(e.material),e.mode);break;case"LineLoop":o=new xi(a(e.geometry),s(e.material));break;case"LineSegments":o=new Ea(a(e.geometry),s(e.material));break;case"PointCloud":case"Points":o=new ki(a(e.geometry),s(e.material));break;case"Sprite":o=new Zi(s(e.material));break;case"Group":o=new qf;break;default:o=new da;}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const n=e.children;for(let e=0;e<n.length;e++)o.add(this.parseObject(n[e],t,r))}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const r=t[e],n=o.getObjectByProperty("uuid",r.object);void 0!==n&&o.addLevel(n,r.distance)}}return o}});const fx={UVMapping:300,CubeReflectionMapping:wj,CubeRefractionMapping:xj,EquirectangularReflectionMapping:rm,EquirectangularRefractionMapping:zj,CubeUVReflectionMapping:kg,CubeUVRefractionMapping:Bj},Vm={RepeatWrapping:ah,ClampToEdgeWrapping:cb,MirroredRepeatWrapping:ch},Um={NearestFilter:Pa,NearestMipmapNearestFilter:Gj,NearestMipmapLinearFilter:Hj,LinearFilter:Na,LinearMipmapNearestFilter:qm,LinearMipmapLinearFilter:gh};function Tm(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),ta.call(this,e),this.options={premultiplyAlpha:"none"}}function Sm(){this.type="ShapePath",this.color=new ha,this.subPaths=[],this.currentPath=null}function Om(e){this.type="Font",this.data=e}function lx(e,t,r){const o=Array.from?Array.from(e):String(e).split(""),n=t/r.resolution,i=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*n,a=[];let s=0,l=0;for(let $=0;$<o.length;$++){const e=o[$];if("\n"===e)s=0,l-=i;else{const t=mx(e,n,s,l,r);s+=t.offsetX,a.push(t.path)}}return a}function mx(e,t,r,o,n){const i=n.glyphs[e]||n.glyphs["?"];if(!i)return void console.error("THREE.Font: character \""+e+"\" does not exists in font family "+n.familyName+".");const a=new Sm;let s,l,$,c,p,u,h,d;if(i.o){const e=i._cachedOutline||(i._cachedOutline=i.o.split(" "));for(let n=0,i=e.length;n<i;){switch(e[n++]){case"m":s=e[n++]*t+r,l=e[n++]*t+o,a.moveTo(s,l);break;case"l":s=e[n++]*t+r,l=e[n++]*t+o,a.lineTo(s,l);break;case"q":$=e[n++]*t+r,c=e[n++]*t+o,p=e[n++]*t+r,u=e[n++]*t+o,a.quadraticCurveTo(p,u,$,c);break;case"b":$=e[n++]*t+r,c=e[n++]*t+o,p=e[n++]*t+r,u=e[n++]*t+o,h=e[n++]*t+r,d=e[n++]*t+o,a.bezierCurveTo(p,u,h,d,$,c);}}}return{offsetX:i.ha*t,path:a}}function Nm(e){ta.call(this,e)}let Lm;Tm.prototype=Object.assign(Object.create(ta.prototype),{constructor:Tm,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,r,o){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const n=this,i=ke.get(e);if(void 0!==i)return n.manager.itemStart(e),setTimeout(function(){t&&t(i),n.manager.itemEnd(e)},0),i;fetch(e).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,n.options)}).then(function(r){ke.add(e,r),t&&t(r),n.manager.itemEnd(e)}).catch(function(t){o&&o(t),n.manager.itemError(e),n.manager.itemEnd(e)}),n.manager.itemStart(e)}}),Object.assign(Sm.prototype,{moveTo:function(e,t){return this.currentPath=new Mb,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,r,o){return this.currentPath.quadraticCurveTo(e,t,r,o),this},bezierCurveTo:function(e,t,r,o,n,i){return this.currentPath.bezierCurveTo(e,t,r,o,n,i),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function r(e){const t=[];for(let r=0,o=e.length;r<o;r++){const o=e[r],n=new qd;n.curves=o.curves,t.push(n)}return t}function o(e,t){const r=t.length;let o=!1;for(let n=r-1,i=0;i<r;n=i++){let r=t[n],a=t[i],s=a.x-r.x,l=a.y-r.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(r=t[i],s=-s,a=t[n],l=-l),e.y<r.y||e.y>a.y)continue;if(e.y===r.y){if(e.x===r.x)return!0}else{const t=l*(e.x-r.x)-s*(e.y-r.y);if(0===t)return!0;if(t<0)continue;o=!o}}else{if(e.y!==r.y)continue;if(a.x<=e.x&&e.x<=r.x||r.x<=e.x&&e.x<=a.x)return!0}}return o}const n=Lc.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===t)return r(i);let a,s,l,$=[];if(1===i.length)return s=i[0],(l=new qd).curves=s.curves,$.push(l),$;let c=!n(i[0].getPoints());c=e?!c:c;const p=[],u=[];let h,d,f=[],m=0;u[m]=void 0,f[m]=[];for(let x=0,g=i.length;x<g;x++)a=n(h=(s=i[x]).getPoints()),(a=e?!a:a)?(!c&&u[m]&&m++,u[m]={s:new qd,p:h},u[m].s.curves=s.curves,c&&m++,f[m]=[]):f[m].push({h:s,p:h[0]});if(!u[0])return r(i);if(u.length>1){let e=!1;const t=[];for(let r=0,o=u.length;r<o;r++)p[r]=[];for(let r=0,n=u.length;r<n;r++){const n=f[r];for(let i=0;i<n.length;i++){const a=n[i];let s=!0;for(let n=0;n<u.length;n++)o(a.p,u[n].p)&&(r!==n&&t.push({froms:r,tos:n,hole:i}),s?(s=!1,p[n].push(a)):e=!0);s&&p[r].push(a)}}t.length>0&&(e||(f=p))}for(let x=0,g=u.length;x<g;x++){l=u[x].s,$.push(l);for(let e=0,t=(d=f[x]).length;e<t;e++)l.holes.push(d[e].h)}return $}}),Object.assign(Om.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);const r=[],o=lx(e,t,this.data);for(let n=0,i=o.length;n<i;n++)Array.prototype.push.apply(r,o[n].toShapes());return r}}),Nm.prototype=Object.assign(Object.create(ta.prototype),{constructor:Nm,load:function(e,t,r,o){const n=this,i=new Qb(this.manager);i.setPath(this.path),i.load(e,function(e){let r;try{r=JSON.parse(e)}catch(i){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}const o=n.parse(r);t&&t(o)},r,o)},parse:function(e){return new Om(e)}});const Km={getContext:function(){return void 0===Lm&&(Lm=new(window.AudioContext||window.webkitAudioContext)),Lm},setContext:function(e){Lm=e}};function ik(e){ta.call(this,e)}function Im(e,t,r){Jb.call(this,void 0,r);const o=new ha().set(e),n=new ha().set(t),i=new aa(o.r,o.g,o.b),a=new aa(n.r,n.g,n.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(i).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(i).sub(a).multiplyScalar(l)}function Hm(e,t){Jb.call(this,void 0,t);const r=new ha().set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}ik.prototype=Object.assign(Object.create(ta.prototype),{constructor:ik,load:function(e,t,r,o){const n=this,i=new Qb(n.manager);i.setResponseType("arraybuffer"),i.setPath(n.path),i.load(e,function(r){try{const a=r.slice(0);Km.getContext().decodeAudioData(a,function(e){t(e)})}catch(i){o?o(i):console.error(i),n.manager.itemError(e)}},r,o)}}),Im.prototype=Object.assign(Object.create(Jb.prototype),{constructor:Im,isHemisphereLightProbe:!0,copy:function(e){return Jb.prototype.copy.call(this,e),this},toJSON:function(e){return Jb.prototype.toJSON.call(this,e)}}),Hm.prototype=Object.assign(Object.create(Jb.prototype),{constructor:Hm,isAmbientLightProbe:!0,copy:function(e){return Jb.prototype.copy.call(this,e),this},toJSON:function(e){return Jb.prototype.toJSON.call(this,e)}});const Gm=new na,Fm=new na;function vx(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ga,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ga,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function ak(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(vx.prototype,{update:function(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;const r=e.projectionMatrix.clone(),o=t.eyeSep/2,n=o*t.near/t.focus,i=t.near*Math.tan(ma.DEG2RAD*t.fov*.5)/t.zoom;let a,s;Fm.elements[12]=-o,Gm.elements[12]=o,a=-i*t.aspect+n,s=i*t.aspect+n,r.elements[0]=2*t.near/(s-a),r.elements[8]=(s+a)/(s-a),this.cameraL.projectionMatrix.copy(r),a=-i*t.aspect-n,s=i*t.aspect-n,r.elements[0]=2*t.near/(s-a),r.elements[8]=(s+a)/(s-a),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Fm),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Gm)}}),Object.assign(ak.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});const od=new aa,Cm=new Ka,zx=new aa,ld=new aa;function Sk(){da.call(this),this.type="AudioListener",this.context=Km.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new ak}function Ze(e){da.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}Sk.prototype=Object.assign(Object.create(da.prototype),{constructor:Sk,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){da.prototype.updateMatrixWorld.call(this,e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(od,Cm,zx),ld.set(0,0,-1).applyQuaternion(Cm),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(od.x,e),t.positionY.linearRampToValueAtTime(od.y,e),t.positionZ.linearRampToValueAtTime(od.z,e),t.forwardX.linearRampToValueAtTime(ld.x,e),t.forwardY.linearRampToValueAtTime(ld.y,e),t.forwardZ.linearRampToValueAtTime(ld.z,e),t.upX.linearRampToValueAtTime(r.x,e),t.upY.linearRampToValueAtTime(r.y,e),t.upZ.linearRampToValueAtTime(r.z,e)}else t.setPosition(od.x,od.y,od.z),t.setOrientation(ld.x,ld.y,ld.z,r.x,r.y,r.z)}}),Ze.prototype=Object.assign(Object.create(da.prototype),{constructor:Ze,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});const gd=new aa,xm=new Ka,Fx=new aa,Uc=new aa;function vm(e){Ze.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function um(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function tm(e,t,r){let o,n,i;switch(this.binding=e,this.valueSize=r,t){case"quaternion":o=this._slerp,n=this._slerpAdditive,i=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":o=this._select,n=this._select,i=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:o=this._lerp,n=this._lerpAdditive,i=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r);}this._mixBufferRegion=o,this._mixBufferRegionAdditive=n,this._setIdentity=i,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}vm.prototype=Object.assign(Object.create(Ze.prototype),{constructor:vm,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this},updateMatrixWorld:function(e){if(da.prototype.updateMatrixWorld.call(this,e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(gd,xm,Fx),Uc.set(0,0,1).applyQuaternion(xm);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(gd.x,e),t.positionY.linearRampToValueAtTime(gd.y,e),t.positionZ.linearRampToValueAtTime(gd.z,e),t.orientationX.linearRampToValueAtTime(Uc.x,e),t.orientationY.linearRampToValueAtTime(Uc.y,e),t.orientationZ.linearRampToValueAtTime(Uc.z,e)}else t.setPosition(gd.x,gd.y,gd.z),t.setOrientation(Uc.x,Uc.y,Uc.z)}}),Object.assign(um.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}),Object.assign(tm.prototype,{accumulate:function(e,t){const r=this.buffer,o=this.valueSize,n=e*o+o;let i=this.cumulativeWeight;if(0===i){for(let e=0;e!==o;++e)r[n+e]=r[e];i=t}else{const e=t/(i+=t);this._mixBufferRegion(r,n,0,e,o)}this.cumulativeWeight=i},accumulateAdditive:function(e){const t=this.buffer,r=this.valueSize,o=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,o,0,e,r),this.cumulativeWeightAdditive+=e},apply:function(e){const t=this.valueSize,r=this.buffer,o=e*t+t,n=this.cumulativeWeight,i=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){const e=t*this._origIndex;this._mixBufferRegion(r,o,e,1-n,t)}i>0&&this._mixBufferRegionAdditive(r,o,this._addIndex*t,1,t);for(let s=t,l=t+t;s!==l;++s)if(r[s]!==r[s+t]){a.setValue(r,o);break}},saveOriginalState:function(){const e=this.binding,t=this.buffer,r=this.valueSize,o=r*this._origIndex;e.getValue(t,o);for(let n=r,i=o;n!==i;++n)t[n]=t[o+n%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]},_select:function(e,t,r,o,n){if(o>=.5)for(let i=0;i!==n;++i)e[t+i]=e[r+i]},_slerp:function(e,t,r,o){Ka.slerpFlat(e,t,e,t,e,r,o)},_slerpAdditive:function(e,t,r,o,n){const i=this._workIndex*n;Ka.multiplyQuaternionsFlat(e,i,e,t,e,r),Ka.slerpFlat(e,t,e,t,e,i,o)},_lerp:function(e,t,r,o,n){const i=1-o;for(let a=0;a!==n;++a){const n=t+a;e[n]=e[n]*i+e[r+a]*o}},_lerpAdditive:function(e,t,r,o,n){for(let i=0;i!==n;++i){const n=t+i;e[n]=e[n]+e[r+i]*o}}});const Kx=new RegExp("[\\[\\]\\.:\\/]","g"),Lx="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Mx=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Nx=/(WCOD+)?/.source.replace("WCOD",Lx),Ox=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Px=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Qx=new RegExp("^"+Mx+Nx+Ox+Px+"$"),Rx=["material","materials","bones"];function sm(e,t,r){const o=r||Wa.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,o)}function Wa(e,t,r){this.path=t,this.parsedPath=r||Wa.parseTrackName(t),this.node=Wa.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Ux(){this.uuid=ma.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,o=arguments.length;r!==o;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}function om(e,t,r,o){this._mixer=e,this._clip=t,this._localRoot=r||null,this.blendMode=o||t.blendMode;const n=t.tracks,i=n.length,a=new Array(i),s={endingStart:Ed,endingEnd:Ed};for(let l=0;l!==i;++l){const e=n[l].createInterpolant(null);a[l]=e,e.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=KB,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function nm(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Ik(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function mm(e,t,r){nb.call(this,e,t),this.meshPerAttribute=r||1}function lm(e,t,r,o){this.ray=new Nd(e,t),this.near=r||0,this.far=o||1/0,this.camera=null,this.layers=new mk,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function km(e,t){return e.distance-t.distance}function Hk(e,t,r,o){if(e.layers.test(t.layers)&&e.raycast(t,r),!0===o){const o=e.children;for(let e=0,n=o.length;e<n;e++)Hk(o[e],t,r,!0)}}function ay(e,t,r){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==r?r:0,this}function by(e,t,r){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==r?r:0,this}Object.assign(sm.prototype,{getValue:function(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,o=this._bindings[r];void 0!==o&&o.getValue(e,t)},setValue:function(e,t){const r=this._bindings;for(let o=this._targetGroup.nCachedObjects_,n=r.length;o!==n;++o)r[o].setValue(e,t)},bind:function(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(Wa,{Composite:sm,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new Wa.Composite(e,t,r):new Wa(e,t,r)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Kx,"")},parseTrackName:function(e){const t=Qx.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o){const e=r.nodeName.substring(o+1);-1!==Rx.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){const r=function(e){for(let o=0;o<e.length;o++){const n=e[o];if(n.name===t||n.uuid===t)return n;const i=r(n.children);if(i)return i}return null},o=r(e.children);if(o)return o}return null}}),Object.assign(Wa.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){const r=this.resolvedProperty;for(let o=0,n=r.length;o!==n;++o)e[t++]=r[o]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){const r=this.resolvedProperty;for(let o=0,n=r.length;o!==n;++o)r[o]=e[t++]},function(e,t){const r=this.resolvedProperty;for(let o=0,n=r.length;o!==n;++o)r[o]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){const r=this.resolvedProperty;for(let o=0,n=r.length;o!==n;++o)r[o]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){let e=this.node,t=this.parsedPath,r=t.objectName,o=t.propertyName,n=t.propertyIndex;if(e||(e=Wa.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let o=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===o){o=t;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r];}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}const i=e[o];if(void 0===i){const r=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r+"."+o+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===o){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[n]&&(n=e.morphTargetDictionary[n])}s=this.BindingType.ArrayElement,this.resolvedProperty=i,this.propertyIndex=n}else void 0!==i.fromArray&&void 0!==i.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=i):Array.isArray(i)?(s=this.BindingType.EntireArray,this.resolvedProperty=i):this.propertyName=o;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Wa.prototype,{_getValue_unbound:Wa.prototype.getValue,_setValue_unbound:Wa.prototype.setValue}),Object.assign(Ux.prototype,{isAnimationObjectGroup:!0,add:function(){const e=this._objects,t=this._indicesByUUID,r=this._paths,o=this._parsedPaths,n=this._bindings,i=n.length;let a=void 0,s=e.length,l=this.nCachedObjects_;for(let $=0,c=arguments.length;$!==c;++$){const c=arguments[$],p=c.uuid;let u=t[p];if(void 0===u){u=s++,t[p]=u,e.push(c);for(let e=0,t=i;e!==t;++e)n[e].push(new Wa(c,r[e],o[e]))}else if(u<l){a=e[u];const s=--l,$=e[s];t[$.uuid]=u,e[u]=$,t[p]=s,e[s]=c;for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[s];let a=t[u];t[u]=i,void 0===a&&(a=new Wa(c,r[e],o[e])),t[s]=a}}else e[u]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l},remove:function(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,o=r.length;let n=this.nCachedObjects_;for(let i=0,a=arguments.length;i!==a;++i){const a=arguments[i],s=a.uuid,l=t[s];if(void 0!==l&&l>=n){const i=n++,$=e[i];t[$.uuid]=l,e[l]=$,t[s]=i,e[i]=a;for(let e=0,t=o;e!==t;++e){const t=r[e],o=t[i],n=t[l];t[l]=o,t[i]=n}}}this.nCachedObjects_=n},uncache:function(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,o=r.length;let n=this.nCachedObjects_,i=e.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a].uuid,l=t[s];if(void 0!==l)if(delete t[s],l<n){const a=--n,s=e[a],$=--i,c=e[$];t[s.uuid]=l,e[l]=s,t[c.uuid]=a,e[a]=c,e.pop();for(let e=0,t=o;e!==t;++e){const t=r[e],o=t[a],n=t[$];t[l]=o,t[a]=n,t.pop()}}else{const n=--i,a=e[n];t[a.uuid]=l,e[l]=a,e.pop();for(let e=0,t=o;e!==t;++e){const t=r[e];t[l]=t[n],t.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){let r=this._bindingsIndicesByPath,o=r[e],n=this._bindings;if(void 0!==o)return n[o];const i=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,$=this.nCachedObjects_,c=new Array(l);o=n.length,r[e]=o,i.push(e),a.push(t),n.push(c);for(let p=$,u=s.length;p!==u;++p){const r=s[p];c[p]=new Wa(r,e,t)}return c},unsubscribe_:function(e){const t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){const o=this._paths,n=this._parsedPaths,i=this._bindings,a=i.length-1,s=i[a];t[e[a]]=r,i[r]=s,i.pop(),n[r]=n[a],n.pop(),o[r]=o[a],o.pop()}}}),Object.assign(om.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const r=this._clip.duration,o=e._clip.duration,n=o/r,i=r/o;e.warp(1,n,t),this.warp(i,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){const o=this._mixer,n=o.time,i=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=o._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,l=a.sampleValues;return s[0]=n,s[1]=n+r,l[0]=e/i,l[1]=t/i,this},stopWarping:function(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,o){if(!this.enabled)return void this._updateWeight(e);const n=this._startTime;if(null!==n){const o=(e-n)*r;if(o<0||0===r)return;this._startTime=null,t=r*o}t*=this._updateTimeScale(e);const i=this._updateTime(t),a=this._updateWeight(e);if(a>0){const e=this._interpolants,t=this._propertyBindings;switch(this.blendMode){case 2501:for(let r=0,o=e.length;r!==o;++r)e[r].evaluate(i),t[r].accumulateAdditive(a);break;case Pk:default:for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(i),t[r].accumulate(o,a);}}},_updateWeight:function(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(null!==r){const o=r.evaluate(e)[0];t*=o,e>r.parameterPositions[1]&&(this.stopFading(),0===o&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(null!==r){t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){const t=this._clip.duration,r=this.loop;let o=this.time+e,n=this._loopCount;const i=2202===r;if(0===e)return-1===n?o:i&&1==(1&n)?t-o:o;if(2200===r){-1===n&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(o>=t)o=t;else{if(!(o<0)){this.time=o;break e}o=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=o,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===n&&(e>=0?(n=0,this._setEndings(!0,0===this.repetitions,i)):this._setEndings(0===this.repetitions,!0,i)),o>=t||o<0){const r=Math.floor(o/t);o-=t*r,n+=Math.abs(r);const a=this.repetitions-n;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o=e>0?t:0,this.time=o,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){const t=e<0;this._setEndings(t,!t,i)}else this._setEndings(!1,!1,i);this._loopCount=n,this.time=o,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=o;if(i&&1==(1&n))return t-o}return o},_setEndings:function(e,t,r){const o=this._interpolantSettings;r?(o.endingStart=2401,o.endingEnd=2401):(o.endingStart=e?this.zeroSlopeAtStart?2401:Ed:2402,o.endingEnd=t?this.zeroSlopeAtEnd?2401:Ed:2402)},_scheduleFading:function(e,t,r){const o=this._mixer,n=o.time;let i=this._weightInterpolant;null===i&&(i=o._lendControlInterpolant(),this._weightInterpolant=i);const a=i.parameterPositions,s=i.sampleValues;return a[0]=n,s[0]=t,a[1]=n+e,s[1]=r,this}}),nm.prototype=Object.assign(Object.create(oc.prototype),{constructor:nm,_bindAction:function(e,t){const r=e._localRoot||this._root,o=e._clip.tracks,n=o.length,i=e._propertyBindings,a=e._interpolants,s=r.uuid,l=this._bindingsByRootAndName;let $=l[s];void 0===$&&($={},l[s]=$);for(let c=0;c!==n;++c){const e=o[c],n=e.name;let l=$[n];if(void 0!==l)i[c]=l;else{if(void 0!==(l=i[c])){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,s,n));continue}const o=t&&t._propertyBindings[c].binding.parsedPath;++(l=new tm(Wa.create(r,n,o),e.ValueTypeName,e.getValueSize())).referenceCount,this._addInactiveBinding(l,s,n),i[c]=l}a[c].resultBuffer=l.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,r=e._clip.uuid,o=this._actionsByClip[r];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,r,t)}const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){const o=this._actions,n=this._actionsByClip;let i=n[t];if(void 0===i)i={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=i;else{const t=i.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=o.length,o.push(e),i.actionByRoot[r]=e},_removeInactiveAction:function(e){const t=this._actions,r=t[t.length-1],o=e._cacheIndex;r._cacheIndex=o,t[o]=r,t.pop(),e._cacheIndex=null;const n=e._clip.uuid,i=this._actionsByClip,a=i[n],s=a.knownActions,l=s[s.length-1],$=e._byClipCacheIndex;l._byClipCacheIndex=$,s[$]=l,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete i[n],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){const t=e._propertyBindings;for(let r=0,o=t.length;r!==o;++r){const e=t[r];0==--e.referenceCount&&this._removeInactiveBinding(e)}},_lendAction:function(e){const t=this._actions,r=e._cacheIndex,o=this._nActiveActions++,n=t[o];e._cacheIndex=o,t[o]=e,n._cacheIndex=r,t[r]=n},_takeBackAction:function(e){const t=this._actions,r=e._cacheIndex,o=--this._nActiveActions,n=t[o];e._cacheIndex=o,t[o]=e,n._cacheIndex=r,t[r]=n},_addInactiveBinding:function(e,t,r){const o=this._bindingsByRootAndName,n=this._bindings;let i=o[t];void 0===i&&(i={},o[t]=i),i[r]=e,e._cacheIndex=n.length,n.push(e)},_removeInactiveBinding:function(e){const t=this._bindings,r=e.binding,o=r.rootNode.uuid,n=r.path,i=this._bindingsByRootAndName,a=i[o],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete a[n],0===Object.keys(a).length&&delete i[o]},_lendBinding:function(e){const t=this._bindings,r=e._cacheIndex,o=this._nActiveBindings++,n=t[o];e._cacheIndex=o,t[o]=e,n._cacheIndex=r,t[r]=n},_takeBackBinding:function(e){const t=this._bindings,r=e._cacheIndex,o=--this._nActiveBindings,n=t[o];e._cacheIndex=o,t[o]=e,n._cacheIndex=r,t[r]=n},_lendControlInterpolant:function(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return void 0===r&&((r=new Fh(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(e){const t=this._controlInterpolants,r=e.__cacheIndex,o=--this._nActiveControlInterpolants,n=t[o];e.__cacheIndex=o,t[o]=e,n.__cacheIndex=r,t[r]=n},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t,r){const o=t||this._root,n=o.uuid;let i="string"==typeof e?Db.findByName(o,e):e;const a=null!==i?i.uuid:e;let s=this._actionsByClip[a],l=null;if(void 0===r&&(r=null!==i?i.blendMode:Pk),void 0!==s){const e=s.actionByRoot[n];if(void 0!==e&&e.blendMode===r)return e;l=s.knownActions[0],null===i&&(i=l._clip)}if(null===i)return null;const $=new om(this,i,t,r);return this._bindAction($,l),this._addInactiveAction($,a,n),$},existingAction:function(e,t){const r=t||this._root,o=r.uuid,n="string"==typeof e?Db.findByName(r,e):e,i=n?n.uuid:e,a=this._actionsByClip[i];return void 0!==a&&a.actionByRoot[o]||null},stopAllAction:function(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,o=this.time+=e,n=Math.sign(e),i=this._accuIndex^=1;for(let l=0;l!==r;++l){t[l]._update(o,e,n,i)}const a=this._bindings,s=this._nActiveBindings;for(let l=0;l!==s;++l)a[l].apply(i);return this},setTime:function(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){const t=this._actions,r=e.uuid,o=this._actionsByClip,n=o[r];if(void 0!==n){const e=n.knownActions;for(let r=0,o=e.length;r!==o;++r){const o=e[r];this._deactivateAction(o);const n=o._cacheIndex,i=t[t.length-1];o._cacheIndex=null,o._byClipCacheIndex=null,i._cacheIndex=n,t[n]=i,t.pop(),this._removeInactiveBindingsForAction(o)}delete o[r]}},uncacheRoot:function(e){const t=e.uuid,r=this._actionsByClip;for(const n in r){const e=r[n].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const o=this._bindingsByRootAndName[t];if(void 0!==o)for(const n in o){const e=o[n];e.restoreOriginalState(),this._removeInactiveBinding(e)}},uncacheAction:function(e,t){const r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),Ik.prototype.clone=function(){return new Ik(void 0===this.value.clone?this.value:this.value.clone())},mm.prototype=Object.assign(Object.create(nb.prototype),{constructor:mm,isInstancedInterleavedBuffer:!0,copy:function(e){return nb.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){const t=nb.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){const t=nb.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.assign(lm.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,r){const o=r||[];return Hk(e,this,o,t),o.sort(km),o},intersectObjects:function(e,t,r){const o=r||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),o;for(let n=0,i=e.length;n<i;n++)Hk(e[n],this,o,t);return o.sort(km),o}}),Object.assign(ay.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(ma.clamp(t/this.radius,-1,1))),this}}),Object.assign(by.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}});const jm=new ca;function im(e,t){this.min=void 0!==e?e:new ca(1/0,1/0),this.max=void 0!==t?t:new ca(-1/0,-1/0)}Object.assign(im.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){const r=jm.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new ca),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new ca),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new ca),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new ca),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return jm.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});const hm=new aa,Xg=new aa;function fm(e,t){this.start=void 0!==e?e:new aa,this.end=void 0!==t?t:new aa}function Zg(e){da.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(fm.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new aa),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new aa),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new aa),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){hm.subVectors(e,this.start),Xg.subVectors(this.end,this.start);const r=Xg.dot(Xg);let o=Xg.dot(hm)/r;return t&&(o=ma.clamp(o,0,1)),o},closestPointToPoint:function(e,t,r){const o=this.closestPointToPointParameter(e,t);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new aa),this.delta(r).multiplyScalar(o).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Zg.prototype=Object.create(da.prototype),Zg.prototype.constructor=Zg,Zg.prototype.isImmediateRenderObject=!0;const em=new aa;function lg(e,t){da.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const r=new ga,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let i=0,a=1,s=32;i<s;i++,a++){const e=i/s*Math.PI*2,t=a/s*Math.PI*2;o.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}r.setAttribute("position",new ea(o,3));const n=new Ca({fog:!1,toneMapped:!1});this.cone=new Ea(r,n),this.add(this.cone),this.update()}lg.prototype=Object.create(da.prototype),lg.prototype.constructor=lg,lg.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},lg.prototype.update=function(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),em.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(em),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const uc=new aa,eh=new na,cj=new na;function cm(e){const t=[];e&&e.isBone&&t.push(e);for(let r=0;r<e.children.length;r++)t.push.apply(t,cm(e.children[r]));return t}function Kd(e){const t=cm(e),r=new ga,o=[],n=[],i=new ha(0,0,1),a=new ha(0,1,0);for(let l=0;l<t.length;l++){const e=t[l];e.parent&&e.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),n.push(i.r,i.g,i.b),n.push(a.r,a.g,a.b))}r.setAttribute("position",new ea(o,3)),r.setAttribute("color",new ea(n,3));const s=new Ca({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Ea.call(this,r,s),this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Nf(e,t,r){this.light=e,this.light.updateMatrixWorld(),this.color=r;const o=new Ad(t,4,2),n=new Ib({wireframe:!0,fog:!1,toneMapped:!1});ua.call(this,o,n),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}Kd.prototype=Object.create(Ea.prototype),Kd.prototype.constructor=Kd,Kd.prototype.isSkeletonHelper=!0,Kd.prototype.updateMatrixWorld=function(e){const t=this.bones,r=this.geometry,o=r.getAttribute("position");cj.getInverse(this.root.matrixWorld);for(let n=0,i=0;n<t.length;n++){const e=t[n];e.parent&&e.parent.isBone&&(eh.multiplyMatrices(cj,e.matrixWorld),uc.setFromMatrixPosition(eh),o.setXYZ(i,uc.x,uc.y,uc.z),eh.multiplyMatrices(cj,e.parent.matrixWorld),uc.setFromMatrixPosition(eh),o.setXYZ(i+1,uc.x,uc.y,uc.z),i+=2)}r.getAttribute("position").needsUpdate=!0,da.prototype.updateMatrixWorld.call(this,e)},Nf.prototype=Object.create(ua.prototype),Nf.prototype.constructor=Nf,Nf.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Nf.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const qy=new aa,am=new ha,_l=new ha;function Df(e,t,r){da.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;const o=new zd(t);o.rotateY(.5*Math.PI),this.material=new Ib({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const n=o.getAttribute("position"),i=new Float32Array(3*n.count);o.setAttribute("color",new ka(i,3)),this.add(new ua(o,this.material)),this.update()}function Kk(e,t,r,o){e=e||10,t=t||10,r=new ha(void 0!==r?r:4473924),o=new ha(void 0!==o?o:8947848);const n=t/2,i=e/t,a=e/2,s=[],l=[];for(let p=0,u=0,h=-a;p<=t;p++,h+=i){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);const e=p===n?r:o;e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3}const $=new ga;$.setAttribute("position",new ea(s,3)),$.setAttribute("color",new ea(l,3));const c=new Ca({vertexColors:!0,toneMapped:!1});Ea.call(this,$,c),this.type="GridHelper"}function zk(e,t,r,o,n,i){e=e||10,t=t||16,r=r||8,o=o||64,n=new ha(void 0!==n?n:4473924),i=new ha(void 0!==i?i:8947848);const a=[],s=[];for(let c=0;c<=t;c++){const r=c/t*(2*Math.PI),o=Math.sin(r)*e,l=Math.cos(r)*e;a.push(0,0,0),a.push(o,0,l);const $=1&c?n:i;s.push($.r,$.g,$.b),s.push($.r,$.g,$.b)}for(let c=0;c<=r;c++){const t=1&c?n:i,l=e-e/r*c;for(let e=0;e<o;e++){let r=e/o*(2*Math.PI),n=Math.sin(r)*l,i=Math.cos(r)*l;a.push(n,0,i),s.push(t.r,t.g,t.b),r=(e+1)/o*(2*Math.PI),n=Math.sin(r)*l,i=Math.cos(r)*l,a.push(n,0,i),s.push(t.r,t.g,t.b)}}const l=new ga;l.setAttribute("position",new ea(a,3)),l.setAttribute("color",new ea(s,3));const $=new Ca({vertexColors:!0,toneMapped:!1});Ea.call(this,l,$),this.type="PolarGridHelper"}Df.prototype=Object.create(da.prototype),Df.prototype.constructor=Df,Df.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Df.prototype.update=function(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");am.copy(this.light.color),_l.copy(this.light.groundColor);for(let e=0,r=t.count;e<r;e++){const o=e<r/2?am:_l;t.setXYZ(e,o.r,o.g,o.b)}t.needsUpdate=!0}e.lookAt(qy.setFromMatrixPosition(this.light.matrixWorld).negate())},Kk.prototype=Object.assign(Object.create(Ea.prototype),{constructor:Kk,copy:function(e){return Ea.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}}),zk.prototype=Object.create(Ea.prototype),zk.prototype.constructor=zk;const Vl=new aa,th=new aa,Ql=new aa;function vf(e,t,r){da.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1);let o=new ga;o.setAttribute("position",new ea([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const n=new Ca({fog:!1,toneMapped:!1});this.lightPlane=new xb(o,n),this.add(this.lightPlane),(o=new ga).setAttribute("position",new ea([0,0,0,0,0,1],3)),this.targetLine=new xb(o,n),this.add(this.targetLine),this.update()}vf.prototype=Object.create(da.prototype),vf.prototype.constructor=vf,vf.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},vf.prototype.update=function(){Vl.setFromMatrixPosition(this.light.matrixWorld),th.setFromMatrixPosition(this.light.target.matrixWorld),Ql.subVectors(th,Vl),this.lightPlane.lookAt(th),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(th),this.targetLine.scale.z=Ql.length()};const Ch=new aa,Ba=new ac;function Hh(e){const t=new ga,r=new Ca({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],n=[],i={},a=new ha(16755200),s=new ha(16711680),l=new ha(43775),$=new ha(16777215),c=new ha(3355443);function p(e,t,r){u(e,r),u(t,r)}function u(e,t){o.push(0,0,0),n.push(t.r,t.g,t.b),void 0===i[e]&&(i[e]=[]),i[e].push(o.length/3-1)}p("n1","n2",a),p("n2","n4",a),p("n4","n3",a),p("n3","n1",a),p("f1","f2",a),p("f2","f4",a),p("f4","f3",a),p("f3","f1",a),p("n1","f1",a),p("n2","f2",a),p("n3","f3",a),p("n4","f4",a),p("p","n1",s),p("p","n2",s),p("p","n3",s),p("p","n4",s),p("u1","u2",l),p("u2","u3",l),p("u3","u1",l),p("c","t",$),p("p","c",c),p("cn1","cn2",c),p("cn3","cn4",c),p("cf1","cf2",c),p("cf3","cf4",c),t.setAttribute("position",new ea(o,3)),t.setAttribute("color",new ea(n,3)),Ea.call(this,t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=i,this.update()}function Da(e,t,r,o,n,i,a){Ch.set(n,i,a).unproject(o);const s=t[e];if(void 0!==s){const e=r.getAttribute("position");for(let t=0,r=s.length;t<r;t++)e.setXYZ(s[t],Ch.x,Ch.y,Ch.z)}}Hh.prototype=Object.create(Ea.prototype),Hh.prototype.constructor=Hh,Hh.prototype.update=function(){const e=this.geometry,t=this.pointMap;Ba.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Da("c",t,e,Ba,0,0,-1),Da("t",t,e,Ba,0,0,1),Da("n1",t,e,Ba,-1,-1,-1),Da("n2",t,e,Ba,1,-1,-1),Da("n3",t,e,Ba,-1,1,-1),Da("n4",t,e,Ba,1,1,-1),Da("f1",t,e,Ba,-1,-1,1),Da("f2",t,e,Ba,1,-1,1),Da("f3",t,e,Ba,-1,1,1),Da("f4",t,e,Ba,1,1,1),Da("u1",t,e,Ba,.7,1.1,-1),Da("u2",t,e,Ba,-.7,1.1,-1),Da("u3",t,e,Ba,0,2,-1),Da("cf1",t,e,Ba,-1,0,1),Da("cf2",t,e,Ba,1,0,1),Da("cf3",t,e,Ba,0,-1,1),Da("cf4",t,e,Ba,0,1,1),Da("cn1",t,e,Ba,-1,0,-1),Da("cn2",t,e,Ba,1,0,-1),Da("cn3",t,e,Ba,0,-1,-1),Da("cn4",t,e,Ba,0,1,-1),e.getAttribute("position").needsUpdate=!0};const Kh=new Tb;function Zc(e,t){this.object=e,void 0===t&&(t=16776960);const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),n=new ga;n.setIndex(new ka(r,1)),n.setAttribute("position",new ka(o,3)),Ea.call(this,n,new Ca({color:t,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function Nh(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new ga;o.setIndex(new ka(r,1)),o.setAttribute("position",new ea([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Ea.call(this,o,new Ca({color:t,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function Oh(e,t,r){this.plane=e,this.size=void 0===t?1:t;const o=void 0!==r?r:16776960,n=new ga;n.setAttribute("position",new ea([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),n.computeBoundingSphere(),xb.call(this,n,new Ca({color:o,toneMapped:!1})),this.type="PlaneHelper";const i=new ga;i.setAttribute("position",new ea([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),i.computeBoundingSphere(),this.add(new ua(i,new Ib({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}Zc.prototype=Object.create(Ea.prototype),Zc.prototype.constructor=Zc,Zc.prototype.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Kh.setFromObject(this.object),Kh.isEmpty())return;const t=Kh.min,r=Kh.max,o=this.geometry.attributes.position,n=o.array;n[0]=r.x,n[1]=r.y,n[2]=r.z,n[3]=t.x,n[4]=r.y,n[5]=r.z,n[6]=t.x,n[7]=t.y,n[8]=r.z,n[9]=r.x,n[10]=t.y,n[11]=r.z,n[12]=r.x,n[13]=r.y,n[14]=t.z,n[15]=t.x,n[16]=r.y,n[17]=t.z,n[18]=t.x,n[19]=t.y,n[20]=t.z,n[21]=r.x,n[22]=t.y,n[23]=t.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()},Zc.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Zc.prototype.copy=function(e){return Ea.prototype.copy.call(this,e),this.object=e.object,this},Zc.prototype.clone=function(){return new this.constructor().copy(this)},Nh.prototype=Object.create(Ea.prototype),Nh.prototype.constructor=Nh,Nh.prototype.updateMatrixWorld=function(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),da.prototype.updateMatrixWorld.call(this,e))},Oh.prototype=Object.create(xb.prototype),Oh.prototype.constructor=Oh,Oh.prototype.updateMatrixWorld=function(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?Oa:Wf,this.lookAt(this.plane.normal),da.prototype.updateMatrixWorld.call(this,e)};const Hl=new aa;let Gl,Ky;function Fc(e,t,r,o,n,i){da.call(this),this.type="ArrowHelper",void 0===e&&(e=new aa(0,0,1)),void 0===t&&(t=new aa(0,0,0)),void 0===r&&(r=1),void 0===o&&(o=16776960),void 0===n&&(n=.2*r),void 0===i&&(i=.2*n),void 0===Gl&&((Gl=new ga).setAttribute("position",new ea([0,0,0,0,1,0],3)),(Ky=new Sc(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new xb(Gl,new Ca({color:o,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ua(Ky,new Ib({color:o,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,n,i)}function uk(e){const t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new ga;r.setAttribute("position",new ea(t,3)),r.setAttribute("color",new ea([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const o=new Ca({vertexColors:!0,toneMapped:!1});Ea.call(this,r,o),this.type="AxesHelper"}Fc.prototype=Object.create(da.prototype),Fc.prototype.constructor=Fc,Fc.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Hl.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Hl,t)}},Fc.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},Fc.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},Fc.prototype.copy=function(e){return da.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},Fc.prototype.clone=function(){return new this.constructor().copy(this)},uk.prototype=Object.create(Ea.prototype),uk.prototype.constructor=uk;const $d=4,Ac=8,Wb=Math.pow(2,Ac),Bl=[.125,.215,.35,.446,.526,.582],Al=Ac-$d+1+Bl.length,Zd=20,Xb={[$a]:0,[di]:1,[Lk]:2,[dl]:3,[el]:4,[fl]:5,[Mk]:6},Xi=new fg,{_lodPlanes:ff,_sizeLods:xl,_sigmas:Th}=cz();let Yy=null;const Wc=(1+Math.sqrt(5))/2,wd=1/Wc,vl=[new aa(1,1,1),new aa(-1,1,1),new aa(1,1,-1),new aa(-1,1,-1),new aa(0,Wc,wd),new aa(0,Wc,-wd),new aa(wd,0,Wc),new aa(-wd,0,Wc),new aa(Wc,wd,0),new aa(-Wc,wd,0)];function ul(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=fz(Zd),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function bz(e){return void 0!==e&&e.type===ag&&(e.encoding===$a||e.encoding===di||e.encoding===Mk)}function cz(){const e=[],t=[],r=[];let o=Ac;for(let n=0;n<Al;n++){const i=Math.pow(2,o);t.push(i);let a=1/i;n>Ac-$d?a=Bl[n-Ac+$d-1]:0==n&&(a=0),r.push(a);const s=1/(i-1),l=-s/2,$=1+s/2,c=[l,l,$,l,$,$,l,l,$,$,l,$],p=6,u=6,h=3,d=2,f=1,m=new Float32Array(h*u*p),x=new Float32Array(d*u*p),g=new Float32Array(f*u*p);for(let e=0;e<p;e++){const t=e%3*2/3-1,r=e>2?0:-1,o=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];m.set(o,h*u*e),x.set(c,d*u*e);const n=[e,e,e,e,e,e];g.set(n,f*u*e)}const v=new ga;v.setAttribute("position",new ka(m,h)),v.setAttribute("uv",new ka(x,d)),v.setAttribute("faceIndex",new ka(g,f)),e.push(v),o>$d&&o--}return{_lodPlanes:e,_sizeLods:t,_sigmas:r}}function tl(e){const t=new vb(3*Wb,3*Wb,e);return t.texture.mapping=kg,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Yh(e,t,r,o,n){e.viewport.set(t,r,o,n),e.scissor.set(t,r,o,n)}function fz(e){return new Qc({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(e)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new aa(0,1,0)},inputEncoding:{value:Xb[$a]},outputEncoding:{value:Xb[$a]}},vertexShader:jj(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${ej()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:Ic,depthTest:!1,depthWrite:!1})}function sl(){return new Qc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new ca(1,1)},inputEncoding:{value:Xb[$a]},outputEncoding:{value:Xb[$a]}},vertexShader:jj(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${ej()}\n\n#include <common>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv = equirectUv( outputDirection );\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:Ic,depthTest:!1,depthWrite:!1})}function rl(){return new Qc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Xb[$a]},outputEncoding:{value:Xb[$a]}},vertexShader:jj(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${ej()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:Ic,depthTest:!1,depthWrite:!1})}function jj(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\n\n// RH coordinate system; PMREM face-indexing convention\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\t} else if (face == 2.0) {\n\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\t} else if (face == 5.0) {\n\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\t}\n\treturn direction;\n}\n\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function ej(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}ul.prototype={constructor:ul,fromScene:function(e,t=0,r=.1,o=100){Yy=this._renderer.getRenderTarget();const n=this._allocateTargets();return this._sceneToCubeUV(e,r,o,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n},fromEquirectangular:function(e){return this._fromTexture(e)},fromCubemap:function(e){return this._fromTexture(e)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=rl(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=sl(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<ff.length;e++)ff[e].dispose()},_cleanup:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Yy),e.scissorTest=!1,Yh(e,0,0,e.width,e.height)},_fromTexture:function(e){Yy=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t},_allocateTargets:function(e){const t={magFilter:Pa,minFilter:Pa,generateMipmaps:!1,type:ag,format:fy,encoding:bz(e)?e.encoding:Lk,depthBuffer:!1,stencilBuffer:!1},r=tl(t);return r.depthBuffer=!e,this._pingPongRenderTarget=tl(t),r},_compileMaterial:function(e){const t=new ua(ff[0],e);this._renderer.compile(t,Xi)},_sceneToCubeUV:function(e,t,r,o){const n=new Ga(90,1,t,r),i=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,l=s.outputEncoding,$=s.toneMapping,c=s.getClearColor(),p=s.getClearAlpha();s.toneMapping=Md,s.outputEncoding=$a;let u=e.background;if(u&&u.isColor){u.convertSRGBToLinear();const t=Math.max(u.r,u.g,u.b),r=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);u=u.multiplyScalar(Math.pow(2,-r));const o=(r+128)/255;s.setClearColor(u,o),e.background=null}for(let h=0;h<6;h++){const t=h%3;0==t?(n.up.set(0,i[h],0),n.lookAt(a[h],0,0)):1==t?(n.up.set(0,0,i[h]),n.lookAt(0,a[h],0)):(n.up.set(0,i[h],0),n.lookAt(0,0,a[h])),Yh(o,t*Wb,h>2?Wb:0,Wb,Wb),s.setRenderTarget(o),s.render(e,n)}s.toneMapping=$,s.outputEncoding=l,s.setClearColor(c,p)},_textureToCubeUV:function(e,t){const r=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=rl()):null==this._equirectShader&&(this._equirectShader=sl());const o=e.isCubeTexture?this._cubemapShader:this._equirectShader,n=new ua(ff[0],o),i=o.uniforms;i.envMap.value=e,e.isCubeTexture||i.texelSize.value.set(1/e.image.width,1/e.image.height),i.inputEncoding.value=Xb[e.encoding],i.outputEncoding.value=Xb[t.texture.encoding],Yh(t,0,0,3*Wb,2*Wb),r.setRenderTarget(t),r.render(n,Xi)},_applyPMREM:function(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let o=1;o<Al;o++){const t=Math.sqrt(Th[o]*Th[o]-Th[o-1]*Th[o-1]),r=vl[(o-1)%vl.length];this._blur(e,o-1,o,t,r)}t.autoClear=r},_blur:function(e,t,r,o,n){const i=this._pingPongRenderTarget;this._halfBlur(e,i,t,r,o,"latitudinal",n),this._halfBlur(i,e,r,r,o,"longitudinal",n)},_halfBlur:function(e,t,r,o,n,i,a){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==i&&"longitudinal"!==i&&console.error("blur direction must be either latitudinal or longitudinal!");const $=new ua(ff[o],l),c=l.uniforms,p=xl[r]-1,u=isFinite(n)?Math.PI/(2*p):2*Math.PI/(2*Zd-1),h=n/u,d=isFinite(n)?1+Math.floor(3*h):Zd;d>Zd&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${d} samples when the maximum is set to ${Zd}`);const f=[];let m=0;for(let g=0;g<Zd;++g){const e=g/h,t=Math.exp(-e*e/2);f.push(t),0==g?m+=t:g<d&&(m+=2*t)}for(let g=0;g<f.length;g++)f[g]=f[g]/m;c.envMap.value=e.texture,c.samples.value=d,c.weights.value=f,c.latitudinal.value="latitudinal"===i,a&&(c.poleAxis.value=a),c.dTheta.value=u,c.mipInt.value=Ac-r,c.inputEncoding.value=Xb[e.texture.encoding],c.outputEncoding.value=Xb[e.texture.encoding];const x=xl[o];Yh(t,3*Math.max(0,Wb-2*x),(0===o?0:2*Wb)+2*x*(o>Ac-$d?o-Ac+$d:0),3*x,2*x),s.setRenderTarget(t),s.render($,Xi)}};function ql(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Hb.call(this,e),this.type="catmullrom"}ia.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(ia.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(vc.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=new la;for(let r=0,o=e.length;r<o;r++){const o=e[r];t.vertices.push(new aa(o.x,o.y,o.z||0))}return t}}),Object.assign(Mb.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),ql.prototype=Object.create(Hb.prototype),Object.assign(ql.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Kk.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Kd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(ta.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),bn.extractUrlBase(e)}}),ta.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(jk.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(im.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Tb.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(_b.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Hf.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},fm.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(ma,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ma.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ma.ceilPowerOfTwo(e)}}),Object.assign(Xa.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(na.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new aa().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,r,o,n,i){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,o,r,n,i)}}),Pb.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Ka.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Nd.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Qa.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Qa,{barycoordFromPoint:function(e,t,r,o,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Qa.getBarycoord(e,t,r,o,n)},normal:function(e,t,r,o){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Qa.getNormal(e,t,r,o)}}),Object.assign(qd.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Id(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Se(this,e)}}),Object.assign(ca.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(aa.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(sa.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(la.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(da.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(da.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(ua.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(ua.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Rg.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Qi.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Si.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(ia.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ga.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(xa.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(ka.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===gf},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(gf)}}}),Object.assign(ka.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?gf:bi),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ga.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new ka(arguments[1],arguments[2])))},addDrawCall:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(ga.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Cg.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(lm.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(nb.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===gf},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(nb.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?gf:bi),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(nc.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Ik.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(ja.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ha}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Xc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Sa.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(of.prototype,{clearTarget:function(e,t,r,o){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,r,o)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(of.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?di:$a}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(So.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(vb.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Ze.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return new ik().load(e,function(e){t.setBuffer(e)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),um.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ng.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};fd.crossOrigin=void 0,fd.loadTexture=function(e,t,r,o){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const n=new Ae;n.setCrossOrigin(this.crossOrigin);const i=n.load(e,r,void 0,o);return t&&(i.mapping=t),i},fd.loadTextureCube=function(e,t,r,o){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const n=new Ti;n.setCrossOrigin(this.crossOrigin);const i=n.load(e,r,void 0,o);return t&&(i.mapping=t),i},fd.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},fd.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"118"}}));var Ma=new(function(){function e(){Vw(this,e),this.scene=new Ye,this.winSize=ig(),this.camera=new Ga(45,this.winSize.width/this.winSize.height,.1,100),this.camera.position.z=50,this.renderer=new of({alpha:!0}),this.renderer.setPixelRatio(ba.utils.clamp(1.5,1,window.devicePixelRatio)),this.renderer.setSize(this.winSize.width,this.winSize.height),this.renderer.setClearColor(0,0),this.clock=new ak,this.scroll=0,this.init()}return Xw(e,[{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"run",value:function(e){var i=e.current,r=e.els,t=this.clock.getElapsedTime();this.scroll=i;for(var n=0;n<this.scene.children.length;n++){var s=this.scene.children[n];s.updatePosition(r.length>0?r[n].dir:0,i),s.updateTime(t)}this.render()}},{key:"addEvents",value:function(){Ia.on("tick",this.run.bind(this)),Ia.on("resize",this.resize.bind(this))}},{key:"init",value:function(){this.addToDom(),this.addEvents()}},{key:"addToDom",value:function(){var e=this.renderer.domElement;e.classList.add("dom-gl"),document.body.appendChild(e)}},{key:"resize",value:function(){this.winSize=ig(),this.renderer.setSize(this.winSize.width,this.winSize.height),this.camera.updateProjectionMatrix();for(var e=0;e<this.scene.children.length;e++){this.scene.children[e].resize()}}}]),e}());function mz(e){return(mz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pl(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function pz(e,t,r){return t&&pl(e.prototype,t),r&&pl(e,r),e}function qz(e,t,r){return(qz="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var o=rz(e,t);if(o){var a=Object.getOwnPropertyDescriptor(o,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}function rz(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zh(e)););return e}function sz(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tz(e,t)}function tz(e,t){return(tz=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uz(e){var t=xz();return function(){var r,o=Zh(e);if(t){var a=Zh(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return vz(this,r)}}function vz(e,t){return!t||"object"!==mz(t)&&"function"!=typeof t?wz(e):t}function wz(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xz(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Zh(e){return(Zh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zz(t){return(zz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Az(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ol(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cz(t,e,i){return e&&ol(t.prototype,e),i&&ol(t,i),t}function Dz(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ez(t,e)}function Ez(t,e){return(Ez=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fz(t){var e=Iz();return function(){var i,r=nl(t);if(e){var o=nl(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return Gz(this,i)}}function Gz(t,e){return!e||"object"!==zz(e)&&"function"!=typeof e?Hz(t):e}function Hz(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Iz(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function nl(t){return(nl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ml=function(t){Dz(i,da);var e=Fz(i);function i(){return Az(this,i),e.apply(this,arguments)}return Cz(i,[{key:"init",value:function(t){this.el=[t].flat(),this.dir=0,this.elArray=[],this.resize()}},{key:"setBounds",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;0===this.elArray.length&&this.el.forEach(function(e){var i=e.getBoundingClientRect(),r={left:i.left-Ma.scroll-t.dir,top:i.top,width:i.width,height:i.height};t.elArray.push(r)}),this.bounds=this.elArray[e],this.updateSize(),this.updatePosition(0,this.bounds.left)}},{key:"resize",value:function(){this.visible&&(this.elArray=[],this.setBounds())}},{key:"calculateUnitSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.position.z,e=Ma.camera.fov*Math.PI/180,i=2*Math.tan(e/2)*t;return{width:i*Ma.camera.aspect,height:i}}},{key:"updateSize",value:function(){this.camUnit=this.calculateUnitSize(Ma.camera.position.z-this.position.z);var t=this.bounds.width/Ma.winSize.width,e=this.bounds.height/Ma.winSize.height;t&&e&&(this.scale.x=this.camUnit.width*t,this.scale.y=this.camUnit.height*e)}},{key:"updateY",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.bounds,i=e.top;e.height;this.position.y=this.camUnit.height/2-this.scale.y/2,this.position.y-=(i-t)/Ma.winSize.height*this.camUnit.height}},{key:"updateX",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.bounds.left;this.position.x=-this.camUnit.width/2+this.scale.x/2,this.position.x+=(e+t)/Ma.winSize.width*this.camUnit.width}},{key:"updatePosition",value:function(t,e){this.updateY(0),this.dir=t,this.updateX(this.dir+e)}},{key:"destroy",value:function(){this.geometry.dispose(),this.material.dispose(),Ma.scene.remove(this)}}]),i}();var Lz={};Lz="precision highp float;\n#define GLSLIFY 1\nvarying vec2 vUv;\nuniform float uTime;\nuniform float uProg;\nuniform float uIndex;\nuniform vec2 uMouse;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nvoid main() {\n    vec3 pos = position;\n \n    pos.z += snoise(vec3(pos.x * 4. + uTime, pos.y, 0.)) * uProg;\n    pos.z *= 1.5; \n\n    vUv = uv;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.);\n}";var Mz={};Mz="precision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vUv;\n// varying float wave;\n\nuniform sampler2D uTexture;\nuniform float uTime;\nuniform float uFlash;\nuniform float uClip;\nuniform float uProg;\n  \nvoid main() {\n    vec2 uv = vUv;\n    vec2 dUv = vec2(uv.x, uv.y);\n      \n    // Flash (alpha channel and mapping texture);\n    float r = max(texture2D(uTexture, dUv).r, uFlash);\n    float g = max(texture2D(uTexture, dUv).g, uFlash);\n    float b = max(texture2D(uTexture, dUv).b, uFlash);\n    vec3 texture = vec3(r, g, b);  \n\n    // Clip effect with short smoothstep [.0,.005] -> no gradient\n    float clip = smoothstep(.0,.005,(uClip - dUv.y));\n    \n    gl_FragColor = vec4(texture, clip);\n}";var ll=zb(Lz);var Oz=zb(Mz);var Pz=new Cc(1,1,32,32),Qz=new Sa({vertexShader:ll.d,fragmentShader:Oz.d,transparent:!0}),Rz=new Ae,Sz=function(e){sz(r,ml);var t=uz(r);function r(){return nz(this,r),t.apply(this,arguments)}return pz(r,[{key:"init",value:function(e,t){var o=this,a=e.querySelector(".js-prlx-img");qz(Zh(r.prototype),"init",this).call(this,a),this.geometry=Pz,this.material=Qz.clone(),this.material.uniforms={uTexture:{value:0},uTime:{value:0},uProg:{value:1},uFlash:{value:1},uClip:{value:0},uMouse:{value:{x:0,y:0}}},this.img=a,this.texture=Rz.load(this.img.src,function(e){e.minFilter=Na,e.generateMipmaps=!1,o.material.uniforms.uTexture.value=e}),this.mesh=new ua(this.geometry,this.material);var s=t%3==0?-1.5:t%3==1?0:1.5;this.mesh.position.z=s,this.add(this.mesh),Ma.scene.add(this)}},{key:"updateTime",value:function(e){this.material.uniforms.uTime.value=e}},{key:"isViewed",value:function(){ba.to(this.material.uniforms.uClip,{duration:.5,value:1,ease:"Power2.inOut"}),ba.to(this.material.uniforms.uFlash,{duration:1,value:0,delay:.2,ease:"power.inOut"}),ba.to(this.material.uniforms.uProg,{duration:2,value:0,delay:.4,ease:"power.inOut"})}}]),r}();var Tz=function(e){Cw(r,Zb);var t=Ew(r);function r(e){var a;return qw(this,r),(a=t.call(this,e)).container=a.el,a.els=[],a.windowWidth=window.innerWidth,a.prlxEls=[],a.scrollPath=ig().width/3,a.timer=0,a.events={click:{scrollof:"clickToMove"},mouseenter:{scrollof:"displayArrow"},mouseleave:{scrollof:"hideArrow"}},a}return rw(r,[{key:"init",value:function(){var e=this;Ao().then(function(){if(window.matchMedia("(min-width: 640px)").matches){var t={callback:[e.parallax.bind(e),e.scroller.bind(e)],touch:!0,delay:.1,direction:"horizontal",speed:.9,section:e.el,touchSpeed:2,jump:120,preloadFuncs:{error:e.onPreloadError.bind(e)},initFuncs:[e.addElements.bind(e),e.parallax.bind(e,.1,0,1)],scrollFuncs:{startFunc:e.atStart.bind(e),runningFunc:e.atRun.bind(e),endFunc:e.atEnd.bind(e)}};e.scroll=new Ai(t,"fixedClass")}else e.scroll=null})}},{key:"addElements",value:function(){var e=0;Ma.scroll=0,this.els=qg(this.container.querySelectorAll("[data-parallaxe]")).map(function(t,r){var a=null;return"img"===t.dataset.parallaxe&&((a=new Sz).init(t,e),e+=1),{el:t,glObject:a,speed:t.dataset.speed||0,delay:t.dataset.delay||0,inView:!1,isView:!1,type:t.dataset.parallaxe,dir:0,left:t.getBoundingClientRect().left,right:t.getBoundingClientRect().left+t.getBoundingClientRect().width,initLeft:t.getBoundingClientRect().left,initRight:t.getBoundingClientRect().left+t.getBoundingClientRect().width}})}},{key:"displayArrow",value:function(e){this.call("displayArrow",e.currentTarget.dataset.scrollDir,"Cursor")}},{key:"hideArrow",value:function(e){this.call("hideArrow",e.currentTarget.dataset.scrollDir,"Cursor")}},{key:"clickToMove",value:function(e){var t="next"===e.currentTarget.dataset.scrollDir?this.scrollPath:-this.scrollPath;this.scroll.scrollOf(t)}},{key:"onPreloadError",value:function(e){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"loadingFailure",url:e.url,status:e.status})}},{key:"atStart",value:function(){this.$("scrollof").length>0&&(qg(this.$("scrollof")).filter(function(e){return"prev"===e.dataset.scrollDir})[0].style.display="none")}},{key:"atEnd",value:function(){this.$("scrollof").length>0&&(qg(this.$("scrollof")).filter(function(e){return"next"===e.dataset.scrollDir})[0].style.display="none")}},{key:"atRun",value:function(){this.$("scrollof").length>0&&qg(this.$("scrollof")).forEach(function(e){return e.style.display="block"})}},{key:"scroller",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(100*Math.abs(e)/t).toFixed(0);ba.to(".js-scroller",{clipPath:"polygon(".concat(r,"% 0,100% 0%, 100% 100%, ").concat(r,"% 100%)")})}},{key:"parallax",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];var t=Math.abs(e),r=t+this.windowWidth;this.els.length>0&&(this.els.forEach(function(e){if(e.right>t&&e.left<r){if(!1===e.isView){var a=e.el;"img"===e.el.dataset.parallaxe?e.glObject.isViewed():"bg"===e.el.dataset.parallaxe?ba.to(a.querySelector(".js-bg"),{scaleY:1,duration:1,delay:e.delay,ease:"Power3.easeInOut"}):ba.to(a,{autoAlpha:1,duration:1,delay:e.delay,ease:"Power3.easeInOut"}),e.isView=!0}e.inView=!0}else e.inView=!1;(e.inView&&"img"===e.el.dataset.parallaxe||"illu"===e.el.dataset.parallaxe||"bg"===e.el.dataset.parallaxe)&&(e.dir=(e.initLeft-r)*e.speed,e.el.style.transform="matrix3d(1,0,0.00,0,0.00,1,0.00,0,0,0,1,0,".concat(e.dir,",0,0,1)"),e.right=e.el.getBoundingClientRect().left+e.el.getBoundingClientRect().width+t,e.left=e.el.getBoundingClientRect().left+t)}),Ia.emit("scroll",{els:this.els.filter(function(e){return"img"===e.type}),x:t}))}},{key:"destroy",value:function(){for(var e in this.els.forEach(function(e){e.glObject&&e.glObject.destroy()}),this.scroll&&this.scroll.destroy(),Ma.scroll=0,this)Object.prototype.hasOwnProperty.call(this,e)&&(this[e]=null,delete this[e])}}]),r}();function Uz(e){return(Uz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Xe(e){return $z(e)||Zz(e)||Yz(e)||Xz()}function Xz(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yz(e,t){if(e){if("string"==typeof e)return Nk(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Nk(e,t):void 0}}function Zz(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function $z(e){if(Array.isArray(e))return Nk(e)}function Nk(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function aA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kl(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cA(e,t,i){return t&&kl(e.prototype,t),i&&kl(e,i),e}function dA(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eA(e,t)}function eA(e,t){return(eA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fA(e){var t=iA();return function(){var i,r=jl(e);if(t){var s=jl(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return gA(this,i)}}function gA(e,t){return!t||"object"!==Uz(t)&&"function"!=typeof t?hA(e):t}function hA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iA(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function jl(e){return(jl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tk,Qj={};!function(e,t){"object"==typeof Qj?Qj=t():"function"==typeof tk&&tk.amd?tk(t):(e||self).virtualScroll=t()}(Qj,function(){var e=0;function t(t){return"__private_"+e++ +"_"+t}function i(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}function n(){}n.prototype={on:function(e,t,i){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){var n=this;function o(){n.off(e,o),t.apply(i,arguments)}return o._=t,this.on(e,o,i)},emit:function(e){for(var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),n=0,o=i.length;n<o;n++)i[n].fn.apply(i[n].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),n=i[e],o=[];if(n&&t)for(var s=0,r=n.length;s<r;s++)n[s].fn!==t&&n[s].fn._!==t&&o.push(n[s]);return o.length?i[e]=o:delete i[e],this}};var o=n;o.TinyEmitter=n;var s=("onwheel"in document),r=("onmousewheel"in document),h=("ontouchstart"in document),a=navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>1,l=!!window.navigator.msPointerEnabled,u=("onkeydown"in document),c=navigator.userAgent.indexOf("Firefox")>-1,d="virtualscroll",v=t("options"),f=t("el"),p=t("emitter"),y=t("event"),w=t("touchStart"),_=t("bodyTouchAction");return function(){function e(e){var t;Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),t=this,["_onWheel","_onMouseWheel","_onTouchStart","_onTouchMove","_onKeyDown"].forEach(function(e){t[e]=t[e].bind(t)}),i(this,f)[f]=window,e&&e.el&&(i(this,f)[f]=e.el,delete e.el),i(this,v)[v]=Object.assign({mouseMultiplier:1,touchMultiplier:2,firefoxMultiplier:15,keyStep:120,preventTouch:!1,unpreventTouchClass:"vs-touchmove-allowed",useKeyboard:!0,useTouch:!0},e),i(this,p)[p]=new o,i(this,y)[y]={y:0,x:0,deltaX:0,deltaY:0},i(this,w)[w]={x:null,y:null},i(this,_)[_]=null,void 0!==i(this,v)[v].passive&&(this.listenerOptions={passive:i(this,v)[v].passive})}var t=e.prototype;return t._notify=function(e){var t=i(this,y)[y];t.x+=t.deltaX,t.y+=t.deltaY,i(this,p)[p].emit(d,{x:t.x,y:t.y,deltaX:t.deltaX,deltaY:t.deltaY,originalEvent:e})},t._onWheel=function(e){var t=i(this,v)[v],n=i(this,y)[y];n.deltaX=e.wheelDeltaX||-1*e.deltaX,n.deltaY=e.wheelDeltaY||-1*e.deltaY,c&&1===e.deltaMode&&(n.deltaX*=t.firefoxMultiplier,n.deltaY*=t.firefoxMultiplier),n.deltaX*=t.mouseMultiplier,n.deltaY*=t.mouseMultiplier,this._notify(e)},t._onMouseWheel=function(e){var t=i(this,y)[y];t.deltaX=e.wheelDeltaX?e.wheelDeltaX:0,t.deltaY=e.wheelDeltaY?e.wheelDeltaY:e.wheelDelta,this._notify(e)},t._onTouchStart=function(e){var t=e.targetTouches?e.targetTouches[0]:e;i(this,w)[w].x=t.pageX,i(this,w)[w].y=t.pageY},t._onTouchMove=function(e){var t=i(this,v)[v];t.preventTouch&&!e.target.classList.contains(t.unpreventTouchClass)&&e.preventDefault();var n=i(this,y)[y],o=e.targetTouches?e.targetTouches[0]:e;n.deltaX=(o.pageX-i(this,w)[w].x)*t.touchMultiplier,n.deltaY=(o.pageY-i(this,w)[w].y)*t.touchMultiplier,i(this,w)[w].x=o.pageX,i(this,w)[w].y=o.pageY,this._notify(e)},t._onKeyDown=function(e){var t=i(this,y)[y];t.deltaX=t.deltaY=0;var n=window.innerHeight-40;switch(e.keyCode){case 37:case 38:t.deltaY=i(this,v)[v].keyStep;break;case 39:case 40:t.deltaY=-i(this,v)[v].keyStep;break;case e.shiftKey:t.deltaY=n;break;case 32:t.deltaY=-n;break;default:return;}this._notify(e)},t._bind=function(){s&&i(this,f)[f].addEventListener("wheel",this._onWheel,this.listenerOptions),r&&i(this,f)[f].addEventListener("mousewheel",this._onMouseWheel,this.listenerOptions),h&&i(this,v)[v].useTouch&&(i(this,f)[f].addEventListener("touchstart",this._onTouchStart,this.listenerOptions),i(this,f)[f].addEventListener("touchmove",this._onTouchMove,this.listenerOptions)),l&&a&&(i(this,_)[_]=document.body.style.msTouchAction,document.body.style.msTouchAction="none",i(this,f)[f].addEventListener("MSPointerDown",this._onTouchStart,!0),i(this,f)[f].addEventListener("MSPointerMove",this._onTouchMove,!0)),u&&i(this,v)[v].useKeyboard&&document.addEventListener("keydown",this._onKeyDown)},t._unbind=function(){s&&i(this,f)[f].removeEventListener("wheel",this._onWheel),r&&i(this,f)[f].removeEventListener("mousewheel",this._onMouseWheel),h&&(i(this,f)[f].removeEventListener("touchstart",this._onTouchStart),i(this,f)[f].removeEventListener("touchmove",this._onTouchMove)),l&&a&&(document.body.style.msTouchAction=i(this,_)[_],i(this,f)[f].removeEventListener("MSPointerDown",this._onTouchStart,!0),i(this,f)[f].removeEventListener("MSPointerMove",this._onTouchMove,!0)),u&&i(this,v)[v].useKeyboard&&document.removeEventListener("keydown",this._onKeyDown)},t.on=function(e,t){i(this,p)[p].on(d,e,t);var n=i(this,p)[p].e;n&&n[d]&&1===n[d].length&&this._bind()},t.off=function(e,t){i(this,p)[p].off(d,e,t);var n=i(this,p)[p].e;(!n[d]||n[d].length<=0)&&this._unbind()},t.destroy=function(){i(this,p)[p].off(),this._unbind()},e}()});function mA(e){return(mA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nA(e){return rA(e)||qA(e)||pA(e)||oA()}function oA(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pA(e,t){if(e){if("string"==typeof e)return Oi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Oi(e,t):void 0}}function qA(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function rA(e){if(Array.isArray(e))return Oi(e)}function Oi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function tA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hl(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vA(e,t,r){return t&&hl(e.prototype,t),r&&hl(e,r),e}function lf(e,t,r){return(lf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=xA(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}function xA(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bc(e)););return e}function yA(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zA(e,t)}function zA(e,t){return(zA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AA(e){var t=DA();return function(){var r,i=Bc(e);if(t){var a=Bc(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return BA(this,r)}}function BA(e,t){return!t||"object"!==mA(t)&&"function"!=typeof t?CA(e):t}function CA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DA(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Bc(e){return(Bc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var FA={};FA="precision highp float;\n#define GLSLIFY 1\nvarying vec2 vUv;\n\nuniform sampler2D uCurrTex;\nuniform sampler2D uNextTex;\nuniform float uFlash;\nuniform float uClip;\nuniform float uTime;\nuniform float uSlide;\nuniform vec4 resolution;\n\nmat2 rotate(float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\treturn mat2(c, -s, s, c);\n}\nconst float PI = 3.1415;\nconst float angle1 = PI *0.25;\nconst float angle2 = -PI *0.75;\nconst float noiseSeed = 2.;\nfloat random() { \n\treturn fract(sin(noiseSeed + dot(gl_FragCoord.xy / resolution.xy / 10.0, vec2(12.9898, 4.1414))) * 43758.5453);\n}\nfloat hash(float n) { return fract(sin(n) * 1e4); }\nfloat hash(vec2 p) { return fract(1e4 * sin(17.0 * p.x + p.y * 0.1) * (0.1 + abs(sin(p.y * 13.0 + p.x)))); }\nfloat hnoise(vec2 x) {\n\tvec2 i = floor(x);\n\tvec2 f = fract(x);\n\tfloat a = hash(i);\n\tfloat b = hash(i + vec2(1.0, 0.0));\n\tfloat c = hash(i + vec2(0.0, 1.0));\n\tfloat d = hash(i + vec2(1.0, 1.0));\n\tvec2 u = f * f * (3.0 - 2.0 * f);\n\treturn mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;\n}\n\nvoid main()\t{\n\tvec2 newUV = (vUv - vec2(0.5))*resolution.zw + vec2(0.5);\n\t\t\t\n\tfloat hn = hnoise(newUV.xy * resolution.xy / 100.0);\n\tvec2 d = vec2(0.,normalize(vec2(0.5,0.5) - newUV.xy).y);\n\tvec2 uv1 = newUV + d * uSlide / 5.0 * (1.0 + hn / 2.0);\n\tvec2 uv2 = newUV - d * (1.0 - uSlide) / 5.0 * (1.0 + hn / 2.0);\n\n    // Clip effect with short smoothstep [.0,.005] -> no gradient\n    float clip = smoothstep(.0,.005,(uClip - uv1.y));\n\n    // Flash (alpha channel and mapping texture);\n    float t1r = max(texture2D(uCurrTex, uv1).r, uFlash);\n    float t1g = max(texture2D(uCurrTex, uv1).g, uFlash);\n    float t1b = max(texture2D(uCurrTex, uv1).b, uFlash);\n    vec4 t1 = vec4(t1r, t1g, t1b, clip);\n\n    float t2r = max(texture2D(uNextTex, uv2).r, uFlash);\n    float t2g = max(texture2D(uNextTex, uv2).g, uFlash);\n    float t2b = max(texture2D(uNextTex, uv2).b, uFlash);\n    vec4 t2 = vec4(t2r,t2g,t2b, clip);\n\n\tgl_FragColor = mix(t1, t2, uSlide);\n}\n\n";var GA=zb(FA);var HA=new Cc(1,1,32,32),IA=new Sa({vertexShader:ll.d,fragmentShader:GA.d,transparent:!0}),a=new Ae,vi=function(e){yA(r,ml);var t=AA(r);function r(){return tA(this,r),t.apply(this,arguments)}return vA(r,[{key:"init",value:function(e,t){var i=this;this.imgs=nA(e.querySelectorAll(".js-prlx-img")),this.slideCounter=0,this.loaded=!1,this.anim={timer:1.2},lf(Bc(r.prototype),"init",this).call(this,this.imgs),this.geometry=HA,this.material=IA.clone(),this.material.uniforms={uCurrTex:{value:0},uNextTex:{value:0},resolution:{value:{x:this.elArray[0].width,y:this.elArray[0].height,z:1,w:1}},uTime:{value:0},uProg:{value:1},uSlide:{value:0},uFlash:{value:1},uClip:{value:0},uMouse:{value:{x:0,y:0}}},this.mesh=new ua(this.geometry,this.material),this.add(this.mesh),Ma.scene.add(this),this.textures=[],this.loadTexture(t),this.sliderAnim=ba.timeline({paused:!0,onComplete:function(){i.material.uniforms.uCurrTex.value=i.textures[i.slideCounter]}}),this.sliderAnim.to(this.material.uniforms.uProg,{duration:this.anim.timer/2,value:1.5,ease:"power1.in"},0),this.sliderAnim.to(this.material.uniforms.uProg,{duration:this.anim.timer/2,value:0,ease:"power1.out"},this.anim.timer/2),this.sliderAnim.to(this.material.uniforms.uSlide,{duration:this.anim.timer,value:1,ease:"power1.inOut"},0)}},{key:"loadTexture",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=new nj(function(){e.material.uniforms.uCurrTex.value=e.textures[t]}),i=new Ae(r);this.imgs.forEach(function(t,r){i.load(t.src,function(t){t.minFilter=Na,t.generateMipmaps=!1,e.textures[r]=t})})}},{key:"updateTime",value:function(e){this.material.uniforms.uTime.value=e}},{key:"updateSize",value:function(){this.camUnit=lf(Bc(r.prototype),"calculateUnitSize",this).call(this,Ma.camera.position.z-this.position.z);var e=this.bounds.width/Ma.winSize.width,t=this.bounds.height/Ma.winSize.height;e&&t&&(this.loaded?(ba.to(this.scale,{x:this.camUnit.width*e,duration:this.anim.timer,ease:"power2.inOut"}),ba.to(this.scale,{y:this.camUnit.height*t,duration:this.anim.timer,ease:"power2.inOut"})):(this.scale.x=this.camUnit.width*e,this.scale.y=this.camUnit.height*t))}},{key:"updateY",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loaded||lf(Bc(r.prototype),"updateY",this).call(this)}},{key:"updateX",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loaded||lf(Bc(r.prototype),"updateX",this).call(this)}},{key:"removetexture",value:function(e){this.textures.splice(e,1)}},{key:"slide",value:function(e){var t=this;return new Promise(function(i){t.slideCounter=e,t.material.uniforms.uNextTex.value=t.textures[t.slideCounter],lf(Bc(r.prototype),"setBounds",t).call(t,t.slideCounter),t.sliderAnim.play(0).then(function(){return i()})})}},{key:"isViewed",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return new Promise(function(r){e.loaded=!0,ba.to(e.material.uniforms.uClip,{duration:.5,value:1,ease:"Power2.inOut"}),ba.to(e.material.uniforms.uFlash,{duration:1,value:0,delay:.2,ease:"power.inOut"}),ba.to(e.material.uniforms.uProg,{duration:t,value:0,delay:.4,ease:"power.inOut"}).then(function(e){r()})})}}]),r}();var LA=function(e){dA(i,Zb);var t=fA(i);function i(e){var r;return aA(this,i),(r=t.call(this,e)).glObject=null,r.slider=null,r.event={},r.slideIsRunning=!0,r}return cA(i,[{key:"init",value:function(){var e=this;Ma.scroll=0,Ia.emit("scroll",{els:[],x:0}),this.DOM={},this.scrollDelta=0,this.sliderDelay=1.2,this.isStarted=!1,this.isAppear=!1,this.isAppearOnce=!1,Ao().then(function(){e.setSeries(),e.setInfos(),e.setLinks(),e.setLoader(),e.bindEvent();var t=e.el.querySelector("[data-slider=\"img\"]"),i=e.el.querySelector("[data-prev=\"img\"]"),r=e.el.querySelector("[data-next=\"img\"]");e.glObject=new vi,e.glObject.init(t,0),e.prevObject=new vi,e.prevObject.init(i,5),e.nextObject=new vi,e.nextObject.init(r,1)})}},{key:"setLoader",value:function(){var $qP5t$$interop$default=zb(Sg);this.DOM.subtitle=document.querySelector("#js-loader-subtitle"),this.DOM.date=document.querySelector("#js-loader-date"),this.DOM.gabriel=document.querySelector("#js-loader-title-out"),this.DOM.loading=document.querySelector("#js-main-container"),this.DOM.content=document.querySelector("#js-loader-content"),this.DOM.circle=document.querySelector("#js-loader-circle"),this.DOM.arrow=document.querySelector("#js-loader-arrow"),$qP5t$$interop$default.d(this.DOM.subtitle,{setClassName:function(e,t){return"char letter-".concat(t)}}),this.DOM.subtitleChar=Xe(this.DOM.subtitle.querySelectorAll(".char"))}},{key:"setLinks",value:function(){this.DOM.zone=document.querySelector(".js-zone")}},{key:"setSeries",value:function(){var e=this;this.DOM.titles=Xe(document.querySelectorAll(".js-main-series")),this.DOM.container=document.querySelector(".js-main-series-cont"),this.seriesTitles=[],this.DOM.container.style.transform="translate3D(0, 0, 0)",this.DOM.titles.forEach(function(t,i){var r=t.getBoundingClientRect();0===i&&(window.matchMedia("(min-width: 640px)").matches?e.DOM.container.style.marginLeft=window.innerWidth/2-r.width/2+"px":e.DOM.container.style.marginTop=window.innerHeight/2-r.height/2+"px"),e.seriesTitles.push({id:t.dataset.id,x:(r.left-window.innerWidth/2+r.width/2).toFixed(2),y:(r.top-window.innerHeight/2+r.height/2).toFixed(2),content:t.dataset.content,current:!1})}),this.current=this.current||2,this.seriesTitles[this.current].current=!0,window.matchMedia("(min-width: 640px)").matches?this.DOM.container.style.transform="translate3D(-".concat(this.seriesTitles[2].x,"px, 0, 0)"):this.DOM.container.style.transform="translate3D(0, -".concat(this.seriesTitles[2].y,"px, 0)")}},{key:"setInfos",value:function(){this.DOM.info=Xe(document.querySelectorAll(".js-main-info")),this.DOM.desc=Xe(document.querySelectorAll(".js-main-desc")),this.DOM.link=document.querySelector(".js-main-link-displayed"),this.DOM.linkBar=this.DOM.link.querySelector(".js-link-bar"),this.DOM.desc.forEach(function(e){var $qP5t$$interop$default=zb(Sg);$qP5t$$interop$default.d(e,{setClassName:function(e,t){return"char letter-".concat(t)}})}),this.infos=this.DOM.info.map(function(e){return{id:e.dataset.id,url:e.querySelector(".js-main-link").getAttribute("href"),cover:e.querySelector(".js-main-cover").getAttribute("src"),desc:e.querySelector(".js-main-desc"),descChars:Xe(e.querySelectorAll(".js-main-desc > .char"))}})}},{key:"bindEvent",value:function(){var e=this;var $JsOR$$interop$default=zb(Qj);this.event.resize=this.resize.bind(this),this.event.scroll=this.scroll.bind(this),this.event.zone=function(t){if(t.target.classList.contains("js-zone-link")){var i="prev"===t.target.dataset.dir?1:-1;e.slide(i)}},window.addEventListener("resize",this.event.resize,!1),this.DOM.zone.addEventListener("click",this.event.zone,!1),this.event.scroller=new $JsOR$$interop$default.d,this.event.scroller.on(this.event.scroll)}},{key:"scroll",value:function(e){var t=this;if(this.isStarted){var i="WheelEvent"!==e.originalEvent.constructor.name||Math.abs(e.deltaY)>this.scrollDelta;!this.slideIsRunning&&i&&this.slide(e.deltaY),this.scrollDelta=Math.abs(e.deltaY)}else this.isAppear&&!this.isAppearOnce&&(this.isAppearOnce=!0,this.glObject.slide(1).then(function(){return t.glObject.removetexture(0)}),ba.to(this.DOM.gabriel,{autoAlpha:0,duration:this.sliderDelay}),ba.to(this.DOM.date,{autoAlpha:0,duration:this.sliderDelay}),ba.to(this.DOM.subtitleChar,{autoAlpha:0,stagger:.04}).then(function(e){return ba.set(t.DOM.loading,{autoAlpha:0})}),ba.to(this.DOM.content,{autoAlpha:0,duration:this.sliderDelay/1.5}),ba.to(this.DOM.circle,{strokeDashoffset:500,duration:this.sliderDelay/1.5}),ba.to(this.DOM.arrow,{autoAlpha:0,duration:this.sliderDelay/1.5}),ba.to(this.DOM.link,{autoAlpha:1,duration:this.sliderDelay,delay:this.sliderDelay}),ba.to(this.DOM.container,{autoAlpha:1,duration:2*this.sliderDelay,delay:this.sliderDelay/2}),ba.to(this.infos[0].descChars,{autoAlpha:1,duration:this.sliderDelay-.1,delay:this.sliderDelay/2,stagger:{amount:this.sliderDelay/2-.1,from:"random"}}),ba.set(this.DOM.linkBar,{transformOrigin:"0 100%"}),ba.to(this.DOM.linkBar,{scaleX:1,duration:this.sliderDelay/2,delay:this.sliderDelay/2}),this.nextObject.isViewed(1),this.prevObject.isViewed(1).then(function(){t.isStarted=!0}))}},{key:"slide",value:function(e){var t,i=this;this.slideIsRunning=!0;var r=e>0,s=this.seriesTitles.findIndex(function(e){return!0===e.current});this.seriesTitles[s].current=!1;var n=this.seriesTitles[r?s-1:s+1],a=this.infos[this.infos.findIndex(function(e){return e.id===i.seriesTitles[s].id})];if("true"!==n.content){var o=n.id.split("_").splice(1)[0];s=this.seriesTitles.findIndex(function(e){return e.id===o})}var l=this.infos.findIndex(function(e){return e.id===n.id});l=l>=0?l:this.infos.findIndex(function(e){return e.id===i.seriesTitles[s].id});var c=this.infos[l],$=window.matchMedia("(min-width: 640px)").matches;ba.to(a.descChars,{autoAlpha:0,duration:this.sliderDelay/2-.1,stagger:{amount:this.sliderDelay/2-.1,from:"random"}}),ba.to(c.descChars,{autoAlpha:1,duration:this.sliderDelay/2-.1,delay:this.sliderDelay/2-.1,stagger:{amount:this.sliderDelay/2-.1,from:"random"}}),this.DOM.link.setAttribute("href",c.url);var u=c.id.replace("-"," ");this.DOM.link.dataset.name=u[0].toUpperCase()+u.slice(1),console.log(c);var h=r?"100% 50%":"0% 50%",d=r?"0% 50%":"100% 50%";ba.set(this.DOM.linkBar,{transformOrigin:h}),ba.to(this.DOM.linkBar,{scaleX:0,duration:this.sliderDelay/2}),ba.set(this.DOM.linkBar,{transformOrigin:d,delay:this.sliderDelay/2}),ba.to(this.DOM.linkBar,{scaleX:1,duration:this.sliderDelay/2,delay:this.sliderDelay/2});var p=$?"x":"y";ba.to(this.DOM.container,(t={},$h(t,p,-n[p]),$h(t,"duration",this.sliderDelay),$h(t,"ease","power2.out"),t)).then(function(){"true"!==n.content?(i.seriesTitles[s].current=!0,ba.set(i.DOM.container,$h({},p,-i.seriesTitles[s][p]))):n.current=!0,i.slideIsRunning=!1});var f=l-1<=0?this.infos.length-1:l-1,y=l+1>=this.infos.length?0:l+1;this.prevObject.slide(f),this.glObject.slide(l),this.nextObject.slide(y)}},{key:"appear",value:function(){var e=this;this.glObject&&this.glObject.isViewed().then(function(){e.isAppear=!0,e.slideIsRunning=!1})}},{key:"resize",value:function(){this.setSeries()}},{key:"destroy",value:function(){this.slider&&Mt(this.slider),this.glObject&&(Ma.scroll=0,this.glObject.destroy(),this.prevObject.destroy(),this.nextObject.destroy(),this.event.scroller.destroy(),this.DOM.zone.removeEventListener("click",this.event.zone,!1),window.removeEventListener("resize",this.event.resize))}}]),i}();function MA(t){return(MA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function NA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cl(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function PA(t,e,o){return e&&cl(t.prototype,e),o&&cl(t,o),t}function QA(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&RA(t,e)}function RA(t,e){return(RA=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function SA(t){var e=VA();return function(){var o,r=bl(t);if(e){var a=bl(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return TA(this,o)}}function TA(t,e){return!e||"object"!==MA(e)&&"function"!=typeof e?UA(t):e}function UA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VA(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function bl(t){return(bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var XA=function(t){QA(o,Zb);var e=SA(o);function o(t){var r;return NA(this,o),(r=e.call(this,t)).events={click:{openImg:"openImg",leaveZoom:"leaveZoom"}},r}return PA(o,[{key:"openImg",value:function(t){var e=this,o=new Image;o.src=t.currentTarget.dataset.src,o.addEventListener("load",function(t){e.$("svg")[0].setAttribute("viewBox","0 0 ".concat(t.target.width," ").concat(t.target.height))}),this.photo.setAttribute("href",t.currentTarget.dataset.src),this.$("zoomName")[0].innerText=t.currentTarget.dataset.name,this.openImageTL.play(0)}},{key:"leaveZoom",value:function(){this.closeImageTL.play(0)}},{key:"init",value:function(){this.photo=this.$("zoom")[0],this.openImageTL=ba.timeline({paused:!0}),this.openImageTL.to(".js-photo-section",{autoAlpha:1,duration:1.5}),this.openImageTL.to(".js-photo-feDisplacementMap",{attr:{scale:0},duration:2},1),this.openImageTL.to(this.$("svg")[0],{autoAlpha:1,duration:1},1),this.openImageTL.to(this.$("zoomName")[0],{autoAlpha:1,duration:1},1.2),this.openImageTL.to(this.$("leaveZoom")[0],{autoAlpha:1,duration:.6},1.4),this.closeImageTL=ba.timeline({paused:!0}),this.closeImageTL.to(".js-photo-feDisplacementMap",{attr:{scale:50},duration:1},0),this.closeImageTL.to(this.$("zoomName")[0],{autoAlpha:0,duration:1},0),this.closeImageTL.to(this.$("leaveZoom")[0],{autoAlpha:0,duration:1},0),this.closeImageTL.to(this.$("svg")[0],{autoAlpha:0,duration:1},.4),this.closeImageTL.to(".js-photo-section",{autoAlpha:0,duration:1.5},1.2)}},{key:"destroy",value:function(){}}]),o}();function YA(t){return(YA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ZA(t){return bB(t)||aB(t)||_A(t)||$A()}function $A(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _A(t,e){if(t){if("string"==typeof t)return Ki(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ki(t,e):void 0}}function aB(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function bB(t){if(Array.isArray(t))return Ki(t)}function Ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function dB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function al(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fB(t,e,r){return e&&al(t.prototype,e),r&&al(t,r),t}function gB(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hB(t,e)}function hB(t,e){return(hB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function iB(t){var e=lB();return function(){var r,o=_k(t);if(e){var n=_k(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return jB(this,r)}}function jB(t,e){return!e||"object"!==YA(e)&&"function"!=typeof e?kB(t):e}function kB(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lB(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _k(t){return(_k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nB=function(t){gB(r,Zb);var e=iB(r);function r(t){var o;return dB(this,r),(o=e.call(this,t)).menu=o.$("menu"),o.menuToogle=ZA(o.$("menuToogle")[0].querySelectorAll(".js-header-bar")),o.isOpen=!1,o.sublist=!1,o.events={click:{menuToogle:"toogleNav",submenuToogle:"submenuToogle"}},o}return fB(r,[{key:"init",value:function(){}},{key:"submenuToogle",value:function(t){var e=t.currentTarget.nextElementSibling.firstElementChild,r=this.sublistEl!==e;this.sublist=r?!this.sublist:this.sublist,this.sublistEl&&(ba.to(this.sublistEl,{height:0,autoAlpha:0,duration:1}),this.sublistEl.dataset.open=r?"false":this.sublistEl.dataset.open),this.sublistEl=e,ba.to(this.sublistEl,{height:r?"auto":"true"===this.sublistEl.dataset.open?0:"auto",autoAlpha:r?1:"true"===this.sublistEl.dataset.open?0:1,duration:1}),this.sublistEl.dataset.open="true"===this.sublistEl.dataset.open?"false":"true"}},{key:"toogleNav",value:function(){this.isOpen=!this.isOpen,ba.to(this.menu,{autoAlpha:this.isOpen?1:0,duration:1}),ba.to(this.menuToogle[0],{transform:this.isOpen?"rotate(45deg) translateY(5px)":"rotate(0deg)",background:this.isOpen?"#000":"#FFF",duration:.5}),ba.to(this.menuToogle[1],{transform:this.isOpen?"rotate(-45deg) translateY(-5px)":"rotate(0deg)",background:this.isOpen?"#000":"#FFF",duration:.5}),ba.to(".js-nav-list",{autoAlpha:this.isOpen?1:0,duration:1.2,stagger:.1})}},{key:"destroy",value:function(){}}]),r}();function oB(t){return(oB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $k(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rB(t,e,r){return e&&$k(t.prototype,e),r&&$k(t,r),t}function sB(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tB(t,e)}function tB(t,e){return(tB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uB(t){var e=xB();return function(){var r,o=Zk(t);if(e){var n=Zk(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return vB(this,r)}}function vB(t,e){return!e||"object"!==oB(e)&&"function"!=typeof e?wB(t):e}function wB(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xB(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Zk(t){return(Zk=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zB=function(t){sB(r,Zb);var e=uB(r);function r(t){return pB(this,r),e.call(this,t)}return rB(r,[{key:"init",value:function(){var t=this.el.querySelectorAll("[data-appear]");ba.to(t,{autoAlpha:1,duration:1,delay:0,ease:"Power3.easeInOut"})}},{key:"destroy",value:function(){}}]),r}();function AB(t){return(AB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yk(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function DB(t,e,r){return e&&Yk(t.prototype,e),r&&Yk(t,r),t}function EB(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&FB(t,e)}function FB(t,e){return(FB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function GB(t){var e=JB();return function(){var r,o=Xk(t);if(e){var n=Xk(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return HB(this,r)}}function HB(t,e){return!e||"object"!==AB(e)&&"function"!=typeof e?IB(t):e}function IB(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JB(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Xk(t){return(Xk=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var LB=function(t){EB(r,Zb);var e=GB(r);function r(t){return BB(this,r),e.call(this,t)}return DB(r,[{key:"init",value:function(){}},{key:"destroy",value:function(){}}]),r}();function JA(t){return(JA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ew(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wk(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wv(t,e,r){return e&&Wk(t.prototype,e),r&&Wk(t,r),t}function vv(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uv(t,e)}function uv(t,e){return(uv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tv(t){var e=qv();return function(){var r,o=Vk(t);if(e){var n=Vk(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return sv(this,r)}}function sv(t,e){return!e||"object"!==JA(e)&&"function"!=typeof e?rv(t):e}function rv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Vk(t){return(Vk=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nv=function(t){vv(r,Zb);var e=tv(r);function r(t){return ew(this,r),e.call(this,t)}return wv(r,[{key:"init",value:function(){console.log("contact")}},{key:"destroy",value:function(){Ia.emit("cursorAppear")}}]),r}();function mv(e){return(mv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uk(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function jv(e,t,r){return t&&Uk(e.prototype,t),r&&Uk(e,r),e}function iv(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hv(e,t)}function hv(e,t){return(hv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gv(e){var t=Ut();return function(){var r,o=Tk(e);if(t){var n=Tk(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return fv(this,r)}}function fv(e,t){return!t||"object"!==mv(t)&&"function"!=typeof t?Vt(e):t}function Vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ut(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Tk(e){return(Tk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zt=function(e){iv(r,Zb);var t=gv(r);function r(e){return lv(this,r),t.call(this,e)}return jv(r,[{key:"init",value:function(){}},{key:"destroy",value:function(){}}]),r}();Ab.Load=Ev,Ab.Cursor=fw,Ab.Scroll=Tz,Ab.Homepage=LA,Ab.Serie=XA,Ab.Navigation=nB,Ab.Publications=zB,Ab.Press=LB,Ab.Contact=nv,Ab.Awards=zt;var Hi=Hi||{};!function(o){var e=navigator.userAgent.toLowerCase(),n=/(chrome|firefox)/;o.init=function(){if(n.test(e.toLowerCase())){var o=["padding: 0 5px 16px","background-color: #000000","color: #FFFFFF"].join(";"),r=["padding: 0 5px 16px","background-color: #FFFFFF","color: #000000"].join(";");e.indexOf("chrome")>-1&&(o+=";",o+=["padding: 20px 5px 16px 40px","background-image: url(https://files.de-jaune-et-de-bleu.com/img/signature/djdb-logo-wave.png)","background-position: 10px 9px","background-repeat: no-repeat","background-size: 26px 30px"].join(";"),r+=";",r+=["padding: 20px 5px 16px 40px","background-image: url(https://res.cloudinary.com/dgzqhksfz/image/upload/v1610811386/Mongramme-noir-wireframe-simple_vgjcut.gif)","background-position: 10px 9px","background-repeat: no-repeat","background-size: 26px 30px"].join(";"));var i=["padding: 20px 5px 16px","background-color: #FFFFFF","color: #000000"].join(";"),a=["padding: 20px 5px 16px","background-color: #000000","color: #FFFFFF"].join(";"),p=["background-color: transparent"].join(";");console.log("\n\n %c BOLK %c design | https://www.bolk.studio %c \n",r,a,p),console.log("\n %c DE JAUNE ET DE BLEU %c code | https://www.jaunebleu.co %c \n\n\n",o,i,p)}else window.console&&(console.log("Design by BOLK - https://www.bolk.studio"),console.log("Code by DE JAUNE ET DE BLEU - https://www.jaunebleu.co"))}}(Hi),function(){var o=new Xy({modules:Ab});o.init(o),Hi.init()}();return{"A2T1":{}};});